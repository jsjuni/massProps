<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>massProps • massProps</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="massProps">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">massProps</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/massProps.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/jsjuni/massProps/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>massProps</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/jsjuni/massProps/blob/main/vignettes/massProps.Rmd" class="external-link"><code>vignettes/massProps.Rmd</code></a></small>
      <div class="d-none name"><code>massProps.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>The <code>massProps</code> package extends <code>rollupTree</code>
with functions to recursively calculate mass properties (and optionally,
their uncertainties) for arbitrary decomposition trees. Formulas
implemented are described in a technical paper published by the Society
of Allied Weight Engineers <span class="citation">(Zimmerman and Nakai
2005)</span>.</p>
</div>
<div class="section level2">
<h2 id="synopsis">Synopsis<a class="anchor" aria-label="anchor" href="#synopsis"></a>
</h2>
<div class="section level3">
<h3 id="data-structures">Data Structures<a class="anchor" aria-label="anchor" href="#data-structures"></a>
</h3>
<p><code>massProps</code> operates on two fundamental data structures: a
mass properties table and a tree. The mass properties table has an entry
for every item in a tree structure of items; the edges of the tree
convey the parent-child relations among items. The two data structures
are linked by the <code>id</code> column of the data frame, which must
be a character vector of unique item identifiers, and the vertex names
of the tree. The sets of identifiers must be identical.</p>
<div class="section level4">
<h4 id="mass-property-table">Mass Property Table<a class="anchor" aria-label="anchor" href="#mass-property-table"></a>
</h4>
<div class="section level5">
<h5 id="required-columns-for-mass-properties">Required Columns for Mass Properties<a class="anchor" aria-label="anchor" href="#required-columns-for-mass-properties"></a>
</h5>
<p>The Mass Property Table must contain the following columns. Other
columns may exist and will remain unmodified.</p>
<ul>
<li><p><code>id</code> unique identifier for each item (row)</p></li>
<li><p><code>mass</code> mass of the item (numeric)</p></li>
<li><p><code>Cx</code>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>-component
of center of mass (numeric)</p></li>
<li><p><code>Cy</code>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi><annotation encoding="application/x-tex">y</annotation></semantics></math>-component
of center of mass (numeric)</p></li>
<li><p><code>Cx</code>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>z</mi><annotation encoding="application/x-tex">z</annotation></semantics></math>-component
of center of mass (numeric)</p></li>
<li><p><code>Ixx</code> moment of inertia about the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>
axis (numeric)</p></li>
<li><p><code>Iyy</code> moment of inertia about the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi><annotation encoding="application/x-tex">y</annotation></semantics></math>
axis (numeric)</p></li>
<li><p><code>Izz</code> moment of inertia about the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>z</mi><annotation encoding="application/x-tex">z</annotation></semantics></math>
axis (numeric)</p></li>
<li><p><code>Ixy</code> product of inertia relative to the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi><annotation encoding="application/x-tex">y</annotation></semantics></math>
axes (numeric)</p></li>
<li><p><code>Ixz</code> product of inertia relative to the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>z</mi><annotation encoding="application/x-tex">z</annotation></semantics></math>
axes (numeric)</p></li>
<li><p><code>Iyz</code> product of inertia relative to the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi><annotation encoding="application/x-tex">y</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>z</mi><annotation encoding="application/x-tex">z</annotation></semantics></math>
axes (numeric)</p></li>
<li><p><code>POIconv</code> either ‘+’ or ‘-’, indicating the sign
convention for products of inertia. In the negative convention, for
example,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>I</mi><mrow><mi>X</mi><mi>Y</mi></mrow></msub><mo>≡</mo><mo>−</mo><mo>∫</mo><mrow><mi>x</mi><mi>y</mi><mi>ρ</mi><mspace width="0.167em"></mspace><mi>d</mi><mi>V</mi></mrow></mrow><annotation encoding="application/x-tex">I_{XY} \equiv -\int{xy \rho \, dV}</annotation></semantics></math>.
In the positive convention,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>I</mi><mrow><mi>X</mi><mi>Y</mi></mrow></msub><mo>≡</mo><mo>∫</mo><mrow><mi>x</mi><mi>y</mi><mi>ρ</mi><mspace width="0.167em"></mspace><mi>d</mi><mi>V</mi></mrow></mrow><annotation encoding="application/x-tex">I_{XY} \equiv \int{xy \rho \, dV}</annotation></semantics></math>.</p></li>
<li><p><code>Ipoint</code> logical indicator that this item is
considered a point mass. The same algebraic result can be achieved by
setting all moments and products of inertia to zero, but
<code><a href="../reference/rollup_mass_props.html">rollup_mass_props()</a></code> by default ensures that all leaf items
in the tree have mass properties that correspond to
physically-realizable objects. A zero inertia tensor will fail this
check. Rather than relax the check (which is essential for trustworthy
results), a <code>TRUE</code> value for <code>Ipoint</code> indicates
that the inertia tensor should be excluded from computations.</p></li>
</ul>
</div>
<div class="section level5">
<h5 id="required-columns-for-mass-properties-uncertainties">Required Columns for Mass Properties Uncertainties<a class="anchor" aria-label="anchor" href="#required-columns-for-mass-properties-uncertainties"></a>
</h5>
<p>The following columns are required for uncertainty calculations:</p>
<ul>
<li><p><code>sigma_mass</code> mass uncertainty (numeric)</p></li>
<li><p><code>sigma_Cx</code>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>-component
of center of mass uncertainty (numeric)</p></li>
<li><p><code>sigma_Cy</code>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi><annotation encoding="application/x-tex">y</annotation></semantics></math>-component
of center of mass uncertainty (numeric)</p></li>
<li><p><code>sigma_Cx</code>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>z</mi><annotation encoding="application/x-tex">z</annotation></semantics></math>-component
of center of mass uncertainty (numeric)</p></li>
<li><p><code>sigma_Ixx</code> moment of inertia about the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>
axis uncertainty (numeric)</p></li>
<li><p><code>sigma_Iyy</code> moment of inertia about the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi><annotation encoding="application/x-tex">y</annotation></semantics></math>
axis uncertainty (numeric)</p></li>
<li><p><code>sigma_Izz</code> moment of inertia about the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>z</mi><annotation encoding="application/x-tex">z</annotation></semantics></math>
axis uncertainty (numeric)</p></li>
<li><p><code>sigma_Ixy</code> product of inertia relative to the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi><annotation encoding="application/x-tex">y</annotation></semantics></math>
axes uncertainty (numeric)</p></li>
<li><p><code>sigma_Ixz</code> product of inertia relative to the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>z</mi><annotation encoding="application/x-tex">z</annotation></semantics></math>
axes uncertainty (numeric)</p></li>
<li><p><code>sigma_Iyz</code> product of inertia relative to the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi><annotation encoding="application/x-tex">y</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>z</mi><annotation encoding="application/x-tex">z</annotation></semantics></math>
axes uncertainty (numeric)</p></li>
</ul>
<p>It is the caller’s responsibility to ensure that all values are
expressed in appropriate and compatible units.</p>
</div>
<div class="section level5">
<h5 id="tree">Tree<a class="anchor" aria-label="anchor" href="#tree"></a>
</h5>
<p>The tree is an <code><a href="https://r.igraph.org/reference/graph.html" class="external-link">igraph::graph</a></code> with vertices named by
identifiers in the mass properties table. It can be of arbitrary depth
and shape as long as it satisfies certain well-formedness
properties:</p>
<ul>
<li><p>it is connected and acyclic (as an undirected graph), i.e., it is
a tree</p></li>
<li><p>it is directed, with edge direction going from child to
parent</p></li>
<li><p>it contains neither loops (self-edges) nor multiple
edges</p></li>
<li><p>it contains a single root vertex (i.e., one whose out degree is
zero)</p></li>
</ul>
</div>
</div>
</div>
<div class="section level3">
<h3 id="invocation">Invocation<a class="anchor" aria-label="anchor" href="#invocation"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://jsjuni.github.io/massProps/">massProps</a></span><span class="op">)</span></span></code></pre></div>
<p>Suppose we have the following mass properties table:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">test_table</span></span>
<span><span class="co">#&gt;     id parent mass Cx Cy Cz Ixx  Ixy   Ixz Iyy   Iyz Izz POIconv Ipoint</span></span>
<span><span class="co">#&gt; 1  A.1          NA NA NA NA  NA   NA    NA  NA    NA  NA       -  FALSE</span></span>
<span><span class="co">#&gt; 2  A.2    A.1   NA NA NA NA  NA   NA    NA  NA    NA  NA       -  FALSE</span></span>
<span><span class="co">#&gt; 3  A.3    A.1   NA NA NA NA  NA   NA    NA  NA    NA  NA       -  FALSE</span></span>
<span><span class="co">#&gt; 4  C.1    A.1    5  0  0  0  80 -4.0 -24.0  80 -24.0  75       -  FALSE</span></span>
<span><span class="co">#&gt; 5  P.1    A.2    2  1  1  1   4 -0.1  -0.1   4   0.1   4       -  FALSE</span></span>
<span><span class="co">#&gt; 6  P.2    A.2    2  1  1 -1   4 -0.1  -0.1   4   0.1   4       -  FALSE</span></span>
<span><span class="co">#&gt; 7  P.3    A.2    2  1 -1  1   4 -0.1  -0.1   4   0.1   4       -  FALSE</span></span>
<span><span class="co">#&gt; 8  P.4    A.2    2  1 -1 -1   4 -0.1  -0.1   4   0.1   4       -  FALSE</span></span>
<span><span class="co">#&gt; 9  P.5    A.3    2 -1  1  1   4 -0.1  -0.1   4   0.1   4       -  FALSE</span></span>
<span><span class="co">#&gt; 10 P.6    A.3    2 -1  1 -1   4 -0.1  -0.1   4   0.1   4       -  FALSE</span></span>
<span><span class="co">#&gt; 11 P.7    A.3    2 -1 -1  1   4 -0.1  -0.1   4   0.1   4       -  FALSE</span></span>
<span><span class="co">#&gt; 12 P.8    A.3    2 -1 -1 -1   4 -0.1  -0.1   4   0.1   4       -  FALSE</span></span></code></pre></div>
<p>Suppose we also have this tree:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r.igraph.org/" class="external-link">igraph</a></span><span class="op">)</span></span>
<span><span class="va">test_tree</span></span>
<span><span class="co">#&gt; IGRAPH 7d8200c DN-- 12 11 -- </span></span>
<span><span class="co">#&gt; + attr: name (v/c)</span></span>
<span><span class="co">#&gt; + edges from 7d8200c (vertex names):</span></span>
<span><span class="co">#&gt;  [1] A.2-&gt;A.1 A.3-&gt;A.1 C.1-&gt;A.1 P.1-&gt;A.2 P.2-&gt;A.2 P.3-&gt;A.2 P.4-&gt;A.2 P.5-&gt;A.3</span></span>
<span><span class="co">#&gt;  [9] P.6-&gt;A.3 P.7-&gt;A.3 P.8-&gt;A.3</span></span></code></pre></div>
<p><img src="massProps_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<p>Then we can compute mass properties for non-leaf elements by calling
<code><a href="../reference/rollup_mass_props.html">rollup_mass_props()</a></code>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/rollup_mass_props.html">rollup_mass_props</a></span><span class="op">(</span><span class="va">test_tree</span>, <span class="va">test_table</span><span class="op">)</span></span>
<span><span class="co">#&gt;     id parent mass Cx Cy Cz Ixx  Ixy   Ixz Iyy   Iyz Izz POIconv Ipoint</span></span>
<span><span class="co">#&gt; 1  A.1          21  0  0  0 144 -4.8 -24.8 144 -23.2 139       -  FALSE</span></span>
<span><span class="co">#&gt; 2  A.2    A.1    8  1  0  0  32 -0.4  -0.4  24   0.4  24       -  FALSE</span></span>
<span><span class="co">#&gt; 3  A.3    A.1    8 -1  0  0  32 -0.4  -0.4  24   0.4  24       -  FALSE</span></span>
<span><span class="co">#&gt; 4  C.1    A.1    5  0  0  0  80 -4.0 -24.0  80 -24.0  75       -  FALSE</span></span>
<span><span class="co">#&gt; 5  P.1    A.2    2  1  1  1   4 -0.1  -0.1   4   0.1   4       -  FALSE</span></span>
<span><span class="co">#&gt; 6  P.2    A.2    2  1  1 -1   4 -0.1  -0.1   4   0.1   4       -  FALSE</span></span>
<span><span class="co">#&gt; 7  P.3    A.2    2  1 -1  1   4 -0.1  -0.1   4   0.1   4       -  FALSE</span></span>
<span><span class="co">#&gt; 8  P.4    A.2    2  1 -1 -1   4 -0.1  -0.1   4   0.1   4       -  FALSE</span></span>
<span><span class="co">#&gt; 9  P.5    A.3    2 -1  1  1   4 -0.1  -0.1   4   0.1   4       -  FALSE</span></span>
<span><span class="co">#&gt; 10 P.6    A.3    2 -1  1 -1   4 -0.1  -0.1   4   0.1   4       -  FALSE</span></span>
<span><span class="co">#&gt; 11 P.7    A.3    2 -1 -1  1   4 -0.1  -0.1   4   0.1   4       -  FALSE</span></span>
<span><span class="co">#&gt; 12 P.8    A.3    2 -1 -1 -1   4 -0.1  -0.1   4   0.1   4       -  FALSE</span></span></code></pre></div>
<p>Note that, although the table shows the parent of each element for
clarity of exposition, the child-parent relations are coneveyed
<em>only</em> by the tree passed as the first argument.</p>
<p>The input may also contain uncertainties data. This example is from
the Society of Allied Weight Engineers:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sawe_input</span></span>
<span><span class="co">#&gt;         id  mass    Cx    Cy    Cz     Ixx     Iyy      Izz    Ixy      Ixz</span></span>
<span><span class="co">#&gt; 1   Widget 57.83 121.2  0.04 -0.16 7258.90 8607.02 10453.40 834.44 -1198.38</span></span>
<span><span class="co">#&gt; 2 2nd Part 16.80  70.9 -0.95  0.46   65.07 1124.65  1078.82  76.01   202.83</span></span>
<span><span class="co">#&gt; 3 Combined    NA    NA    NA    NA      NA      NA       NA     NA       NA</span></span>
<span><span class="co">#&gt;        Iyz sigma_mass sigma_Cx sigma_Cy sigma_Cz sigma_Ixx sigma_Iyy sigma_Izz</span></span>
<span><span class="co">#&gt; 1 -1066.58     1.2416   0.2764   0.2085   0.0669  386.9233  171.4792  414.5547</span></span>
<span><span class="co">#&gt; 2    13.62     1.7308   0.6234   0.5173   0.1405   12.4687  109.1324  108.5481</span></span>
<span><span class="co">#&gt; 3       NA         NA       NA       NA       NA        NA        NA        NA</span></span>
<span><span class="co">#&gt;   sigma_Ixy sigma_Ixz sigma_Iyz Ipoint POIconv</span></span>
<span><span class="co">#&gt; 1 1440.5402  344.6237  124.6860  FALSE       +</span></span>
<span><span class="co">#&gt; 2   55.8879  212.1241   11.5408  FALSE       +</span></span>
<span><span class="co">#&gt; 3        NA        NA        NA  FALSE       +</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/rollup_mass_props_and_unc.html">rollup_mass_props_and_unc</a></span><span class="op">(</span><span class="va">sawe_tree</span>, <span class="va">sawe_input</span><span class="op">)</span></span>
<span><span class="co">#&gt;         id  mass       Cx         Cy          Cz      Ixx      Iyy      Izz</span></span>
<span><span class="co">#&gt; 1   Widget 57.83 121.2000  0.0400000 -0.16000000 7258.900  8607.02 10453.40</span></span>
<span><span class="co">#&gt; 2 2nd Part 16.80  70.9000 -0.9500000  0.46000000   65.070  1124.65  1078.82</span></span>
<span><span class="co">#&gt; 3 Combined 74.63 109.8769 -0.1828594 -0.02043146 7341.733 42673.75 44482.05</span></span>
<span><span class="co">#&gt;        Ixy       Ixz       Iyz sigma_mass sigma_Cx  sigma_Cy   sigma_Cz</span></span>
<span><span class="co">#&gt; 1  834.440 -1198.380 -1066.580    1.24160  0.27640 0.2085000 0.06690000</span></span>
<span><span class="co">#&gt; 2   76.010   202.830    13.620    1.73080  0.62340 0.5173000 0.14050000</span></span>
<span><span class="co">#&gt; 3 1558.714 -1401.534 -1060.951    2.13008  0.95821 0.1999847 0.06178402</span></span>
<span><span class="co">#&gt;   sigma_Ixx sigma_Iyy sigma_Izz sigma_Ixy sigma_Ixz sigma_Iyz Ipoint POIconv</span></span>
<span><span class="co">#&gt; 1  386.9233  171.4792  414.5547 1440.5402  344.6237  124.6860  FALSE       +</span></span>
<span><span class="co">#&gt; 2   12.4687  109.1324  108.5481   55.8879  212.1241   11.5408  FALSE       +</span></span>
<span><span class="co">#&gt; 3  387.4017 2789.3133 2815.3260 1488.0948  418.6048  125.3175  FALSE       +</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="objectives-and-strategy">Objectives and Strategy<a class="anchor" aria-label="anchor" href="#objectives-and-strategy"></a>
</h2>
<p>The objective of this package is to provide a trustworthy,
well-documented, reference implementation for computation of mass
properties (and their uncertainties) of aggregate objects from those of
their parts. Aggregation can be recursive (e.g., indentured Bill of
Materials), so it must accommodate trees of arbitrary depth and
shape.</p>
<p>Strategies for achieving the objective include</p>
<ul>
<li><p>basing the calculations on published industry
references,</p></li>
<li><p>re-casting those lengthy reference equations into concise vector
or matrix forms to reduce the error surface for source code and exploit
the capabilities of <code>R</code>, which treats vectors and matrices as
first-class objects,</p></li>
<li><p>delegating orchestration to the <code>rollupTree</code> package,
which, among other things, verifies that the input tree is well-formed
and ensures proper ordering of computations,</p></li>
<li><p>ensuring that all asserted leaf mass properties and uncertainties
correspond to physically-realizable objects,</p></li>
<li><p>coding in pure functional style, (i.e., avoiding mutable
variables, implying iteration with <code><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Map()</a></code> and
<code><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Reduce()</a></code>), and</p></li>
<li><p>covering the entire code base with unit tests.</p></li>
</ul>
<p>The author has intentionally made no effort to micro-optimize for
performance. In particular, the author is aware that representing the
inertia and its uncertainty as 3 ⨉ 3 matrices is “inefficient” to the
degree that it independently calculates values that are redundant by
symmetry. “Inefficient”, however, does not mean “slow”. See <a href="#performance-evaluation">Performance Evaluation</a> below.</p>
</div>
<div class="section level2">
<h2 id="theory">Theory<a class="anchor" aria-label="anchor" href="#theory"></a>
</h2>
<p>In this section, we state the reference equations <span class="citation">(Zimmerman and Nakai 2005)</span> and show, where
applicable, how those equations can be rewritten in more concise form.
The form of the equations actually implemented is displayed within a
box,
e.g. <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><menclose notation="box"><mrow><mi>F</mi><mo>=</mo><mi>m</mi><mi>a</mi></mrow></menclose><annotation encoding="application/x-tex">\boxed{F = ma}</annotation></semantics></math>.</p>
<p>The reference uses the word <em>weight</em> and the symbol
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>w</mi><annotation encoding="application/x-tex">w</annotation></semantics></math>
in equations. We interpret weight as mass. The reference refers to
center of mass by its
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi><annotation encoding="application/x-tex">y</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>z</mi><annotation encoding="application/x-tex">z</annotation></semantics></math>
components. Symbols for moments
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>I</mi><mrow><mi>X</mi><mi>X</mi></mrow></msub><annotation encoding="application/x-tex">I_{XX}</annotation></semantics></math>)
and products
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>I</mi><mrow><mi>X</mi><mi>Y</mi></mrow></msub><annotation encoding="application/x-tex">I_{XY}</annotation></semantics></math>)
of inertia are conventional. Variables with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
subscripts designate properties of parts; those without designate
properties of aggregates. The letter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>σ</mi><annotation encoding="application/x-tex">\sigma</annotation></semantics></math>
denotes uncertainty.
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>σ</mi><mi>w</mi></msub><annotation encoding="application/x-tex">\sigma_w</annotation></semantics></math>,
for example, is the mass uncertainty.</p>
<div class="section level3">
<h3 id="mass-properties">Mass Properties<a class="anchor" aria-label="anchor" href="#mass-properties"></a>
</h3>
<div class="section level4">
<h4 id="mass">Mass<a class="anchor" aria-label="anchor" href="#mass"></a>
</h4>
<p>The mass equation is suitable as is.</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><menclose notation="box"><mrow><mi>w</mi><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>w</mi><mi>i</mi></msub></mrow></menclose><annotation encoding="application/x-tex">
\boxed{
w = \sum_{i=1}^{n}w_i
}
</annotation></semantics></math></p>
<p>The corresponding <code>R</code> code is</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">amp</span><span class="op">$</span><span class="va">mass</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Reduce</a></span><span class="op">(</span><span class="va">`+`</span>, <span class="fu"><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Map</a></span><span class="op">(</span>f <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">mp</span><span class="op">)</span> <span class="va">mp</span><span class="op">$</span><span class="va">mass</span>, <span class="va">mpl</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>In this and the following code snippets, the variable
<code>mpl</code> is a list of input mass property sets for parts, the
variable <code>mp</code> is a formal parameter of an anonymous function
applied to each member of <code>mpl</code>, and <code>amp</code> is the
resulting aggregate mass property set. The line above is an
<code>R</code> functional programming idiom for “set the mass value of
the aggregate to the sum of the mass values of the parts”.</p>
</div>
<div class="section level4">
<h4 id="center-of-mass">Center of Mass<a class="anchor" aria-label="anchor" href="#center-of-mass"></a>
</h4>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mover><mi>x</mi><mo accent="true">‾</mo></mover></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>w</mi><mi>i</mi></msub><msub><mi>x</mi><mi>i</mi></msub><mi minsize="2.4" maxsize="2.4">/</mi><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>w</mi><mi>i</mi></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mover><mi>y</mi><mo accent="true">‾</mo></mover></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>w</mi><mi>i</mi></msub><msub><mi>y</mi><mi>i</mi></msub><mi minsize="2.4" maxsize="2.4">/</mi><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>w</mi><mi>i</mi></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mover><mi>z</mi><mo accent="true">‾</mo></mover></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>w</mi><mi>i</mi></msub><msub><mi>z</mi><mi>i</mi></msub><mi minsize="2.4" maxsize="2.4">/</mi><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>w</mi><mi>i</mi></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{align}
\bar{x} &amp; = \sum_{i=1}^{n}{w_i}{{x}_i} \bigg/ \sum_{i=1}^{n}w_i\\
\bar{y} &amp; = \sum_{i=1}^{n}{w_i}{{y}_i} \bigg/ \sum_{i=1}^{n}w_i\\
\bar{z} &amp; = \sum_{i=1}^{n}{w_i}{{z}_i} \bigg/ \sum_{i=1}^{n}w_i\\
\end{align}
</annotation></semantics></math></p>
<p>We can express center of mass as a 3-vector:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><menclose notation="box"><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>𝐜</mi><mi>i</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mspace width="1.0em"></mspace><msub><mi>y</mi><mi>i</mi></msub><mspace width="1.0em"></mspace><msub><mi>z</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>T</mi></msup></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mover><mi>𝐜</mi><mo accent="true">‾</mo></mover></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mspace width="1.0em"></mspace><mover><mi>y</mi><mo accent="true">‾</mo></mover><mspace width="1.0em"></mspace><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mi>T</mi></msup></mtd></mtr></mtable></menclose><annotation encoding="application/x-tex">
\boxed{
\begin{align}
\boldsymbol{c}_i &amp; = (x_i \quad y_i \quad z_i)^T \\
\boldsymbol{\bar{c}}&amp; = (\bar{x} \quad \bar{y} \quad \bar{z})^T
\end{align}
}
</annotation></semantics></math></p>
<p>Then</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><menclose notation="box"><mrow><mover><mi>𝐜</mi><mo accent="true">‾</mo></mover><mo>=</mo><mfrac><mn>1</mn><mi>w</mi></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>w</mi><mi>i</mi></msub><msub><mi>𝐜</mi><mi>i</mi></msub></mrow></menclose><annotation encoding="application/x-tex">
\boxed{
\boldsymbol{\bar{c}} = \frac{1}{w} \sum_{i=1}^{n}{w_i}{{\boldsymbol{c}}_i}
}
</annotation></semantics></math></p>
<p>The corresponding <code>R</code> code is</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">amp</span><span class="op">$</span><span class="va">center_mass</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Reduce</a></span><span class="op">(</span><span class="va">`+`</span>, <span class="fu"><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Map</a></span><span class="op">(</span>f <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">mp</span><span class="op">)</span> <span class="va">mp</span><span class="op">$</span><span class="va">mass</span> <span class="op">*</span> <span class="va">mp</span><span class="op">$</span><span class="va">center_mass</span>, <span class="va">mpl</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="va">amp</span><span class="op">$</span><span class="va">mass</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="inertia-tensor">Inertia Tensor<a class="anchor" aria-label="anchor" href="#inertia-tensor"></a>
</h4>
<div class="section level5">
<h5 id="moments-of-inertia">Moments of Inertia<a class="anchor" aria-label="anchor" href="#moments-of-inertia"></a>
</h5>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>I</mi><mrow><mi>X</mi><mi>X</mi></mrow></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><mo stretchy="true" form="prefix">[</mo><msub><msub><mi>I</mi><mrow><mi>X</mi><mi>X</mi></mrow></msub><mi>i</mi></msub><mo>+</mo><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>y</mi><mi>i</mi><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>z</mi><mi>i</mi><mn>2</mn></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msup><mover><mi>y</mi><mo accent="true">‾</mo></mover><mn>2</mn></msup><mo>+</mo><msup><mover><mi>z</mi><mo accent="true">‾</mo></mover><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow></mtd><mtd columnalign="right" style="text-align: right"><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><mo stretchy="true" form="prefix">{</mo><msub><msub><mi>I</mi><mrow><mi>X</mi><mi>X</mi></mrow></msub><mi>i</mi></msub><mo>+</mo><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">[</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>+</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo stretchy="true" form="postfix">]</mo></mrow><mo stretchy="true" form="postfix">}</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>I</mi><mrow><mi>Y</mi><mi>Y</mi></mrow></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><mo stretchy="true" form="prefix">[</mo><msub><msub><mi>I</mi><mrow><mi>Y</mi><mi>Y</mi></mrow></msub><mi>i</mi></msub><mo>+</mo><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>x</mi><mi>i</mi><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>z</mi><mi>i</mi><mn>2</mn></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msup><mover><mi>x</mi><mo accent="true">‾</mo></mover><mn>2</mn></msup><mo>+</mo><msup><mover><mi>z</mi><mo accent="true">‾</mo></mover><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow></mtd><mtd columnalign="right" style="text-align: right"><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><mo stretchy="true" form="prefix">{</mo><msub><msub><mi>I</mi><mrow><mi>Y</mi><mi>Y</mi></mrow></msub><mi>i</mi></msub><mo>+</mo><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">[</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>+</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo stretchy="true" form="postfix">]</mo></mrow><mo stretchy="true" form="postfix">}</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>I</mi><mrow><mi>Z</mi><mi>Z</mi></mrow></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><mo stretchy="true" form="prefix">[</mo><msub><msub><mi>I</mi><mrow><mi>Z</mi><mi>Z</mi></mrow></msub><mi>i</mi></msub><mo>+</mo><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>x</mi><mi>i</mi><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>y</mi><mi>i</mi><mn>2</mn></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msup><mover><mi>x</mi><mo accent="true">‾</mo></mover><mn>2</mn></msup><mo>+</mo><msup><mover><mi>y</mi><mo accent="true">‾</mo></mover><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow></mtd><mtd columnalign="right" style="text-align: right"><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><mo stretchy="true" form="prefix">{</mo><msub><msub><mi>I</mi><mrow><mi>Z</mi><mi>Z</mi></mrow></msub><mi>i</mi></msub><mo>+</mo><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">[</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>+</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo stretchy="true" form="postfix">]</mo></mrow><mo stretchy="true" form="postfix">}</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{align}
I_{XX}&amp; = 
  \sum_{i=1}^{n} \left[ {I_{XX}}_i
    + w_i \left( {y}_i^2 + {z}_i^2 \right)
  - w_i \left( \bar{y}^2 + \bar{z}^2 \right)
  \right]
  &amp; = 
\sum_{i=1}^{n} \left\{ {I_{XX}}_i
  + w_i \left[ \left( {y}_i - \bar{y} \right)^2 + \left( {z}_i - \bar{z} \right)^2 \right]
  \right\}
 \\
I_{YY}&amp; = 
  \sum_{i=1}^{n} \left[ {I_{YY}}_i
    + w_i \left( {x}_i^2 + {z}_i^2 \right)
  - w_i \left( \bar{x}^2 + \bar{z}^2 \right)
  \right]
  &amp; = 
\sum_{i=1}^{n} \left\{ {I_{YY}}_i
  + w_i \left[ \left( {x}_i - \bar{x} \right)^2 + \left( {z}_i - \bar{z} \right)^2 \right]
  \right\}
 \\
I_{ZZ}&amp; = 
  \sum_{i=1}^{n} \left[ {I_{ZZ}}_i
    + w_i \left( {x}_i^2 + {y}_i^2 \right)
  - w_i \left( \bar{x}^2 + \bar{y}^2 \right)
  \right]
  &amp; = 
\sum_{i=1}^{n} \left\{ {I_{ZZ}}_i
  + w_i \left[ \left( {x}_i - \bar{x} \right)^2 + \left( {y}_i - \bar{y} \right)^2 \right]
  \right\}
 \\
\end{align}
</annotation></semantics></math></p>
</div>
<div class="section level5">
<h5 id="products-of-inertia">Products of Inertia<a class="anchor" aria-label="anchor" href="#products-of-inertia"></a>
</h5>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>I</mi><mrow><mi>X</mi><mi>Y</mi></mrow></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><mo stretchy="true" form="prefix">[</mo><msub><msub><mi>I</mi><mrow><mi>X</mi><mi>Y</mi></mrow></msub><mi>i</mi></msub><mo>+</mo><msub><mi>w</mi><mi>i</mi></msub><msub><mi>x</mi><mi>i</mi></msub><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow></mtd><mtd columnalign="right" style="text-align: right"><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><mo stretchy="true" form="prefix">[</mo><msub><msub><mi>I</mi><mrow><mi>X</mi><mi>Y</mi></mrow></msub><mi>i</mi></msub><mo>+</mo><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>I</mi><mrow><mi>X</mi><mi>Z</mi></mrow></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><mo stretchy="true" form="prefix">[</mo><msub><msub><mi>I</mi><mrow><mi>X</mi><mi>Z</mi></mrow></msub><mi>i</mi></msub><mo>+</mo><msub><mi>w</mi><mi>i</mi></msub><msub><mi>x</mi><mi>i</mi></msub><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow></mtd><mtd columnalign="right" style="text-align: right"><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><mo stretchy="true" form="prefix">[</mo><msub><msub><mi>I</mi><mrow><mi>X</mi><mi>Z</mi></mrow></msub><mi>i</mi></msub><mo>+</mo><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>I</mi><mrow><mi>Y</mi><mi>Z</mi></mrow></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><mo stretchy="true" form="prefix">[</mo><msub><msub><mi>I</mi><mrow><mi>Y</mi><mi>Z</mi></mrow></msub><mi>i</mi></msub><mo>+</mo><msub><mi>w</mi><mi>i</mi></msub><msub><mi>y</mi><mi>i</mi></msub><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow></mtd><mtd columnalign="right" style="text-align: right"><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><mo stretchy="true" form="prefix">[</mo><msub><msub><mi>I</mi><mrow><mi>Y</mi><mi>Z</mi></mrow></msub><mi>i</mi></msub><mo>+</mo><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{align}
I_{XY}&amp; = \sum_{i=1}^{n} \left[ {I_{XY}}_i + w_i {{x}_i}{{y}_i} -w_i (\bar{x}\bar{y})\right] &amp; = \sum_{i=1}^{n} \left[ {I_{XY}}_i + w_i ({x}_i - \bar{x})({y}_i - \bar{y})\right] \\
I_{XZ}&amp; = \sum_{i=1}^{n} \left[ {I_{XZ}}_i + w_i {{x}_i}{{z}_i} -w_i (\bar{x}\bar{z})\right] &amp; = \sum_{i=1}^{n} \left[ {I_{XZ}}_i + w_i ({x}_i - \bar{x})({z}_i - \bar{z})\right] \\
I_{YZ}&amp; = \sum_{i=1}^{n} \left[ {I_{YZ}}_i + w_i {{y}_i}{{z}_i} -w_i (\bar{y}\bar{z})\right] &amp; = \sum_{i=1}^{n} \left[ {I_{YZ}}_i + w_i ({y}_i - \bar{y})({z}_i - \bar{z})\right] \\
\end{align}
</annotation></semantics></math></p>
</div>
<div class="section level5">
<h5 id="matrix-formulation">Matrix Formulation<a class="anchor" aria-label="anchor" href="#matrix-formulation"></a>
</h5>
<p>Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐈</mi><annotation encoding="application/x-tex">\boldsymbol{I}</annotation></semantics></math>
be the inertia tensor of the aggregate and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>𝐈</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\boldsymbol{I}_i</annotation></semantics></math>
be that of part
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>.
The equations for products of inertia above clearly follow the positive
integral convention, so</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝐈</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">[</mo><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>I</mi><mrow><mi>X</mi><mi>X</mi></mrow></msub></mtd><mtd columnalign="right" style="text-align: right"><mo>−</mo><msub><mi>I</mi><mrow><mi>X</mi><mi>Y</mi></mrow></msub></mtd><mtd columnalign="right" style="text-align: right"><mo>−</mo><msub><mi>I</mi><mrow><mi>X</mi><mi>Z</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mo>−</mo><msub><mi>I</mi><mrow><mi>X</mi><mi>Y</mi></mrow></msub></mtd><mtd columnalign="right" style="text-align: right"><msub><mi>I</mi><mrow><mi>Y</mi><mi>Y</mi></mrow></msub></mtd><mtd columnalign="right" style="text-align: right"><mo>−</mo><msub><mi>I</mi><mrow><mi>Y</mi><mi>Z</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mo>−</mo><msub><mi>I</mi><mrow><mi>X</mi><mi>Z</mi></mrow></msub></mtd><mtd columnalign="right" style="text-align: right"><mo>−</mo><msub><mi>I</mi><mrow><mi>Y</mi><mi>Z</mi></mrow></msub></mtd><mtd columnalign="right" style="text-align: right"><msub><mi>I</mi><mrow><mi>Z</mi><mi>Z</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd></mtr></mtable><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">
\boldsymbol{I} =
\left[ \begin{array}{rrr}
I_{XX}&amp;            -I_{XY}&amp;             -I_{XZ}\\
           -I_{XY}&amp; I_{YY}&amp;             -I_{YZ}\\
           -I_{XZ}&amp;            -I_{YZ}&amp;  I_{ZZ}\\
\end{array} \right]
</annotation></semantics></math></p>
<p>and similarly for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>𝐈</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\boldsymbol{I}_i</annotation></semantics></math>.</p>
<p>Noting the repeated appearance of terms of the form
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">({x}_i - \bar{x})({y}_i - \bar{y})</annotation></semantics></math>,
we form the outer product</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><menclose notation="box"><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>𝐝</mi><mi>i</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="1.0em"></mspace><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="1.0em"></mspace><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mi>T</mi></msup></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>𝐐</mi><mi>i</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msub><mi>𝐝</mi><mi>i</mi></msub><msup><msub><mi>𝐝</mi><mi>i</mi></msub><mi>T</mi></msup></mtd></mtr></mtable></menclose><annotation encoding="application/x-tex">
\boxed{
\begin{align}
\boldsymbol{d}_i &amp; = (({x}_i - \bar{x}) \quad ({y}_i - \bar{y}) \quad ({z}_i - \bar{z}))^T \\
\boldsymbol{Q}_i &amp; = \boldsymbol{d}_i {\boldsymbol{d}_i}^T
\end{align}
}
</annotation></semantics></math> Then</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>𝐐</mi><mi>i</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mrow><mo stretchy="true" form="prefix">[</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mtd><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="center" style="text-align: center"><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mtd><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="center" style="text-align: center"><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><mo stretchy="true" form="postfix">]</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{align}
\boldsymbol{Q}_i &amp; =
\begin{bmatrix}
({x}_i - \bar{x})^2     &amp; ({x}_i - \bar{x})({y}_i - \bar{y}) &amp; ({x}_i - \bar{x})({z}_i - \bar{z}) \\
({y}_i - \bar{y})({x}_i - \bar{x}) &amp; ({y}_i - \bar{y})^2     &amp; ({y}_i - \bar{y})({z}_i - \bar{z}) \\
({z}_i - \bar{z})({x}_i - \bar{x}) &amp; ({z}_i - \bar{z})({y}_i - \bar{y}) &amp; ({z}_i - \bar{z})^2     \\
\end{bmatrix}
\end{align}
</annotation></semantics></math></p>
<p>Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>𝐬</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\boldsymbol{s}_i</annotation></semantics></math>
be the matrix of inertia tensor summands from the reference equations.
That is,</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝐈</mi><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>𝐬</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">
\boldsymbol{I} = \sum_{i=1}^{n} \boldsymbol{s}_i
</annotation></semantics></math></p>
<p>where
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>𝐬</mi><mi>i</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msub><mi>𝐈</mi><mi>i</mi></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>−</mo><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">[</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mo>−</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>−</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mtd><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="center" style="text-align: center"><mo>−</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>−</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mtd><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="center" style="text-align: center"><mo>−</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>−</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><mo stretchy="true" form="postfix">]</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msub><mi>𝐈</mi><mi>i</mi></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>−</mo><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">[</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mtd><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="center" style="text-align: center"><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mtd><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="center" style="text-align: center"><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><mo stretchy="true" form="postfix">]</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>−</mo><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">[</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mo>−</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>−</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>−</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mo>−</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>−</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>−</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mo>−</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>−</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>−</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><mo stretchy="true" form="postfix">]</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msub><mi>𝐈</mi><mi>i</mi></msub><mo>−</mo><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>𝐐</mi><mi>i</mi></msub><mo>−</mo><mrow><mi mathvariant="normal">t</mi><mi mathvariant="normal">r</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>𝐐</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><msub><mn>𝟏</mn><mn>3</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{align}
\boldsymbol{s}_i &amp; = \boldsymbol{I}_i \\
&amp; -
w_i \begin{bmatrix}
-({y}_i - \bar{y})^2 - ({z}_i - \bar{z})^2 &amp; ({x}_i - \bar{x})({y}_i - \bar{y})         &amp; ({x}_i - \bar{x})({z}_i - \bar{z})         \\
({x}_i - \bar{x})({y}_i - \bar{y})         &amp; -({x}_i - \bar{x})^2 - ({z}_i - \bar{z})^2 &amp;  ({y}_i - \bar{y})({z}_i - \bar{z})        \\
({x}_i - \bar{x})({z}_i - \bar{z})         &amp; ({y}_i - \bar{y})({z}_i - \bar{z})         &amp; -({x}_i - \bar{x})^2 - ({y}_i - \bar{y})^2 \\
\end{bmatrix} \\
&amp; =
\boldsymbol{I}_i \\
&amp; -
w_i \begin{bmatrix}
({x}_i - \bar{x})^2     &amp; ({x}_i - \bar{x})({y}_i - \bar{y}) &amp; ({x}_i - \bar{x})({z}_i - \bar{z}) \\
({x}_i - \bar{x})({y}_i - \bar{y}) &amp; ({y}_i - \bar{y})^2     &amp; ({y}_i - \bar{y})({z}_i - \bar{z}) \\
({x}_i - \bar{x})({z}_i - \bar{z}) &amp; ({y}_i - \bar{y})({z}_i - \bar{z}) &amp; ({z}_i - \bar{z})^2     \\
\end{bmatrix} \\
&amp; -
w_i \begin{bmatrix}
-({x}_i - \bar{x})^2 - ({y}_i - \bar{y})^2 - ({z}_i - \bar{z})^2 &amp; 0                               &amp; 0                              \\
0                               &amp; -({x}_i - \bar{x})^2 - ({y}_i - \bar{y})^2 - ({z}_i - \bar{z})^2 &amp; 0                              \\
0                               &amp; 0                               &amp;-({x}_i - \bar{x})^2 - ({y}_i - \bar{y})^2 - ({z}_i - \bar{z})^2 \\
\end{bmatrix} \\
&amp; =
\boldsymbol{I}_i
-
w_i \left( \boldsymbol{Q}_i - \mathrm{tr}(\boldsymbol{Q}_i) \boldsymbol{1}_3 \right)
\end{align}
</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi mathvariant="normal">t</mi><mi mathvariant="normal">r</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>𝐐</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mathrm{tr}(\boldsymbol{Q}_i)</annotation></semantics></math>
is the <em>trace</em> of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>𝐐</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\boldsymbol{Q}_i</annotation></semantics></math>,
i.e., the sum of its diagonal elements, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mn>𝟏</mn><mn>3</mn></msub><annotation encoding="application/x-tex">\boldsymbol{1}_3</annotation></semantics></math>
is the 3⨉3 identity matrix. Therefore</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><menclose notation="box"><mrow><mi>𝐈</mi><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>𝐈</mi><mi>i</mi></msub><mo>−</mo><msub><mi>w</mi><mi>i</mi></msub><msub><mi>𝐌</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></menclose><annotation encoding="application/x-tex">
\boxed{
\boldsymbol{I} = \sum_{i=1}^{n} \left( \boldsymbol{I}_i
-
w_i \boldsymbol{M}_i \right)
}
</annotation></semantics></math> where</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><menclose notation="box"><mrow><msub><mi>𝐌</mi><mi>i</mi></msub><mo>=</mo><msub><mi>𝐐</mi><mi>i</mi></msub><mo>−</mo><mrow><mi mathvariant="normal">t</mi><mi mathvariant="normal">r</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>𝐐</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><msub><mn>𝟏</mn><mn>3</mn></msub></mrow></menclose><annotation encoding="application/x-tex">
\boxed{
\boldsymbol{M}_i = \boldsymbol{Q}_i - \mathrm{tr}(\boldsymbol{Q}_i) \boldsymbol{1}_3
}
</annotation></semantics></math></p>
<p>The corresponding <code>R</code> code is</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">amp</span><span class="op">$</span><span class="va">inertia</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Reduce</a></span><span class="op">(</span><span class="va">`+`</span>, <span class="fu"><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Map</a></span><span class="op">(</span></span>
<span>    f  <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">mp</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">d</span> <span class="op">&lt;-</span> <span class="va">amp</span><span class="op">$</span><span class="va">center_mass</span> <span class="op">-</span> <span class="va">mp</span><span class="op">$</span><span class="va">center_mass</span></span>
<span>      <span class="va">Q</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/outer.html" class="external-link">outer</a></span><span class="op">(</span><span class="va">d</span>, <span class="va">d</span><span class="op">)</span></span>
<span>      <span class="va">M</span> <span class="op">&lt;-</span> <span class="va">Q</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">Q</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span>
<span>      <span class="kw">if</span> <span class="op">(</span><span class="va">mp</span><span class="op">$</span><span class="va">point</span><span class="op">)</span> <span class="op">-</span><span class="va">mp</span><span class="op">$</span><span class="va">mass</span> <span class="op">*</span> <span class="va">M</span> <span class="kw">else</span> <span class="va">mp</span><span class="op">$</span><span class="va">inertia</span> <span class="op">-</span> <span class="va">mp</span><span class="op">$</span><span class="va">mass</span> <span class="op">*</span> <span class="va">M</span></span>
<span>    <span class="op">}</span>,</span>
<span>    <span class="va">mpl</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="mass-property-uncertainties">Mass Property Uncertainties<a class="anchor" aria-label="anchor" href="#mass-property-uncertainties"></a>
</h3>
<div class="section level4">
<h4 id="mass-uncertainty">Mass Uncertainty<a class="anchor" aria-label="anchor" href="#mass-uncertainty"></a>
</h4>
<p>The mass uncertainty equation is suitable as is.</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><menclose notation="box"><mrow><msub><mi>σ</mi><mi>w</mi></msub><mo>=</mo><msqrt><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msup><msub><msub><mi>σ</mi><mi>w</mi></msub><mi>i</mi></msub><mn>2</mn></msup></mrow></msqrt></mrow></menclose><annotation encoding="application/x-tex">
\boxed{
\sigma_w = \sqrt{ \sum_{i=1}^n {{\sigma_w}_i}^2 }
}
</annotation></semantics></math></p>
<p>The corresponding <code>R</code> code is</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">amp</span><span class="op">$</span><span class="va">sigma_mass</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Reduce</a></span><span class="op">(</span><span class="va">`+`</span>, <span class="fu"><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Map</a></span><span class="op">(</span>f <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">mp</span><span class="op">)</span> <span class="va">mp</span><span class="op">$</span><span class="va">sigma_mass</span><span class="op">^</span><span class="fl">2</span>, <span class="va">mpl</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="center-of-mass-uncertainty">Center of Mass Uncertainty<a class="anchor" aria-label="anchor" href="#center-of-mass-uncertainty"></a>
</h4>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>σ</mi><mover><mi>x</mi><mo accent="true">‾</mo></mover></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msqrt><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><mo stretchy="true" form="prefix">{</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>w</mi><mi>i</mi></msub><msub><msub><mi>σ</mi><mover><mi>x</mi><mo accent="true">‾</mo></mover></msub><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>+</mo><msup><mrow><mo stretchy="true" form="prefix">[</mo><msub><msub><mi>σ</mi><mi>w</mi></msub><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow><mn>2</mn></msup><mo stretchy="true" form="postfix">}</mo></mrow></mrow></msqrt><mi minsize="2.4" maxsize="2.4">/</mi><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>w</mi><mi>i</mi></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>σ</mi><mover><mi>y</mi><mo accent="true">‾</mo></mover></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msqrt><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><mo stretchy="true" form="prefix">{</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>w</mi><mi>i</mi></msub><msub><msub><mi>σ</mi><mover><mi>y</mi><mo accent="true">‾</mo></mover></msub><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>+</mo><msup><mrow><mo stretchy="true" form="prefix">[</mo><msub><msub><mi>σ</mi><mi>w</mi></msub><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow><mn>2</mn></msup><mo stretchy="true" form="postfix">}</mo></mrow></mrow></msqrt><mi minsize="2.4" maxsize="2.4">/</mi><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>w</mi><mi>i</mi></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>σ</mi><mover><mi>z</mi><mo accent="true">‾</mo></mover></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msqrt><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><mo stretchy="true" form="prefix">{</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>w</mi><mi>i</mi></msub><msub><msub><mi>σ</mi><mover><mi>z</mi><mo accent="true">‾</mo></mover></msub><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>+</mo><msup><mrow><mo stretchy="true" form="prefix">[</mo><msub><msub><mi>σ</mi><mi>w</mi></msub><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow><mn>2</mn></msup><mo stretchy="true" form="postfix">}</mo></mrow></mrow></msqrt><mi minsize="2.4" maxsize="2.4">/</mi><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>w</mi><mi>i</mi></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{align}
\sigma_\bar{x} &amp; = 
  \sqrt{ \sum_{i=1}^n \left\{ (w_i {{\sigma_\bar{x}}}_i)^2 + [{\sigma_w}_i ({x}_i - \bar{x})]^2 \right\} }
  \bigg/ \sum_{i=1}^{n}w_i \\
 \\
\sigma_\bar{y} &amp; = 
  \sqrt{ \sum_{i=1}^n \left\{ (w_i {{\sigma_\bar{y}}}_i)^2 + [{\sigma_w}_i ({y}_i - \bar{y})]^2 \right\} }
  \bigg/ \sum_{i=1}^{n}w_i \\
 \\
\sigma_\bar{z} &amp; = 
  \sqrt{ \sum_{i=1}^n \left\{ (w_i {{\sigma_\bar{z}}}_i)^2 + [{\sigma_w}_i ({z}_i - \bar{z})]^2 \right\} }
  \bigg/ \sum_{i=1}^{n}w_i \\
 \\
\end{align}
</annotation></semantics></math></p>
<p>As before, we create a 3-vector for center of mass uncertainties.
Let</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><menclose notation="box"><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>𝛔</mi><mi>𝐜</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>σ</mi><mover><mi>x</mi><mo accent="true">‾</mo></mover></msub><mspace width="1.0em"></mspace><msub><mi>σ</mi><mover><mi>y</mi><mo accent="true">‾</mo></mover></msub><mspace width="1.0em"></mspace><msub><mi>σ</mi><mover><mi>z</mi><mo accent="true">‾</mo></mover></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>T</mi></msup></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><msub><mi>𝛔</mi><mi>𝐜</mi></msub><mi>i</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><msub><mi>σ</mi><mover><mi>x</mi><mo accent="true">‾</mo></mover></msub><mi>i</mi></msub><mspace width="1.0em"></mspace><msub><msub><mi>σ</mi><mover><mi>y</mi><mo accent="true">‾</mo></mover></msub><mi>i</mi></msub><mspace width="1.0em"></mspace><msub><msub><mi>σ</mi><mover><mi>z</mi><mo accent="true">‾</mo></mover></msub><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>T</mi></msup></mtd></mtr></mtable></menclose><annotation encoding="application/x-tex">
\boxed{
\begin{align}
\boldsymbol{\sigma_c} &amp; = (\sigma_\bar{x} \quad \sigma_\bar{y} \quad \sigma_\bar{z})^T \\
{\boldsymbol{\sigma_c}}_i &amp; = ({\sigma_\bar{x}}_i \quad {\sigma_\bar{y}}_i \quad {\sigma_\bar{z}}_i)^T
\end{align}
}
</annotation></semantics></math></p>
<p>If we construe (as <code>R</code> does) squaring and taking square
roots of vectors element-wise, then</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><menclose notation="box"><mrow><msub><mi>𝛔</mi><mi>𝐜</mi></msub><mo>=</mo><mfrac><mn>1</mn><mi>w</mi></mfrac><msqrt><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><mo stretchy="true" form="prefix">{</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>w</mi><mi>i</mi></msub><msub><msub><mi>𝛔</mi><mi>𝐜</mi></msub><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>+</mo><msup><mrow><mo stretchy="true" form="prefix">[</mo><msub><msub><mi>σ</mi><mi>w</mi></msub><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>𝐜</mi><mi>i</mi></msub><mo>−</mo><mover><mi>𝐜</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow><mn>2</mn></msup><mo stretchy="true" form="postfix">}</mo></mrow></mrow></msqrt></mrow></menclose><annotation encoding="application/x-tex">
\boxed{
\boldsymbol{\sigma_c} = \frac{1}{w}
  \sqrt{ \sum_{i=1}^n \left\{ (w_i {{\boldsymbol{\sigma_c}}}_i)^2 + [{\sigma_w}_i ({\boldsymbol{c}}_i - \bar{\boldsymbol{c}})]^2 \right\}}
}
</annotation></semantics></math></p>
<p>The corresponding <code>R</code> code is</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">amp</span><span class="op">$</span><span class="va">sigma_center_mass</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Reduce</a></span><span class="op">(</span><span class="va">`+`</span>, <span class="fu"><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Map</a></span><span class="op">(</span></span>
<span>    f <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">mp</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="op">(</span><span class="va">mp</span><span class="op">$</span><span class="va">mass</span> <span class="op">*</span> <span class="va">mp</span><span class="op">$</span><span class="va">sigma_center_mass</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span></span>
<span>        <span class="op">(</span><span class="va">mp</span><span class="op">$</span><span class="va">sigma_mass</span> <span class="op">*</span> <span class="op">(</span><span class="va">mp</span><span class="op">$</span><span class="va">center_mass</span> <span class="op">-</span> <span class="va">amp</span><span class="op">$</span><span class="va">center_mass</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span></span>
<span>    <span class="op">}</span>,</span>
<span>    <span class="va">mpl</span></span>
<span>  <span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="va">amp</span><span class="op">$</span><span class="va">mass</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="inertia-tensor-uncertainty">Inertia Tensor Uncertainty<a class="anchor" aria-label="anchor" href="#inertia-tensor-uncertainty"></a>
</h4>
<div class="section level5">
<h5 id="moments-of-inertia-uncertainties">Moments of Inertia Uncertainties<a class="anchor" aria-label="anchor" href="#moments-of-inertia-uncertainties"></a>
</h5>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>σ</mi><msub><mi>I</mi><mrow><mi>X</mi><mi>X</mi></mrow></msub></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msqrt><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><mo stretchy="true" form="prefix">{</mo><msubsup><mi>σ</mi><msub><msub><mi>I</mi><mrow><mi>X</mi><mi>X</mi></mrow></msub><mi>i</mi></msub><mn>2</mn></msubsup><mo>+</mo><msup><mrow><mo stretchy="true" form="prefix">[</mo><mn>2</mn><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>y</mi><mi>i</mi></msub></msub><mo stretchy="true" form="postfix">]</mo></mrow><mn>2</mn></msup><mo>+</mo><msup><mrow><mo stretchy="true" form="prefix">[</mo><mn>2</mn><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>z</mi><mi>i</mi></msub></msub><mo stretchy="true" form="postfix">]</mo></mrow><mn>2</mn></msup><mo>+</mo><msup><mrow><mo stretchy="true" form="prefix">[</mo><mrow><mo stretchy="true" form="prefix">(</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>+</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>w</mi><mi>i</mi></msub></msub><mo stretchy="true" form="postfix">]</mo></mrow><mn>2</mn></msup><mo stretchy="true" form="postfix">}</mo></mrow></mrow></msqrt></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>σ</mi><msub><mi>I</mi><mrow><mi>Y</mi><mi>Y</mi></mrow></msub></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msqrt><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><mo stretchy="true" form="prefix">{</mo><msubsup><mi>σ</mi><msub><msub><mi>I</mi><mrow><mi>Y</mi><mi>Y</mi></mrow></msub><mi>i</mi></msub><mn>2</mn></msubsup><mo>+</mo><msup><mrow><mo stretchy="true" form="prefix">[</mo><mn>2</mn><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>x</mi><mi>i</mi></msub></msub><mo stretchy="true" form="postfix">]</mo></mrow><mn>2</mn></msup><mo>+</mo><msup><mrow><mo stretchy="true" form="prefix">[</mo><mn>2</mn><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>z</mi><mi>i</mi></msub></msub><mo stretchy="true" form="postfix">]</mo></mrow><mn>2</mn></msup><mo>+</mo><msup><mrow><mo stretchy="true" form="prefix">[</mo><mrow><mo stretchy="true" form="prefix">(</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>+</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>w</mi><mi>i</mi></msub></msub><mo stretchy="true" form="postfix">]</mo></mrow><mn>2</mn></msup><mo stretchy="true" form="postfix">}</mo></mrow></mrow></msqrt></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>σ</mi><msub><mi>I</mi><mrow><mi>Z</mi><mi>Z</mi></mrow></msub></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msqrt><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><mo stretchy="true" form="prefix">{</mo><msubsup><mi>σ</mi><msub><msub><mi>I</mi><mrow><mi>Z</mi><mi>Z</mi></mrow></msub><mi>i</mi></msub><mn>2</mn></msubsup><mo>+</mo><msup><mrow><mo stretchy="true" form="prefix">[</mo><mn>2</mn><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>x</mi><mi>i</mi></msub></msub><mo stretchy="true" form="postfix">]</mo></mrow><mn>2</mn></msup><mo>+</mo><msup><mrow><mo stretchy="true" form="prefix">[</mo><mn>2</mn><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>y</mi><mi>i</mi></msub></msub><mo stretchy="true" form="postfix">]</mo></mrow><mn>2</mn></msup><mo>+</mo><msup><mrow><mo stretchy="true" form="prefix">[</mo><mrow><mo stretchy="true" form="prefix">(</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>+</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>w</mi><mi>i</mi></msub></msub><mo stretchy="true" form="postfix">]</mo></mrow><mn>2</mn></msup><mo stretchy="true" form="postfix">}</mo></mrow></mrow></msqrt></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{align}
\sigma_{I_{XX}} &amp; = \sqrt{ \sum_{i=1}^n \left\{
  \sigma_{{I_{XX}}_i}^2 + \left[ 2 w_i ({y}_i - \bar{y}) \sigma_{{y}_i} \right]^2 + \left[ 2 w_i ({z}_i - \bar{z}) \sigma_{{z}_i} \right]^2 + \left[ \left(({y}_i - \bar{y})^2 + ({z}_i - \bar{z})^2 \right)\sigma_{w_i}\right]^2 \right\} }
 \\
\sigma_{I_{YY}} &amp; = \sqrt{ \sum_{i=1}^n \left\{
  \sigma_{{I_{YY}}_i}^2 + \left[ 2 w_i ({x}_i - \bar{x}) \sigma_{{x}_i} \right]^2 + \left[ 2 w_i ({z}_i - \bar{z}) \sigma_{{z}_i} \right]^2 + \left[ \left(({x}_i - \bar{x})^2 + ({z}_i - \bar{z})^2 \right)\sigma_{w_i}\right]^2 \right\} }
 \\
\sigma_{I_{ZZ}} &amp; = \sqrt{ \sum_{i=1}^n \left\{
  \sigma_{{I_{ZZ}}_i}^2 + \left[ 2 w_i ({x}_i - \bar{x}) \sigma_{{x}_i} \right]^2 + \left[ 2 w_i ({y}_i - \bar{y}) \sigma_{{y}_i} \right]^2 + \left[ \left(({x}_i - \bar{x})^2 + ({y}_i - \bar{y})^2 \right)\sigma_{w_i}\right]^2 \right\} }
 \\
\end{align}
</annotation></semantics></math></p>
</div>
<div class="section level5">
<h5 id="products-of-inertia-uncertainties">Products of Inertia Uncertainties<a class="anchor" aria-label="anchor" href="#products-of-inertia-uncertainties"></a>
</h5>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>σ</mi><msub><mi>I</mi><mrow><mi>X</mi><mi>Y</mi></mrow></msub></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msqrt><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><mo stretchy="true" form="prefix">{</mo><msubsup><mi>σ</mi><msub><msub><mi>I</mi><mrow><mi>X</mi><mi>Y</mi></mrow></msub><mi>i</mi></msub><mn>2</mn></msubsup><mo>+</mo><msup><mrow><mo stretchy="true" form="prefix">[</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>w</mi><mi>i</mi></msub><msub><mi>σ</mi><msub><mi>y</mi><mi>i</mi></msub></msub><mo stretchy="true" form="postfix">]</mo></mrow><mn>2</mn></msup><mo>+</mo><msup><mrow><mo stretchy="true" form="prefix">[</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>w</mi><mi>i</mi></msub></msub><mo stretchy="true" form="postfix">]</mo></mrow><mn>2</mn></msup><mo>+</mo><msup><mrow><mo stretchy="true" form="prefix">[</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>w</mi><mi>i</mi></msub><msub><mi>σ</mi><msub><mi>x</mi><mi>i</mi></msub></msub><mo stretchy="true" form="postfix">]</mo></mrow><mn>2</mn></msup><mo stretchy="true" form="postfix">}</mo></mrow></mrow></msqrt></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>σ</mi><msub><mi>I</mi><mrow><mi>X</mi><mi>Z</mi></mrow></msub></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msqrt><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><mo stretchy="true" form="prefix">{</mo><msubsup><mi>σ</mi><msub><msub><mi>I</mi><mrow><mi>X</mi><mi>Z</mi></mrow></msub><mi>i</mi></msub><mn>2</mn></msubsup><mo>+</mo><msup><mrow><mo stretchy="true" form="prefix">[</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>w</mi><mi>i</mi></msub><msub><mi>σ</mi><msub><mi>z</mi><mi>i</mi></msub></msub><mo stretchy="true" form="postfix">]</mo></mrow><mn>2</mn></msup><mo>+</mo><msup><mrow><mo stretchy="true" form="prefix">[</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>w</mi><mi>i</mi></msub></msub><mo stretchy="true" form="postfix">]</mo></mrow><mn>2</mn></msup><mo>+</mo><msup><mrow><mo stretchy="true" form="prefix">[</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>w</mi><mi>i</mi></msub><msub><mi>σ</mi><msub><mi>x</mi><mi>i</mi></msub></msub><mo stretchy="true" form="postfix">]</mo></mrow><mn>2</mn></msup><mo stretchy="true" form="postfix">}</mo></mrow></mrow></msqrt></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>σ</mi><msub><mi>I</mi><mrow><mi>Y</mi><mi>Z</mi></mrow></msub></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msqrt><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><mo stretchy="true" form="prefix">{</mo><msubsup><mi>σ</mi><msub><msub><mi>I</mi><mrow><mi>Y</mi><mi>Z</mi></mrow></msub><mi>i</mi></msub><mn>2</mn></msubsup><mo>+</mo><msup><mrow><mo stretchy="true" form="prefix">[</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>w</mi><mi>i</mi></msub><msub><mi>σ</mi><msub><mi>z</mi><mi>i</mi></msub></msub><mo stretchy="true" form="postfix">]</mo></mrow><mn>2</mn></msup><mo>+</mo><msup><mrow><mo stretchy="true" form="prefix">[</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>w</mi><mi>i</mi></msub></msub><mo stretchy="true" form="postfix">]</mo></mrow><mn>2</mn></msup><mo>+</mo><msup><mrow><mo stretchy="true" form="prefix">[</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>w</mi><mi>i</mi></msub><msub><mi>σ</mi><msub><mi>y</mi><mi>i</mi></msub></msub><mo stretchy="true" form="postfix">]</mo></mrow><mn>2</mn></msup><mo stretchy="true" form="postfix">}</mo></mrow></mrow></msqrt></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{align}
\sigma_{I_{XY}} &amp; = \sqrt{ \sum_{i=1}^n \left\{
  \sigma_{{I_{XY}}_i}^2 + \left[ ({x}_i - \bar{x}) w_i \sigma_{{y}_i}\right]^2 + \left[ ({x}_i - \bar{x})({y}_i - \bar{y})\sigma_{w_i} \right]^2 + \left[ ({y}_i - \bar{y})  w_i \sigma_{{x}_i} \right]^2 \right\} }
 \\
\sigma_{I_{XZ}} &amp; = \sqrt{ \sum_{i=1}^n \left\{
  \sigma_{{I_{XZ}}_i}^2 + \left[ ({x}_i - \bar{x}) w_i \sigma_{{z}_i}\right]^2 + \left[ ({x}_i - \bar{x})({z}_i - \bar{z})\sigma_{w_i} \right]^2 + \left[ ({z}_i - \bar{z})  w_i \sigma_{{x}_i} \right]^2 \right\} }
 \\
\sigma_{I_{YZ}} &amp; = \sqrt{ \sum_{i=1}^n \left\{
  \sigma_{{I_{YZ}}_i}^2 + \left[ ({y}_i - \bar{y}) w_i \sigma_{{z}_i}\right]^2 + \left[ ({y}_i - \bar{y})({z}_i - \bar{z})\sigma_{w_i} \right]^2 + \left[ ({z}_i - \bar{z})  w_i \sigma_{{y}_i} \right]^2 \right\} }
 \\
\end{align}
</annotation></semantics></math></p>
</div>
<div class="section level5">
<h5 id="matrix-formulation-1">Matrix Formulation<a class="anchor" aria-label="anchor" href="#matrix-formulation-1"></a>
</h5>
<p>Let</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><menclose notation="box"><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>𝐝</mi><mi>i</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="1.0em"></mspace><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="1.0em"></mspace><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mi>T</mi></msup></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><msub><mi>𝛔</mi><mi>𝐜</mi></msub><mi>i</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><msub><mi>σ</mi><mover><mi>x</mi><mo accent="true">‾</mo></mover></msub><mi>i</mi></msub><mspace width="1.0em"></mspace><msub><msub><mi>σ</mi><mover><mi>y</mi><mo accent="true">‾</mo></mover></msub><mi>i</mi></msub><mspace width="1.0em"></mspace><msub><msub><mi>σ</mi><mover><mi>z</mi><mo accent="true">‾</mo></mover></msub><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>T</mi></msup></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>𝐏</mi><mi>i</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msub><mi>𝐝</mi><mi>i</mi></msub><msubsup><msub><mi>𝛔</mi><mi>𝐜</mi></msub><mi>i</mi><mi>T</mi></msubsup></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>𝐐</mi><mi>i</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msub><mi>𝐝</mi><mi>i</mi></msub><msup><msub><mi>𝐝</mi><mi>i</mi></msub><mi>T</mi></msup></mtd></mtr></mtable></menclose><annotation encoding="application/x-tex">
\boxed{
\begin{align}
\boldsymbol{d}_i &amp; = (({x}_i - \bar{x}) \quad ({y}_i - \bar{y}) \quad ({z}_i - \bar{z}))^T \\
{\boldsymbol{\sigma_c}}_i &amp; = ({\sigma_\bar{x}}_i \quad {\sigma_\bar{y}}_i \quad {\sigma_\bar{z}}_i)^T \\
\boldsymbol{P}_i &amp; = \boldsymbol{d}_i {\boldsymbol{\sigma_c}}_i^T \\
\boldsymbol{Q}_i &amp; = \boldsymbol{d}_i {\boldsymbol{d}_i}^T
\end{align}
}
</annotation></semantics></math></p>
<p>Then</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>𝐏</mi><mi>i</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mrow><mo stretchy="true" form="prefix">[</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>x</mi><mi>i</mi></msub></msub></mtd><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>y</mi><mi>i</mi></msub></msub></mtd><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>z</mi><mi>i</mi></msub></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>x</mi><mi>i</mi></msub></msub></mtd><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>y</mi><mi>i</mi></msub></msub></mtd><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>z</mi><mi>i</mi></msub></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>x</mi><mi>i</mi></msub></msub></mtd><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>y</mi><mi>i</mi></msub></msub></mtd><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>z</mi><mi>i</mi></msub></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><mo stretchy="true" form="postfix">]</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>𝐐</mi><mi>i</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mrow><mo stretchy="true" form="prefix">[</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mtd><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="center" style="text-align: center"><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mtd><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="center" style="text-align: center"><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><mo stretchy="true" form="postfix">]</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{align}
\boldsymbol{P}_i &amp; =
\begin{bmatrix}
({x}_i - \bar{x})\sigma_{x_i} &amp;({x}_i - \bar{x})\sigma_{y_i} &amp;({x}_i - \bar{x})\sigma_{z_i} \\
({y}_i - \bar{y})\sigma_{x_i} &amp; ({y}_i - \bar{y})\sigma_{y_i} &amp; ({y}_i - \bar{y})\sigma_{z_i} \\
({z}_i - \bar{z})\sigma_{x_i} &amp; ({z}_i - \bar{z})\sigma_{y_i} &amp; ({z}_i - \bar{z})\sigma_{z_i} \\
\end{bmatrix}
\\
\\
\boldsymbol{Q}_i &amp; =
\begin{bmatrix}
({x}_i - \bar{x})^2 &amp;({x}_i - \bar{x})({y}_i - \bar{y}) &amp;({x}_i - \bar{x})({z}_i - \bar{z}) \\
({y}_i - \bar{y})({x}_i - \bar{x}) &amp; ({y}_i - \bar{y})^2 &amp; ({y}_i - \bar{y})({z}_i - \bar{z}) \\
({z}_i - \bar{z})({x}_i - \bar{x}) &amp; ({z}_i - \bar{z})({y}_i - \bar{y}) &amp; ({z}_i - \bar{z})^2 \\
\end{bmatrix}
\end{align}
</annotation></semantics></math></p>
<p>Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>𝐬</mi><mi>i</mi><mn>2</mn></msubsup><annotation encoding="application/x-tex">\boldsymbol{s}_i^2</annotation></semantics></math>
be the matrix of inertia tensor uncertainty summands in the standard
formulas for a given subcomponent
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
above. That is,</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><msub><mi>𝛔</mi><mi>𝐈</mi></msub><mn>2</mn></msup><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msubsup><mi>𝐬</mi><mi>i</mi><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">
\boldsymbol{\sigma_I}^2 = \sum_{i=1}^{n} \boldsymbol{s}_i^2
</annotation></semantics></math></p>
<p>Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><msub><mi>p</mi><mi>X</mi></msub><mi>i</mi></msub><annotation encoding="application/x-tex">{p_X}_i</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><msub><mi>p</mi><mi>Y</mi></msub><mi>i</mi></msub><annotation encoding="application/x-tex">{p_Y}_i</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><msub><mi>p</mi><mi>Z</mi></msub><mi>i</mi></msub><annotation encoding="application/x-tex">{p_Z}_i</annotation></semantics></math>
be the respective diagonal elements of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>P</mi><mi>i</mi></msub><annotation encoding="application/x-tex">P_i</annotation></semantics></math>.
Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mn>𝟏</mn><mn>3</mn></msub><annotation encoding="application/x-tex">\boldsymbol{1}_3</annotation></semantics></math>
be the 3 ⨉ 3 identity matrix. If we interpret squaring a matrix as the
Hadamard (element-wise) product with itself, then
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msubsup><mi>𝐬</mi><mi>i</mi><mn>2</mn></msubsup></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msubsup><msub><mi>𝛔</mi><mi>𝐈</mi></msub><mi>i</mi><mn>2</mn></msubsup></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>+</mo><msup><mrow><mo stretchy="true" form="prefix">[</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mn>2</mn><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>y</mi><mi>i</mi></msub></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>y</mi><mi>i</mi></msub></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>z</mi><mi>i</mi></msub></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>y</mi><mi>i</mi></msub></msub></mtd><mtd columnalign="center" style="text-align: center"><mn>2</mn><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>x</mi><mi>i</mi></msub></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>z</mi><mi>i</mi></msub></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>z</mi><mi>i</mi></msub></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>z</mi><mi>i</mi></msub></msub></mtd><mtd columnalign="center" style="text-align: center"><mn>2</mn><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>x</mi><mi>i</mi></msub></msub></mtd></mtr></mtable><mo stretchy="true" form="postfix">]</mo></mrow><mn>2</mn></msup></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>+</mo><msup><mrow><mo stretchy="true" form="prefix">[</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mn>2</mn><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>z</mi><mi>i</mi></msub></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>x</mi><mi>i</mi></msub></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>x</mi><mi>i</mi></msub></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>x</mi><mi>i</mi></msub></msub></mtd><mtd columnalign="center" style="text-align: center"><mn>2</mn><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>z</mi><mi>i</mi></msub></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>y</mi><mi>i</mi></msub></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>x</mi><mi>i</mi></msub></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>y</mi><mi>i</mi></msub></msub></mtd><mtd columnalign="center" style="text-align: center"><mn>2</mn><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>y</mi><mi>i</mi></msub></msub></mtd></mtr></mtable><mo stretchy="true" form="postfix">]</mo></mrow><mn>2</mn></msup></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>+</mo><msup><mrow><mo stretchy="true" form="prefix">[</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>+</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>w</mi><mi>i</mi></msub></msub></mtd><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>w</mi><mi>i</mi></msub></msub></mtd><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>w</mi><mi>i</mi></msub></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>w</mi><mi>i</mi></msub></msub></mtd><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>+</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>w</mi><mi>i</mi></msub></msub></mtd><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>w</mi><mi>i</mi></msub></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>w</mi><mi>i</mi></msub></msub></mtd><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>w</mi><mi>i</mi></msub></msub></mtd><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>+</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>w</mi><mi>i</mi></msub></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><mo stretchy="true" form="postfix">]</mo></mrow><mn>2</mn></msup></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msubsup><msub><mi>𝛔</mi><mi>𝐈</mi></msub><mi>i</mi><mn>2</mn></msubsup></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>+</mo><msubsup><mi>w</mi><mi>i</mi><mn>2</mn></msubsup><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>𝐏</mi><mi>i</mi></msub><mo>−</mo><mrow><mo stretchy="true" form="prefix">[</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>x</mi><mi>i</mi></msub></msub><mo>−</mo><mn>2</mn><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>y</mi><mi>i</mi></msub></msub></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>y</mi><mi>i</mi></msub></msub><mo>−</mo><mn>2</mn><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>x</mi><mi>i</mi></msub></msub></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>y</mi><mi>i</mi></msub></msub><mo>−</mo><mn>2</mn><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>x</mi><mi>i</mi></msub></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><mo stretchy="true" form="postfix">]</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>+</mo><msubsup><mi>w</mi><mi>i</mi><mn>2</mn></msubsup><msup><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>𝐏</mi><mi>i</mi><mi>T</mi></msubsup><mo>−</mo><mrow><mo stretchy="true" form="prefix">[</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>x</mi><mi>i</mi></msub></msub><mo>−</mo><mn>2</mn><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>y</mi><mi>i</mi></msub></msub></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>y</mi><mi>i</mi></msub></msub><mo>−</mo><mn>2</mn><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>z</mi><mi>i</mi></msub></msub></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>y</mi><mi>i</mi></msub></msub><mo>−</mo><mn>2</mn><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>y</mi><mi>i</mi></msub></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><mo stretchy="true" form="postfix">]</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>+</mo><msubsup><mi>σ</mi><msub><mi>w</mi><mi>i</mi></msub><mn>2</mn></msubsup><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>𝐐</mi><mi>i</mi></msub><mo>−</mo><mrow><mi mathvariant="normal">t</mi><mi mathvariant="normal">r</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>𝐐</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><msub><mn>𝟏</mn><mn>3</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msubsup><msub><mi>𝛔</mi><mi>𝐈</mi></msub><mi>i</mi><mn>2</mn></msubsup></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>+</mo><msubsup><mi>w</mi><mi>i</mi><mn>2</mn></msubsup><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>𝐏</mi><mi>i</mi></msub><mo>−</mo><mrow><mo stretchy="true" form="prefix">[</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><msub><mi>p</mi><mi>X</mi></msub><mi>i</mi></msub><mo>−</mo><mn>2</mn><msub><msub><mi>p</mi><mi>Y</mi></msub><mi>i</mi></msub></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><msub><msub><mi>p</mi><mi>Y</mi></msub><mi>i</mi></msub><mo>−</mo><mn>2</mn><msub><msub><mi>p</mi><mi>X</mi></msub><mi>i</mi></msub></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><msub><msub><mi>p</mi><mi>Z</mi></msub><mi>i</mi></msub><mo>−</mo><mn>2</mn><msub><msub><mi>p</mi><mi>X</mi></msub><mi>i</mi></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><mo stretchy="true" form="postfix">]</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>+</mo><msubsup><mi>w</mi><mi>i</mi><mn>2</mn></msubsup><msup><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>𝐏</mi><mi>i</mi><mi>T</mi></msubsup><mo>−</mo><mrow><mo stretchy="true" form="prefix">[</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><msub><mi>p</mi><mi>X</mi></msub><mi>i</mi></msub><mo>−</mo><mn>2</mn><msub><msub><mi>p</mi><mi>Z</mi></msub><mi>i</mi></msub></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><msub><msub><mi>p</mi><mi>Y</mi></msub><mi>i</mi></msub><mo>−</mo><mn>2</mn><msub><msub><mi>p</mi><mi>Z</mi></msub><mi>i</mi></msub></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><msub><msub><mi>p</mi><mi>Z</mi></msub><mi>i</mi></msub><mo>−</mo><mn>2</mn><msub><msub><mi>p</mi><mi>Y</mi></msub><mi>i</mi></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><mo stretchy="true" form="postfix">]</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>+</mo><msubsup><mi>σ</mi><msub><mi>w</mi><mi>i</mi></msub><mn>2</mn></msubsup><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>𝐐</mi><mi>i</mi></msub><mo>−</mo><mrow><mi mathvariant="normal">t</mi><mi mathvariant="normal">r</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>𝐐</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><msub><mn>𝟏</mn><mn>3</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{align}
\boldsymbol{s}_i^2 &amp; = {\boldsymbol{\sigma_I}}_i^2 \\
&amp; +
\begin{bmatrix}
2 w_i ({y}_i - \bar{y}) \sigma_{y_i} &amp;   w_i({x}_i - \bar{x}) \sigma_{y_i} &amp;   w_i({x}_i - \bar{x}) \sigma_{z_i} \\
  w_i({x}_i - \bar{x}) \sigma_{y_i} &amp; 2 w_i({x}_i - \bar{x}) \sigma_{x_i} &amp;   w_i ({y}_i - \bar{y}) \sigma_{z_i} \\
  w_i({x}_i - \bar{x}) \sigma_{z_i} &amp;   w_i ({y}_i - \bar{y}) \sigma_{z_i} &amp; 2 w_i({x}_i - \bar{x}) \sigma_{x_i}
\end{bmatrix}^2 \\
&amp; +
\begin{bmatrix}
2 w_i ({z}_i - \bar{z}) \sigma_{z_i} &amp;   w_i ({y}_i - \bar{y}) \sigma_{x_i} &amp;   w_i ({z}_i - \bar{z}) \sigma_{x_i} \\
  w_i ({y}_i - \bar{y}) \sigma_{x_i} &amp; 2 w_i ({z}_i - \bar{z}) \sigma_{z_i} &amp;   w_i ({z}_i - \bar{z}) \sigma_{y_i} \\
  w_i ({z}_i - \bar{z}) \sigma_{x_i} &amp;   w_i ({z}_i - \bar{z}) \sigma_{y_i} &amp; 2 w_i ({y}_i - \bar{y}) \sigma_{y_i}
\end{bmatrix}^2 \\
&amp; +
\begin{bmatrix}
(({y}_i - \bar{y})^2 + ({z}_i - \bar{z})^2)\sigma_{w_i} &amp;({x}_i - \bar{x})({y}_i - \bar{y})\sigma_{w_i} &amp;({x}_i - \bar{x})({z}_i - \bar{z})\sigma_{w_i} \\
({y}_i - \bar{y})({x}_i - \bar{x})\sigma_{w_i} &amp; (({x}_i - \bar{x})^2 + ({z}_i - \bar{z})^2)\sigma_{w_i} &amp; ({y}_i - \bar{y})({z}_i - \bar{z})\sigma_{w_i} \\
({z}_i - \bar{z})({x}_i - \bar{x})\sigma_{w_i} &amp; ({z}_i - \bar{z})({y}_i - \bar{y})\sigma_{w_i} &amp; (({x}_i - \bar{x})^2 + ({y}_i - \bar{y})^2)\sigma_{w_i} \\
\end{bmatrix}^2 \\ \\
&amp; = {\boldsymbol{\sigma_I}}_i^2 \\
&amp; + w_i^2 \left(
\boldsymbol{P}_i -
\begin{bmatrix}
({x}_i - \bar{x})\sigma_{x_i} - 2 ({y}_i - \bar{y})\sigma_{y_i} &amp; 0 &amp; 0 \\
0 &amp; ({y}_i - \bar{y})\sigma_{y_i} - 2({x}_i - \bar{x})\sigma_{x_i} &amp; 0 \\
0 &amp; 0 &amp; ({z}_i - \bar{z})\sigma_{y_i} - 2({x}_i - \bar{x})\sigma_{x_i} \\
\end{bmatrix}
\right) ^2 \\
&amp; + w_i^2 \left(
\boldsymbol{P}_i^T -
\begin{bmatrix}
({x}_i - \bar{x})\sigma_{x_i} - 2 ({z}_i - \bar{z})\sigma_{y_i} &amp; 0 &amp; 0 \\
0 &amp; ({y}_i - \bar{y})\sigma_{y_i} - 2 ({z}_i - \bar{z})\sigma_{z_i} &amp; 0 \\
0 &amp; 0 &amp; ({z}_i - \bar{z})\sigma_{y_i} - 2 ({y}_i - \bar{y})\sigma_{y_i} \\
\end{bmatrix}
\right) ^2 \\
&amp; + \sigma_{w_i}^2 \left(
\boldsymbol{Q}_i - \mathrm{tr}(\boldsymbol{Q}_i)\boldsymbol{1}_3
\right)^2 \\ \\
&amp; = {\boldsymbol{\sigma_I}}_i^2 \\
&amp; + w_i^2 \left(
\boldsymbol{P}_i -
\begin{bmatrix}
 {p_X}_i - 2 {p_Y}_i &amp; 0 &amp; 0 \\
0 &amp; {p_Y}_i - 2 {p_X}_i &amp; 0 \\
0 &amp; 0 &amp; {p_Z}_i - 2  {p_X}_i \\
\end{bmatrix}
\right) ^2 \\
&amp; + w_i^2 \left(
\boldsymbol{P}_i^T -
\begin{bmatrix}
 {p_X}_i - 2{p_Z}_i &amp; 0 &amp; 0 \\
0 &amp; {p_Y}_i - 2 {p_Z}_i &amp; 0 \\
0 &amp; 0 &amp; {p_Z}_i - 2 {p_Y}_i \\
\end{bmatrix}
\right) ^2 \\
&amp; + \sigma_{w_i}^2 \left(
\boldsymbol{Q}_i - \mathrm{tr}(\boldsymbol{Q}_i)\boldsymbol{1}_3
\right)^2
\end{align}
</annotation></semantics></math></p>
<p>Finally,</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><menclose notation="box"><mrow><msub><mi>𝛔</mi><mi>𝐈</mi></msub><mo>=</mo><msqrt><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><mo stretchy="true" form="prefix">{</mo><msubsup><msub><mi>𝛔</mi><mi>𝐈</mi></msub><mi>i</mi><mn>2</mn></msubsup><mo>+</mo><msub><msub><mi>𝐌</mi><mn>4</mn></msub><mi>i</mi></msub><mo stretchy="true" form="postfix">}</mo></mrow></mrow></msqrt></mrow></menclose><annotation encoding="application/x-tex">
\boxed{
\boldsymbol{\sigma_I} = \sqrt{
\sum_{i=1}^{n} {\left\{
{\boldsymbol{\sigma_I}}_i^2
+{\boldsymbol{M}_4}_i
\right\}}
}
}
</annotation></semantics></math></p>
<p>where</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><menclose notation="box"><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><msub><mi>𝐌</mi><mn>1</mn></msub><mi>i</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msub><mi>𝐏</mi><mi>i</mi></msub><mo>−</mo><mrow><mo stretchy="true" form="prefix">[</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><msub><mi>p</mi><mi>X</mi></msub><mi>i</mi></msub><mo>−</mo><mn>2</mn><msub><msub><mi>p</mi><mi>Y</mi></msub><mi>i</mi></msub></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><msub><msub><mi>p</mi><mi>Y</mi></msub><mi>i</mi></msub><mo>−</mo><mn>2</mn><msub><msub><mi>p</mi><mi>X</mi></msub><mi>i</mi></msub></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>2</mn><msub><msub><mi>p</mi><mi>Z</mi></msub><mi>i</mi></msub><mo>−</mo><mn>2</mn><msub><msub><mi>p</mi><mi>X</mi></msub><mi>i</mi></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><mo stretchy="true" form="postfix">]</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><msub><mi>𝐌</mi><mn>2</mn></msub><mi>i</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msubsup><mi>𝐏</mi><mi>i</mi><mi>T</mi></msubsup><mo>−</mo><mrow><mo stretchy="true" form="prefix">[</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><msub><mi>p</mi><mi>X</mi></msub><mi>i</mi></msub><mo>−</mo><mn>2</mn><msub><msub><mi>p</mi><mi>Z</mi></msub><mi>i</mi></msub></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><msub><msub><mi>p</mi><mi>Y</mi></msub><mi>i</mi></msub><mo>−</mo><mn>2</mn><msub><msub><mi>p</mi><mi>Z</mi></msub><mi>i</mi></msub></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>2</mn><msub><msub><mi>p</mi><mi>Z</mi></msub><mi>i</mi></msub><mo>−</mo><mn>2</mn><msub><msub><mi>p</mi><mi>Y</mi></msub><mi>i</mi></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><mo stretchy="true" form="postfix">]</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><msub><mi>𝐌</mi><mn>3</mn></msub><mi>i</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msub><mi>𝐐</mi><mi>i</mi></msub><mo>−</mo><mrow><mi mathvariant="normal">t</mi><mi mathvariant="normal">r</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>𝐐</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><msub><mn>𝟏</mn><mn>3</mn></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><msub><mi>𝐌</mi><mn>4</mn></msub><mi>i</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msubsup><mi>w</mi><mi>i</mi><mn>2</mn></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><msup><msub><msub><mi>𝐌</mi><mn>1</mn></msub><mi>i</mi></msub><mn>2</mn></msup><mo>+</mo><msup><msub><msub><mi>𝐌</mi><mn>2</mn></msub><mi>i</mi></msub><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>σ</mi><msub><mi>w</mi><mi>i</mi></msub></msub><msub><msub><mi>𝐌</mi><mn>3</mn></msub><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mtd></mtr></mtable></menclose><annotation encoding="application/x-tex">
\boxed{
\begin{align}
{\boldsymbol{M}_1}_i &amp; = \boldsymbol{P}_i - 
\begin{bmatrix}
{p_X}_i - 2{p_Y}_i &amp; 0 &amp; 0 \\
0 &amp; {p_Y}_i - 2{p_X}_i &amp; 0 \\
0 &amp; 0 &amp; 2{p_Z}_i - 2{p_X}_i \\
\end{bmatrix} \\
{\boldsymbol{M}_2}_i &amp; = \boldsymbol{P}_i^T -
\begin{bmatrix}
{p_X}_i - 2{p_Z}_i &amp; 0 &amp; 0 \\
0 &amp; {p_Y}_i - 2{p_Z}_i &amp; 0 \\
0 &amp; 0 &amp; 2{p_Z}_i - 2{p_Y}_i \\
\end{bmatrix} \\
{\boldsymbol{M}_3}_i &amp; = \boldsymbol{Q}_i - \mathrm{tr}(\boldsymbol{Q}_i)\boldsymbol{1}_3 \\
{\boldsymbol{M}_4}_i &amp; =  w_i^2 \left(
{{\boldsymbol{M}_1}_i}^2 + {{\boldsymbol{M}_2}_i}^2
\right)
+ \left( \sigma_{w_i} {\boldsymbol{M}_3}_i
\right)^2
\end{align}
}
</annotation></semantics></math></p>
<p>The corresponding <code>R</code> code is</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">amp</span><span class="op">$</span><span class="va">sigma_inertia</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Reduce</a></span><span class="op">(</span><span class="va">`+`</span>, <span class="fu"><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Map</a></span><span class="op">(</span></span>
<span>    f <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">mp</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span>      <span class="va">d</span> <span class="op">&lt;-</span> <span class="va">mp</span><span class="op">$</span><span class="va">center_mass</span> <span class="op">-</span> <span class="va">amp</span><span class="op">$</span><span class="va">center_mass</span></span>
<span></span>
<span>      <span class="va">P</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/outer.html" class="external-link">outer</a></span><span class="op">(</span><span class="va">d</span>, <span class="va">mp</span><span class="op">$</span><span class="va">sigma_center_mass</span><span class="op">)</span></span>
<span>      <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">P</span><span class="op">)</span></span>
<span></span>
<span>      <span class="va">Q</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/outer.html" class="external-link">outer</a></span><span class="op">(</span><span class="va">d</span>, <span class="va">d</span><span class="op">)</span></span>
<span></span>
<span>      <span class="va">M1</span> <span class="op">&lt;-</span>   <span class="va">P</span>  <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">p</span> <span class="op">-</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">p</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"y"</span>, <span class="st">"x"</span>, <span class="st">"x"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span>      <span class="va">M2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">P</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">p</span> <span class="op">-</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">p</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"z"</span>, <span class="st">"z"</span>, <span class="st">"y"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span>      <span class="va">M3</span> <span class="op">&lt;-</span>   <span class="va">Q</span>  <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">Q</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span>
<span>      <span class="va">M4</span> <span class="op">&lt;-</span> <span class="va">mp</span><span class="op">$</span><span class="va">mass</span><span class="op">^</span><span class="fl">2</span> <span class="op">*</span> <span class="op">(</span><span class="va">M1</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="va">M2</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="va">mp</span><span class="op">$</span><span class="va">sigma_mass</span> <span class="op">*</span> <span class="va">M3</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span></span>
<span></span>
<span>      <span class="kw">if</span> <span class="op">(</span><span class="va">mp</span><span class="op">$</span><span class="va">point</span><span class="op">)</span> <span class="va">M4</span> <span class="kw">else</span> <span class="va">mp</span><span class="op">$</span><span class="va">sigma_inertia</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="va">M4</span></span>
<span>    <span class="op">}</span>,</span>
<span>    <span class="va">mpl</span></span>
<span>  <span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="radii-of-gyration-and-their-uncertainties">Radii of Gyration and Their Uncertainties<a class="anchor" aria-label="anchor" href="#radii-of-gyration-and-their-uncertainties"></a>
</h3>
<p>By definition:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>k</mi><mi>X</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msqrt><mrow><msub><mi>I</mi><mrow><mi>X</mi><mi>X</mi></mrow></msub><mi>/</mi><mi>w</mi></mrow></msqrt></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>k</mi><mi>Y</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msqrt><mrow><msub><mi>I</mi><mrow><mi>Y</mi><mi>Y</mi></mrow></msub><mi>/</mi><mi>w</mi></mrow></msqrt></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>k</mi><mi>Z</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msqrt><mrow><msub><mi>I</mi><mrow><mi>Z</mi><mi>Z</mi></mrow></msub><mi>/</mi><mi>w</mi></mrow></msqrt></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{align}
k_X&amp; = \sqrt{I_{XX}/ w} \\
k_Y&amp; = \sqrt{I_{YY}/ w} \\
k_Z&amp; = \sqrt{I_{ZZ}/ w} \\
\end{align}
</annotation></semantics></math> Let</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><menclose notation="box"><mtable><mtr><mtd columnalign="right" style="text-align: right"><mi>𝐤</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>k</mi><mi>X</mi></msub><mspace width="1.0em"></mspace><msub><mi>k</mi><mi>Y</mi></msub><mspace width="1.0em"></mspace><msub><mi>k</mi><mi>Z</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>T</mi></msup></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>𝐈</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>I</mi><mrow><mi>X</mi><mi>X</mi></mrow></msub><mspace width="1.0em"></mspace><msub><mi>I</mi><mrow><mi>Y</mi><mi>Y</mi></mrow></msub><mspace width="1.0em"></mspace><msub><mi>I</mi><mrow><mi>Z</mi><mi>Z</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>T</mi></msup></mtd></mtr></mtable></menclose><annotation encoding="application/x-tex">
\boxed{
\begin{align}
\boldsymbol{k} &amp; = (k_X\quad k_Y\quad k_Z)^T \\
\boldsymbol{I} &amp; = (I_{XX}\quad I_{YY}\quad I_{ZZ})^T
\end{align}
}
</annotation></semantics></math> Then</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><menclose notation="box"><mrow><mi>𝐤</mi><mo>=</mo><msqrt><mrow><mi>𝐈</mi><mi>/</mi><mi>w</mi></mrow></msqrt></mrow></menclose><annotation encoding="application/x-tex">
\boxed{
\boldsymbol{k} = \sqrt{ \boldsymbol{I} / w }
}
</annotation></semantics></math></p>
<p>The corresponding R code is</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>      <span class="va">rg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_mass_props.html">get_mass_props</a></span><span class="op">(</span><span class="va">d</span>, <span class="va">i</span><span class="op">)</span></span>
<span>      <span class="va">rg</span><span class="op">$</span><span class="va">radii_gyration</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">rg</span><span class="op">$</span><span class="va">inertia</span><span class="op">)</span> <span class="op">/</span> <span class="va">rg</span><span class="op">$</span><span class="va">mass</span><span class="op">)</span></span></code></pre></div>
<p>The SAWE reference gives equations for uncertainties of radii of
gyration in recursive form, but as these radii are simply functions of
moments of inertia and mass, we should be able to express their
uncertainties in terms of uncertainties of moments of inertia and mass
by applying standard uncertainty propagation theory <span class="citation">(Wikipedia contributors 2024)</span>.</p>
<p>Let</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><menclose notation="box"><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>σ</mi><mi>𝐤</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>σ</mi><msub><mi>k</mi><mi>X</mi></msub></msub><mspace width="1.0em"></mspace><msub><mi>σ</mi><msub><mi>k</mi><mi>Y</mi></msub></msub><mspace width="1.0em"></mspace><msub><mi>σ</mi><msub><mi>k</mi><mi>Z</mi></msub></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>T</mi></msup></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>σ</mi><mi>𝐈</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>σ</mi><msub><mi>I</mi><mrow><mi>X</mi><mi>X</mi></mrow></msub></msub><mspace width="1.0em"></mspace><msub><mi>σ</mi><msub><mi>I</mi><mrow><mi>Y</mi><mi>Y</mi></mrow></msub></msub><mspace width="1.0em"></mspace><msub><mi>σ</mi><msub><mi>I</mi><mrow><mi>Z</mi><mi>Z</mi></mrow></msub></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>T</mi></msup></mtd></mtr></mtable></menclose><annotation encoding="application/x-tex">
\boxed{
\begin{align}
\sigma_\boldsymbol{k} &amp; = (\sigma_{k_X} \quad \sigma_{k_Y} \quad \sigma_{k_Z})^T \\
\sigma_\boldsymbol{I} &amp; = (\sigma_{I_{XX}} \quad \sigma_{I_{YY}} \quad \sigma_{I_{ZZ}})^T
\end{align}
}
</annotation></semantics></math> Then</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msup><msub><mi>σ</mi><mi>𝐤</mi></msub><mn>2</mn></msup></mtd><mtd columnalign="left" style="text-align: left"><mo>≈</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mrow><mi>∂</mi><mi>𝐤</mi></mrow><mrow><mi>∂</mi><mi>𝐈</mi></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><msup><msub><mi>σ</mi><mi>𝐈</mi></msub><mn>2</mn></msup><mo>+</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mrow><mi>∂</mi><mi>𝐤</mi></mrow><mrow><mi>∂</mi><mi>w</mi></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><msup><msub><mi>σ</mi><mi>w</mi></msub><mn>2</mn></msup><mo>+</mo><mn>2</mn><mfrac><mrow><mi>∂</mi><mi>𝐤</mi></mrow><mrow><mi>∂</mi><mi>𝐈</mi></mrow></mfrac><mfrac><mrow><mi>∂</mi><mi>𝐤</mi></mrow><mrow><mi>∂</mi><mi>w</mi></mrow></mfrac><msub><mi>σ</mi><mrow><mi>𝐈</mi><mi>w</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>≈</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mn>1</mn><mrow><mn>2</mn><msqrt><mrow><mi>w</mi><mi>𝐈</mi></mrow></msqrt></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><msup><msub><mi>σ</mi><mi>𝐈</mi></msub><mn>2</mn></msup><mo>+</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mrow><mo>−</mo><msqrt><mi>𝐈</mi></msqrt></mrow><mrow><mn>2</mn><msup><mi>w</mi><mrow><mn>3</mn><mi>/</mi><mn>2</mn></mrow></msup></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><msup><msub><mi>σ</mi><mi>w</mi></msub><mn>2</mn></msup><mo>+</mo><mn>2</mn><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mn>1</mn><mrow><mn>2</mn><msqrt><mrow><mi>w</mi><mi>𝐈</mi></mrow></msqrt></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mrow><mo>−</mo><msqrt><mi>𝐈</mi></msqrt></mrow><mrow><mn>2</mn><msup><mi>w</mi><mrow><mn>3</mn><mi>/</mi><mn>2</mn></mrow></msup></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><mrow><mi>𝐈</mi><mi>w</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>≈</mo><mfrac><mn>1</mn><mrow><mn>4</mn><mi>w</mi><mi>𝐈</mi></mrow></mfrac><msup><msub><mi>σ</mi><mi>𝐈</mi></msub><mn>2</mn></msup><mo>+</mo><mfrac><mi>𝐈</mi><mrow><mn>4</mn><msup><mi>w</mi><mn>3</mn></msup></mrow></mfrac><msup><msub><mi>σ</mi><mi>w</mi></msub><mn>2</mn></msup><mo>−</mo><mfrac><mn>1</mn><mrow><mn>2</mn><msup><mi>w</mi><mn>2</mn></msup></mrow></mfrac><msub><mi>σ</mi><mrow><mi>𝐈</mi><mi>w</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{align}
{\sigma_\boldsymbol{k}}^2 &amp; \approx \left( \frac{\partial \boldsymbol{k}}{\partial \boldsymbol{I}} \right)^2 {\sigma_\boldsymbol{I}}^2 + \left( \frac{\partial \boldsymbol{k}}{\partial w} \right)^2 {\sigma_w}^2 + 2  \frac{\partial \boldsymbol{k}}{\partial \boldsymbol{I}} \frac{\partial \boldsymbol{k}}{\partial w} \sigma_{\boldsymbol{I}w} \\
  &amp; \approx \left( \frac{1}{2 \sqrt{w \boldsymbol{I}}} \right)^2 {\sigma_\boldsymbol{I}}^2 + \left(\frac{- \sqrt{\boldsymbol{I}}}{2 w^{3/2}}\right)^2 {\sigma_w}^2 + 2 \left( \frac{1}{2 \sqrt{w \boldsymbol{I}}} \right) \left(\frac{- \sqrt{\boldsymbol{I}}}{2 w^{3/2}}\right) \sigma_{\boldsymbol{I}w} \\
  &amp; \approx \frac{1}{4 w \boldsymbol{I}} {\sigma_\boldsymbol{I}}^2 + \frac{\boldsymbol{I}}{4 w^3} {\sigma_w}^2 - \frac{1}{2 w^2} \sigma_{\boldsymbol{I}w} \\
\end{align}
</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>σ</mi><mrow><mi>𝐈</mi><mi>w</mi></mrow></msub><annotation encoding="application/x-tex">\sigma_{\boldsymbol{I}w}</annotation></semantics></math>
is the covariance between
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐈</mi><annotation encoding="application/x-tex">\boldsymbol{I}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>w</mi><annotation encoding="application/x-tex">w</annotation></semantics></math>.</p>
<p>Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>W</mi><annotation encoding="application/x-tex">W</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>X</mi><annotation encoding="application/x-tex">X</annotation></semantics></math>
be random variables such that</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mi>W</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>w</mi><mi>i</mi></msub><mo>+</mo><msub><msub><mi>ϵ</mi><mi>w</mi></msub><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>X</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><mo stretchy="true" form="prefix">{</mo><msub><msub><mi>I</mi><mrow><mi>X</mi><mi>X</mi></mrow></msub><mi>i</mi></msub><mo>+</mo><msub><msub><mi>ϵ</mi><msub><mi>I</mi><mrow><mi>X</mi><mi>X</mi></mrow></msub></msub><mi>i</mi></msub><mo>+</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>w</mi><mi>i</mi></msub><mo>+</mo><msub><msub><mi>ϵ</mi><mi>w</mi></msub><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">[</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>+</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo stretchy="true" form="postfix">]</mo></mrow><mo stretchy="true" form="postfix">}</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{align}
W &amp; = \sum_{i=1}^{n} (w_i + {\epsilon_w}_i) \\
X &amp; = \sum_{i=1}^{n} \left\{ {I_{XX}}_i + {\epsilon_I_{XX}}_i
  + (w_i + {\epsilon_w}_i) \left[ \left( {y}_i - \bar{y} \right)^2 + \left( {z}_i - \bar{z} \right)^2 \right]
  \right\}
 \\
\end{align}
</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><msub><msub><mi>ϵ</mi><mi>w</mi></msub><mi>i</mi></msub><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">E[{\epsilon_w}_i] = 0</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><msub><msub><mi>ϵ</mi><msub><mi>I</mi><mrow><mi>X</mi><mi>X</mi></mrow></msub></msub><mi>i</mi></msub><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">E[{\epsilon_I_{XX}}_i] = 0</annotation></semantics></math>
for all
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><msub><msub><mi>ϵ</mi><mi>w</mi></msub><mi>i</mi></msub><msub><msub><mi>ϵ</mi><mi>w</mi></msub><mi>j</mi></msub><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">E[{\epsilon_w}_i {\epsilon_w}_j] = 0</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><msub><msub><mi>ϵ</mi><msub><mi>I</mi><mrow><mi>X</mi><mi>X</mi></mrow></msub></msub><mi>i</mi></msub><msub><msub><mi>ϵ</mi><msub><mi>I</mi><mrow><mi>X</mi><mi>X</mi></mrow></msub></msub><mi>j</mi></msub><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">E[{\epsilon_I_{XX}}_i {\epsilon_I_{XX}}_j] = 0</annotation></semantics></math>
for all
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>≠</mo><mi>j</mi></mrow><annotation encoding="application/x-tex">i \neq j</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><msub><msub><mi>ϵ</mi><mi>w</mi></msub><mi>i</mi></msub><msub><msub><mi>ϵ</mi><msub><mi>I</mi><mrow><mi>X</mi><mi>X</mi></mrow></msub></msub><mi>j</mi></msub><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">E[{\epsilon_w}_i {\epsilon_I_{XX}}_j] = 0</annotation></semantics></math>
for all
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>.
It is clear from the linearity of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>W</mi><annotation encoding="application/x-tex">W</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>X</mi><annotation encoding="application/x-tex">X</annotation></semantics></math>
in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mi>i</mi></msub><annotation encoding="application/x-tex">w_i</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>I</mi><msub><mrow><mi>X</mi><mi>X</mi></mrow><mi>i</mi></msub></msub><annotation encoding="application/x-tex">I_{XX}_i</annotation></semantics></math>
that</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>W</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>w</mi><mi>i</mi></msub><mo>+</mo><msub><msub><mi>ϵ</mi><mi>w</mi></msub><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><mi>w</mi><mo>+</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><msub><mi>ϵ</mi><mi>w</mi></msub><mi>i</mi></msub><mo>=</mo><mi>w</mi></mrow><annotation encoding="application/x-tex">
E[W] = E \left[\sum_{i=1}^{n} (w_i + {\epsilon_w}_i) \right] = w + \sum_{i=1}^{n} {\epsilon_w}_i = w
</annotation></semantics></math> and
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>X</mi><mo stretchy="true" form="postfix">]</mo></mrow></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><mo stretchy="true" form="prefix">{</mo><msub><msub><mi>I</mi><mrow><mi>X</mi><mi>X</mi></mrow></msub><mi>i</mi></msub><mo>+</mo><msub><msub><mi>ϵ</mi><msub><mi>I</mi><mrow><mi>X</mi><mi>X</mi></mrow></msub></msub><mi>i</mi></msub><mo>+</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>w</mi><mi>i</mi></msub><mo>+</mo><msub><msub><mi>ϵ</mi><mi>w</mi></msub><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">[</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>+</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo stretchy="true" form="postfix">]</mo></mrow><mo stretchy="true" form="postfix">}</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msub><mi>I</mi><mrow><mi>X</mi><mi>X</mi></mrow></msub><mo>+</mo><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><mo stretchy="true" form="prefix">{</mo><msub><msub><mi>ϵ</mi><msub><mi>I</mi><mrow><mi>X</mi><mi>X</mi></mrow></msub></msub><mi>i</mi></msub><mo>+</mo><msub><msub><mi>ϵ</mi><mi>w</mi></msub><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">[</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>+</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo stretchy="true" form="postfix">]</mo></mrow><mo stretchy="true" form="postfix">}</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msub><mi>I</mi><mrow><mi>X</mi><mi>X</mi></mrow></msub></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{align}
E[X] &amp; = E \left[ \sum_{i=1}^{n} \left\{ {I_{XX}}_i + {\epsilon_{I_{XX}}}_i
  + (w_i + {\epsilon_w}_i) \left[ \left( {y}_i - \bar{y} \right)^2 + \left( {z}_i - \bar{z} \right)^2 \right] \right\} \right] \\
&amp; = I_{XX}+  E \left[ \sum_{i=1}^{n} \left\{ {\epsilon_{I_{XX}}}_i
  + {\epsilon_w}_i \left[ \left( {y}_i - \bar{y} \right)^2 + \left( {z}_i - \bar{z} \right)^2 \right] \right\} \right] \\
&amp; = I_{XX}
\end{align}
</annotation></semantics></math> Therefore,</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>σ</mi><mrow><msub><mi>I</mi><mrow><mi>X</mi><mi>X</mi></mrow></msub><mi>w</mi></mrow></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>W</mi><mo>−</mo><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>W</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>X</mi><mo>−</mo><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>X</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><msub><mi>ϵ</mi><mi>w</mi></msub><mi>i</mi></msub><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><mo stretchy="true" form="prefix">{</mo><msub><msub><mi>ϵ</mi><msub><mi>I</mi><mrow><mi>X</mi><mi>X</mi></mrow></msub></msub><mi>j</mi></msub><mo>+</mo><msub><msub><mi>ϵ</mi><mi>w</mi></msub><mi>j</mi></msub><mrow><mo stretchy="true" form="prefix">[</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>j</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>+</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>j</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo stretchy="true" form="postfix">]</mo></mrow><mo stretchy="true" form="postfix">}</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><msub><msub><mi>ϵ</mi><mi>w</mi></msub><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">{</mo><msub><msub><mi>ϵ</mi><msub><mi>I</mi><mrow><mi>X</mi><mi>X</mi></mrow></msub></msub><mi>j</mi></msub><mo>+</mo><msub><msub><mi>ϵ</mi><mi>w</mi></msub><mi>j</mi></msub><mrow><mo stretchy="true" form="prefix">[</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>j</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>+</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>j</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo stretchy="true" form="postfix">]</mo></mrow><mo stretchy="true" form="postfix">}</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><msubsup><msub><mi>ϵ</mi><mi>w</mi></msub><mi>i</mi><mn>2</mn></msubsup><mo stretchy="true" form="postfix">]</mo></mrow><mrow><mo stretchy="true" form="prefix">[</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>+</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo stretchy="true" form="postfix">]</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msubsup><msub><mi>σ</mi><mi>w</mi></msub><mi>i</mi><mn>2</mn></msubsup><mrow><mo stretchy="true" form="prefix">[</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>+</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo stretchy="true" form="postfix">]</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{align}
\sigma_{I_{XX}w} &amp; = E \left[ \left( W - E[W] \right) \left( X - E[X] \right)\right] \\
                &amp; = E \left[ \sum_{i=1}^{n} {\epsilon_w}_i
                     \sum_{j=1}^{n} \left\{ {\epsilon_{I_{XX}}}_j
                    + {\epsilon_w}_j \left[ \left( {y}_j - \bar{y} \right)^2 + \left( {z}_j - \bar{z} \right)^2 \right] \right\}  \right] \\
                &amp; = \sum_{i=1}^{n} 
                    \sum_{j=1}^{n} E \left[ {\epsilon_w}_i \left\{ {\epsilon_{I_{XX}}}_j
                    + {\epsilon_w}_j \left[ \left( {y}_j - \bar{y} \right)^2 + \left( {z}_j - \bar{z} \right)^2 \right] \right\} \right] \\
                &amp; = \sum_{i=1}^{n} E \left[ {\epsilon_w}^2_i \right] \left[ \left( {y}_i - \bar{y} \right)^2 + \left( {z}_i - \bar{z} \right)^2  \right] \\
                &amp; = \sum_{i=1}^{n} {\sigma_w}^2_i \left[ \left( {y}_i - \bar{y} \right)^2 + \left( {z}_i - \bar{z} \right)^2  \right] \\
\end{align}
</annotation></semantics></math></p>
<p>Exploiting symmetry, let</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><menclose notation="box"><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>𝐝</mi><mi>i</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="1.0em"></mspace><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="1.0em"></mspace><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mi>T</mi></msup></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>𝐬</mi><mi>i</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>𝐝</mi><mi>i</mi><mi>T</mi></msubsup><msub><mi>𝐝</mi><mi>i</mi></msub><mspace width="1.0em"></mspace><msubsup><mi>𝐝</mi><mi>i</mi><mi>T</mi></msubsup><msub><mi>𝐝</mi><mi>i</mi></msub><mspace width="1.0em"></mspace><msubsup><mi>𝐝</mi><mi>i</mi><mi>T</mi></msubsup><msub><mi>𝐝</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>T</mi></msup></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd></mtr></mtable></menclose><annotation encoding="application/x-tex">
\boxed{
\begin{align}
\boldsymbol{d}_i &amp; = (({x}_i - \bar{x}) \quad ({y}_i - \bar{y}) \quad ({z}_i - \bar{z}))^T \\
\boldsymbol{s}_i &amp; = (\boldsymbol{d}_i^T\boldsymbol{d}_i \quad \boldsymbol{d}_i^T\boldsymbol{d}_i \quad \boldsymbol{d}_i^T\boldsymbol{d}_i)^T \\
\end{align}
}
</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msup><msub><mi>σ</mi><mi>𝐤</mi></msub><mn>2</mn></msup></mtd><mtd columnalign="left" style="text-align: left"><mo>≈</mo><mfrac><mn>1</mn><mrow><mn>4</mn><mi>w</mi><mi>𝐈</mi></mrow></mfrac><msup><msub><mi>σ</mi><mi>𝐈</mi></msub><mn>2</mn></msup><mo>+</mo><mfrac><mi>𝐈</mi><mrow><mn>4</mn><msup><mi>w</mi><mn>3</mn></msup></mrow></mfrac><msup><msub><mi>σ</mi><mi>w</mi></msub><mn>2</mn></msup><mo>−</mo><mfrac><mn>1</mn><mrow><mn>2</mn><msup><mi>w</mi><mn>2</mn></msup></mrow></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msubsup><msub><mi>σ</mi><mi>w</mi></msub><mi>i</mi><mn>2</mn></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>𝐬</mi><mi>i</mi></msub><mo>−</mo><msubsup><mi>𝐝</mi><mi>i</mi><mn>2</mn></msubsup><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{align}
{\sigma_\boldsymbol{k}}^2 &amp; \approx \frac{1}{4 w \boldsymbol{I}} {\sigma_\boldsymbol{I}}^2 + \frac{\boldsymbol{I}}{4 w^3} {\sigma_w}^2 -
  \frac{1}{2 w^2} \sum_{i=1}^{n} {\sigma_w}^2_i (\boldsymbol{s}_i - \boldsymbol{d}_i^2 ) \\
\end{align}
</annotation></semantics></math> Therefore, we define</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><menclose notation="box"><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>σ</mi><mi>𝐤</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><msqrt><mrow><mfrac><mn>1</mn><mrow><mi>w</mi><mi>𝐈</mi></mrow></mfrac><msup><msub><mi>σ</mi><mi>𝐈</mi></msub><mn>2</mn></msup><mo>+</mo><mfrac><mi>𝐈</mi><msup><mi>w</mi><mn>3</mn></msup></mfrac><msup><msub><mi>σ</mi><mi>w</mi></msub><mn>2</mn></msup><mo>−</mo><mfrac><mn>2</mn><msup><mi>w</mi><mn>2</mn></msup></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msubsup><msub><mi>σ</mi><mi>w</mi></msub><mi>i</mi><mn>2</mn></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>𝐬</mi><mi>i</mi></msub><mo>−</mo><msubsup><mi>𝐝</mi><mi>i</mi><mn>2</mn></msubsup><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msqrt></mtd></mtr></mtable></menclose><annotation encoding="application/x-tex">
\boxed{
\begin{align}
{\sigma_\boldsymbol{k}} &amp; = \frac{1}{2} \sqrt{ \frac{1}{w \boldsymbol{I}} {\sigma_\boldsymbol{I}}^2 + \frac{\boldsymbol{I}}{w^3} {\sigma_w}^2
-  \frac{2}{w^2} \sum_{i=1}^{n} {\sigma_w}^2_i (\boldsymbol{s}_i - \boldsymbol{d}_i^2 )
}
\end{align}
}
</annotation></semantics></math></p>
<p>The corresponding R code is</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>      <span class="va">amp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_mass_props_and_unc.html">get_mass_props_and_unc</a></span><span class="op">(</span><span class="va">ds</span>, <span class="va">target</span><span class="op">)</span></span>
<span>      <span class="va">I</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">amp</span><span class="op">$</span><span class="va">inertia</span><span class="op">)</span></span>
<span>      <span class="va">sigma_I</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">amp</span><span class="op">$</span><span class="va">sigma_inertia</span><span class="op">)</span></span>
<span>      <span class="va">amp</span><span class="op">$</span><span class="va">sigma_radii_gyration</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span></span>
<span>        <span class="va">sigma_I</span><span class="op">^</span><span class="fl">2</span> <span class="op">/</span> <span class="op">(</span><span class="va">amp</span><span class="op">$</span><span class="va">mass</span> <span class="op">*</span> <span class="va">I</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="va">I</span> <span class="op">*</span> <span class="va">amp</span><span class="op">$</span><span class="va">sigma_mass</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">/</span> <span class="va">amp</span><span class="op">$</span><span class="va">mass</span><span class="op">^</span><span class="fl">3</span> <span class="op">-</span></span>
<span>          <span class="fl">2</span> <span class="op">/</span> <span class="va">amp</span><span class="op">$</span><span class="va">mass</span><span class="op">^</span><span class="fl">2</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Reduce</a></span><span class="op">(</span></span>
<span>            <span class="va">`+`</span>,</span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Map</a></span><span class="op">(</span></span>
<span>              f <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">s</span><span class="op">)</span> <span class="op">{</span></span>
<span>                <span class="va">mp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_mass_props_and_unc.html">get_mass_props_and_unc</a></span><span class="op">(</span><span class="va">ds</span>, <span class="va">s</span><span class="op">)</span></span>
<span>                <span class="va">d2</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">mp</span><span class="op">$</span><span class="va">center_mass</span> <span class="op">-</span> <span class="va">amp</span><span class="op">$</span><span class="va">center_mass</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span></span>
<span>                <span class="va">mp</span><span class="op">$</span><span class="va">sigma_mass</span><span class="op">^</span><span class="fl">2</span> <span class="op">*</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">d2</span><span class="op">)</span> <span class="op">-</span> <span class="va">d2</span><span class="op">)</span></span>
<span>              <span class="op">}</span>,</span>
<span>              <span class="va">sources</span></span>
<span>            <span class="op">)</span>,</span>
<span>            init <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span>
<span>          <span class="op">)</span></span>
<span>      <span class="op">)</span> <span class="op">/</span> <span class="fl">2</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="testing-and-validation">Testing and Validation<a class="anchor" aria-label="anchor" href="#testing-and-validation"></a>
</h2>
<div class="section level3">
<h3 id="comparison-with-independently-calculated-results">Comparison With Independently-Calculated Results<a class="anchor" aria-label="anchor" href="#comparison-with-independently-calculated-results"></a>
</h3>
<p>In this section we will calculate the results for the SAWE example
step by step and compare them with the package results. The inputs
are:</p>
<pre><code><span><span class="co">#&gt;         id  mass    Cx    Cy    Cz     Ixx     Iyy      Izz    Ixy      Ixz</span></span>
<span><span class="co">#&gt; 1   Widget 57.83 121.2  0.04 -0.16 7258.90 8607.02 10453.40 834.44 -1198.38</span></span>
<span><span class="co">#&gt; 2 2nd Part 16.80  70.9 -0.95  0.46   65.07 1124.65  1078.82  76.01   202.83</span></span>
<span><span class="co">#&gt;        Iyz sigma_mass sigma_Cx sigma_Cy sigma_Cz sigma_Ixx sigma_Iyy sigma_Izz</span></span>
<span><span class="co">#&gt; 1 -1066.58     1.2416   0.2764   0.2085   0.0669  386.9233  171.4792  414.5547</span></span>
<span><span class="co">#&gt; 2    13.62     1.7308   0.6234   0.5173   0.1405   12.4687  109.1324  108.5481</span></span>
<span><span class="co">#&gt;   sigma_Ixy sigma_Ixz sigma_Iyz Ipoint POIconv</span></span>
<span><span class="co">#&gt; 1 1440.5402  344.6237  124.6860  FALSE       +</span></span>
<span><span class="co">#&gt; 2   55.8879  212.1241   11.5408  FALSE       +</span></span></code></pre>
<p>Our computed result is</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">t</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rollup_radii_of_gyration_unc.html">rollup_radii_of_gyration_unc</a></span><span class="op">(</span><span class="va">sawe_tree</span>,</span>
<span>  <span class="fu"><a href="../reference/add_radii_of_gyration.html">add_radii_of_gyration</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/rollup_mass_props_and_unc.html">rollup_mass_props_and_unc</a></span><span class="op">(</span><span class="va">sawe_tree</span>, <span class="va">sawe_table</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">sawe_result</span> <span class="op">&lt;-</span> <span class="va">t</span><span class="op">[</span><span class="va">t</span><span class="op">$</span><span class="va">id</span> <span class="op">==</span> <span class="st">"Combined"</span>, <span class="op">]</span></span>
<span><span class="va">sawe_result</span></span>
<span><span class="co">#&gt;         id  mass       Cx         Cy          Cz      Ixx      Iyy      Izz</span></span>
<span><span class="co">#&gt; 3 Combined 74.63 109.8769 -0.1828594 -0.02043146 7341.733 42673.75 44482.05</span></span>
<span><span class="co">#&gt;        Ixy       Ixz       Iyz sigma_mass sigma_Cx  sigma_Cy   sigma_Cz</span></span>
<span><span class="co">#&gt; 3 1558.714 -1401.534 -1060.951    2.13008  0.95821 0.1999847 0.06178402</span></span>
<span><span class="co">#&gt;   sigma_Ixx sigma_Iyy sigma_Izz sigma_Ixy sigma_Ixz sigma_Iyz Ipoint POIconv</span></span>
<span><span class="co">#&gt; 3  387.4017  2789.313  2815.326  1488.095  418.6048  125.3175  FALSE       +</span></span>
<span><span class="co">#&gt;         kx       ky       kz  sigma_kx  sigma_ky  sigma_kz</span></span>
<span><span class="co">#&gt; 3 9.918422 23.91243 24.41382 0.2971248 0.5484836 0.5402033</span></span></code></pre></div>
<div class="section level4">
<h4 id="mass-1">Mass<a class="anchor" aria-label="anchor" href="#mass-1"></a>
</h4>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mass</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">sawe_input</span><span class="op">$</span><span class="va">mass</span><span class="op">)</span></span></code></pre></div>
<p>The independently-calculated mass is</p>
<pre><code><span><span class="co">#&gt; [1] 74.63</span></span></code></pre>
<p>This agrees with the computed result.</p>
</div>
<div class="section level4">
<h4 id="center-of-mass-1">Center of Mass<a class="anchor" aria-label="anchor" href="#center-of-mass-1"></a>
</h4>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">C</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">sawe_input</span><span class="op">$</span><span class="va">mass</span> <span class="op">/</span> <span class="va">mass</span> <span class="op">*</span> <span class="va">sawe_input</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Cx"</span>, <span class="st">"Cy"</span>, <span class="st">"Cz"</span><span class="op">)</span><span class="op">]</span>, <span class="fl">2</span>, <span class="va">sum</span><span class="op">)</span></span></code></pre></div>
<p>The independently-calculated center of mass is</p>
<pre><code><span><span class="co">#&gt;           Cx           Cy           Cz </span></span>
<span><span class="co">#&gt; 109.87693957  -0.18285944  -0.02043146</span></span></code></pre>
<p>This agrees with the computed result.</p>
</div>
<div class="section level4">
<h4 id="moments-of-inertia-1">Moments of Inertia<a class="anchor" aria-label="anchor" href="#moments-of-inertia-1"></a>
</h4>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">moi</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">I</span>, <span class="va">v1</span>, <span class="va">v2</span>, <span class="va">m</span>, <span class="va">c1</span>, <span class="va">c2</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">I</span> <span class="op">+</span> <span class="va">m</span> <span class="op">*</span> <span class="op">(</span><span class="op">(</span><span class="va">v1</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="va">v2</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">-</span> <span class="op">(</span><span class="va">c1</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="va">c2</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">MOI</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  Ixx <span class="op">=</span> <span class="fu">moi</span><span class="op">(</span><span class="va">sawe_input</span><span class="op">$</span><span class="va">Ixx</span>, <span class="va">sawe_input</span><span class="op">$</span><span class="va">Cy</span>, <span class="va">sawe_input</span><span class="op">$</span><span class="va">Cz</span>, <span class="va">sawe_input</span><span class="op">$</span><span class="va">mass</span>, <span class="va">C</span><span class="op">[</span><span class="st">"Cy"</span><span class="op">]</span>, <span class="va">C</span><span class="op">[</span><span class="st">"Cz"</span><span class="op">]</span><span class="op">)</span>,</span>
<span>  Iyy <span class="op">=</span> <span class="fu">moi</span><span class="op">(</span><span class="va">sawe_input</span><span class="op">$</span><span class="va">Iyy</span>, <span class="va">sawe_input</span><span class="op">$</span><span class="va">Cx</span>, <span class="va">sawe_input</span><span class="op">$</span><span class="va">Cz</span>, <span class="va">sawe_input</span><span class="op">$</span><span class="va">mass</span>, <span class="va">C</span><span class="op">[</span><span class="st">"Cx"</span><span class="op">]</span>, <span class="va">C</span><span class="op">[</span><span class="st">"Cz"</span><span class="op">]</span><span class="op">)</span>,</span>
<span>  Izz <span class="op">=</span> <span class="fu">moi</span><span class="op">(</span><span class="va">sawe_input</span><span class="op">$</span><span class="va">Izz</span>, <span class="va">sawe_input</span><span class="op">$</span><span class="va">Cx</span>, <span class="va">sawe_input</span><span class="op">$</span><span class="va">Cy</span>, <span class="va">sawe_input</span><span class="op">$</span><span class="va">mass</span>, <span class="va">C</span><span class="op">[</span><span class="st">"Cx"</span><span class="op">]</span>, <span class="va">C</span><span class="op">[</span><span class="st">"Cy"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The independently-calculated moments of inertia are</p>
<pre><code><span><span class="co">#&gt;       Ixx       Iyy       Izz </span></span>
<span><span class="co">#&gt;  7341.733 42673.747 44482.052</span></span></code></pre>
<p>This agrees with the computed result.</p>
</div>
<div class="section level4">
<h4 id="products-of-inertia-1">Products of Inertia<a class="anchor" aria-label="anchor" href="#products-of-inertia-1"></a>
</h4>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">poi</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">I</span>, <span class="va">v1</span>, <span class="va">v2</span>, <span class="va">m</span>, <span class="va">c1</span>, <span class="va">c2</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">I</span> <span class="op">+</span> <span class="va">m</span> <span class="op">*</span> <span class="op">(</span><span class="va">v1</span> <span class="op">*</span> <span class="va">v2</span> <span class="op">-</span> <span class="va">c1</span> <span class="op">*</span> <span class="va">c2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">POI</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  Ixy <span class="op">=</span> <span class="fu">poi</span><span class="op">(</span><span class="va">sawe_input</span><span class="op">$</span><span class="va">Ixy</span>, <span class="va">sawe_input</span><span class="op">$</span><span class="va">Cx</span>, <span class="va">sawe_input</span><span class="op">$</span><span class="va">Cy</span>, <span class="va">sawe_input</span><span class="op">$</span><span class="va">mass</span>, <span class="va">C</span><span class="op">[</span><span class="st">"Cx"</span><span class="op">]</span>, <span class="va">C</span><span class="op">[</span><span class="st">"Cy"</span><span class="op">]</span><span class="op">)</span>,</span>
<span>  Ixz <span class="op">=</span> <span class="fu">poi</span><span class="op">(</span><span class="va">sawe_input</span><span class="op">$</span><span class="va">Ixz</span>, <span class="va">sawe_input</span><span class="op">$</span><span class="va">Cx</span>, <span class="va">sawe_input</span><span class="op">$</span><span class="va">Cz</span>, <span class="va">sawe_input</span><span class="op">$</span><span class="va">mass</span>, <span class="va">C</span><span class="op">[</span><span class="st">"Cx"</span><span class="op">]</span>, <span class="va">C</span><span class="op">[</span><span class="st">"Cz"</span><span class="op">]</span><span class="op">)</span>,</span>
<span>  Iyz <span class="op">=</span> <span class="fu">poi</span><span class="op">(</span><span class="va">sawe_input</span><span class="op">$</span><span class="va">Iyz</span>, <span class="va">sawe_input</span><span class="op">$</span><span class="va">Cy</span>, <span class="va">sawe_input</span><span class="op">$</span><span class="va">Cz</span>, <span class="va">sawe_input</span><span class="op">$</span><span class="va">mass</span>, <span class="va">C</span><span class="op">[</span><span class="st">"Cy"</span><span class="op">]</span>, <span class="va">C</span><span class="op">[</span><span class="st">"Cz"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The independently-calculated products of inertia are</p>
<pre><code><span><span class="co">#&gt;       Ixy       Ixz       Iyz </span></span>
<span><span class="co">#&gt;  1558.714 -1401.534 -1060.951</span></span></code></pre>
<p>This agrees with the computed result.</p>
</div>
<div class="section level4">
<h4 id="radii-of-gyration">Radii of Gyration<a class="anchor" aria-label="anchor" href="#radii-of-gyration"></a>
</h4>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rog</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">I</span>, <span class="va">m</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">I</span> <span class="op">/</span> <span class="va">m</span><span class="op">)</span></span>
<span><span class="va">ROG</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  kx <span class="op">=</span> <span class="fu">rog</span><span class="op">(</span><span class="va">sawe_result</span><span class="op">$</span><span class="va">Ixx</span>, <span class="va">sawe_result</span><span class="op">$</span><span class="va">mass</span><span class="op">)</span>,</span>
<span>  ky <span class="op">=</span> <span class="fu">rog</span><span class="op">(</span><span class="va">sawe_result</span><span class="op">$</span><span class="va">Iyy</span>, <span class="va">sawe_result</span><span class="op">$</span><span class="va">mass</span><span class="op">)</span>,</span>
<span>  kz <span class="op">=</span> <span class="fu">rog</span><span class="op">(</span><span class="va">sawe_result</span><span class="op">$</span><span class="va">Izz</span>, <span class="va">sawe_result</span><span class="op">$</span><span class="va">mass</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The independently-calculated radii of gyration are</p>
<pre><code><span><span class="co">#&gt;        kx        ky        kz </span></span>
<span><span class="co">#&gt;  9.918422 23.912428 24.413817</span></span></code></pre>
<p>This agrees with the computed result.</p>
</div>
<div class="section level4">
<h4 id="mass-uncertainty-1">Mass Uncertainty<a class="anchor" aria-label="anchor" href="#mass-uncertainty-1"></a>
</h4>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sigma_mass</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">sawe_input</span><span class="op">$</span><span class="va">sigma_mass</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The independently-calculated mass uncertainty is</p>
<pre><code><span><span class="co">#&gt; [1] 2.13008</span></span></code></pre>
<p>This agrees with the computed result.</p>
</div>
<div class="section level4">
<h4 id="center-of-mass-uncertainty-1">Center of Mass Uncertainty<a class="anchor" aria-label="anchor" href="#center-of-mass-uncertainty-1"></a>
</h4>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sigma_cm</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">m</span>, <span class="va">sigma_v</span>, <span class="va">sigma_m</span>, <span class="va">v</span>, <span class="va">c</span>, <span class="va">mass</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">m</span> <span class="op">*</span> <span class="va">sigma_v</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="op">(</span><span class="va">sigma_m</span> <span class="op">*</span> <span class="op">(</span><span class="va">v</span> <span class="op">-</span> <span class="va">c</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="va">mass</span></span>
<span><span class="op">}</span></span>
<span><span class="va">sigma_C</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  sigma_Cx <span class="op">=</span> <span class="fu">sigma_cm</span><span class="op">(</span><span class="va">sawe_input</span><span class="op">$</span><span class="va">mass</span>, <span class="va">sawe_input</span><span class="op">$</span><span class="va">sigma_Cx</span>, <span class="va">sawe_input</span><span class="op">$</span><span class="va">sigma_mass</span>, <span class="va">sawe_input</span><span class="op">$</span><span class="va">Cx</span>, <span class="va">C</span><span class="op">[</span><span class="st">"Cx"</span><span class="op">]</span>, <span class="va">mass</span><span class="op">)</span>,</span>
<span>  sigma_Cy <span class="op">=</span> <span class="fu">sigma_cm</span><span class="op">(</span><span class="va">sawe_input</span><span class="op">$</span><span class="va">mass</span>, <span class="va">sawe_input</span><span class="op">$</span><span class="va">sigma_Cy</span>, <span class="va">sawe_input</span><span class="op">$</span><span class="va">sigma_mass</span>, <span class="va">sawe_input</span><span class="op">$</span><span class="va">Cy</span>, <span class="va">C</span><span class="op">[</span><span class="st">"Cy"</span><span class="op">]</span>, <span class="va">mass</span><span class="op">)</span>,</span>
<span>  sigma_Cz <span class="op">=</span> <span class="fu">sigma_cm</span><span class="op">(</span><span class="va">sawe_input</span><span class="op">$</span><span class="va">mass</span>, <span class="va">sawe_input</span><span class="op">$</span><span class="va">sigma_Cz</span>, <span class="va">sawe_input</span><span class="op">$</span><span class="va">sigma_mass</span>, <span class="va">sawe_input</span><span class="op">$</span><span class="va">Cz</span>, <span class="va">C</span><span class="op">[</span><span class="st">"Cz"</span><span class="op">]</span>, <span class="va">mass</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The independently-calculated center of mass uncertainties are</p>
<pre><code><span><span class="co">#&gt;   sigma_Cx   sigma_Cy   sigma_Cz </span></span>
<span><span class="co">#&gt; 0.95821004 0.19998470 0.06178402</span></span></code></pre>
<p>This agrees with the computed result.</p>
</div>
<div class="section level4">
<h4 id="moments-of-inertia-uncertainties-1">Moments of Inertia Uncertainties<a class="anchor" aria-label="anchor" href="#moments-of-inertia-uncertainties-1"></a>
</h4>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sigma_moi</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">sigma_I</span>, <span class="va">mass</span>, <span class="va">sigma_mass</span>, <span class="va">v1</span>, <span class="va">v2</span>, <span class="va">c1</span>, <span class="va">c2</span>, <span class="va">sigma_v1</span>, <span class="va">sigma_v2</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span></span>
<span>    <span class="va">sigma_I</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span></span>
<span>    <span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">mass</span> <span class="op">*</span> <span class="op">(</span><span class="va">v1</span> <span class="op">-</span> <span class="va">c1</span><span class="op">)</span> <span class="op">*</span> <span class="va">sigma_v1</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span></span>
<span>    <span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">mass</span> <span class="op">*</span> <span class="op">(</span><span class="va">v2</span> <span class="op">-</span> <span class="va">c2</span><span class="op">)</span> <span class="op">*</span> <span class="va">sigma_v2</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span></span>
<span>    <span class="op">(</span><span class="op">(</span><span class="op">(</span><span class="va">v1</span> <span class="op">-</span> <span class="va">c1</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="op">(</span><span class="va">v2</span> <span class="op">-</span> <span class="va">c2</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">*</span> <span class="va">sigma_mass</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">sigma_MOI</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  sigma_Ixx <span class="op">=</span> <span class="fu">sigma_moi</span><span class="op">(</span><span class="va">sawe_input</span><span class="op">$</span><span class="va">sigma_Ixx</span>, <span class="va">sawe_input</span><span class="op">$</span><span class="va">mass</span>, <span class="va">sawe_input</span><span class="op">$</span><span class="va">sigma_mass</span>, <span class="va">sawe_input</span><span class="op">$</span><span class="va">Cy</span>,</span>
<span>                                  <span class="va">sawe_input</span><span class="op">$</span><span class="va">Cz</span>, <span class="va">C</span><span class="op">[</span><span class="st">"Cy"</span><span class="op">]</span>, <span class="va">C</span><span class="op">[</span><span class="st">"Cz"</span><span class="op">]</span>, <span class="va">sawe_input</span><span class="op">$</span><span class="va">sigma_Cy</span>, <span class="va">sawe_input</span><span class="op">$</span><span class="va">sigma_Cz</span><span class="op">)</span>,</span>
<span>  sigma_Iyy <span class="op">=</span> <span class="fu">sigma_moi</span><span class="op">(</span><span class="va">sawe_input</span><span class="op">$</span><span class="va">sigma_Iyy</span>, <span class="va">sawe_input</span><span class="op">$</span><span class="va">mass</span>, <span class="va">sawe_input</span><span class="op">$</span><span class="va">sigma_mass</span>, <span class="va">sawe_input</span><span class="op">$</span><span class="va">Cx</span>,</span>
<span>                                  <span class="va">sawe_input</span><span class="op">$</span><span class="va">Cz</span>, <span class="va">C</span><span class="op">[</span><span class="st">"Cx"</span><span class="op">]</span>, <span class="va">C</span><span class="op">[</span><span class="st">"Cz"</span><span class="op">]</span>, <span class="va">sawe_input</span><span class="op">$</span><span class="va">sigma_Cx</span>, <span class="va">sawe_input</span><span class="op">$</span><span class="va">sigma_Cz</span><span class="op">)</span>,</span>
<span>  sigma_Izz <span class="op">=</span> <span class="fu">sigma_moi</span><span class="op">(</span><span class="va">sawe_input</span><span class="op">$</span><span class="va">sigma_Izz</span>, <span class="va">sawe_input</span><span class="op">$</span><span class="va">mass</span>, <span class="va">sawe_input</span><span class="op">$</span><span class="va">sigma_mass</span>, <span class="va">sawe_input</span><span class="op">$</span><span class="va">Cx</span>,</span>
<span>                                  <span class="va">sawe_input</span><span class="op">$</span><span class="va">Cy</span>, <span class="va">C</span><span class="op">[</span><span class="st">"Cx"</span><span class="op">]</span>, <span class="va">C</span><span class="op">[</span><span class="st">"Cy"</span><span class="op">]</span>, <span class="va">sawe_input</span><span class="op">$</span><span class="va">sigma_Cx</span>, <span class="va">sawe_input</span><span class="op">$</span><span class="va">sigma_Cy</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The independently-calculated moments of inertia uncertainties are</p>
<pre><code><span><span class="co">#&gt; sigma_Ixx sigma_Iyy sigma_Izz </span></span>
<span><span class="co">#&gt;  387.4017 2789.3133 2815.3260</span></span></code></pre>
<p>This agrees with the computed result.</p>
</div>
<div class="section level4">
<h4 id="products-of-inertia-uncertainties-1">Products of Inertia Uncertainties<a class="anchor" aria-label="anchor" href="#products-of-inertia-uncertainties-1"></a>
</h4>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sigma_poi</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">sigma_I</span>, <span class="va">mass</span>, <span class="va">sigma_mass</span>, <span class="va">v1</span>, <span class="va">v2</span>, <span class="va">c1</span>, <span class="va">c2</span>, <span class="va">sigma_v1</span>, <span class="va">sigma_v2</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span></span>
<span>    <span class="va">sigma_I</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span></span>
<span>    <span class="op">(</span><span class="op">(</span><span class="va">v1</span> <span class="op">-</span> <span class="va">c1</span><span class="op">)</span> <span class="op">*</span> <span class="va">mass</span> <span class="op">*</span> <span class="va">sigma_v2</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span></span>
<span>    <span class="op">(</span><span class="op">(</span><span class="va">v1</span> <span class="op">-</span> <span class="va">c1</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="va">v2</span> <span class="op">-</span> <span class="va">c2</span><span class="op">)</span> <span class="op">*</span> <span class="va">sigma_mass</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span></span>
<span>    <span class="op">(</span><span class="op">(</span><span class="va">v2</span> <span class="op">-</span> <span class="va">c2</span><span class="op">)</span> <span class="op">*</span> <span class="va">mass</span> <span class="op">*</span> <span class="va">sigma_v1</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">sigma_POI</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  sigma_Ixy <span class="op">=</span> <span class="fu">sigma_poi</span><span class="op">(</span><span class="va">sawe_input</span><span class="op">$</span><span class="va">sigma_Ixy</span>, <span class="va">sawe_input</span><span class="op">$</span><span class="va">mass</span>, <span class="va">sawe_input</span><span class="op">$</span><span class="va">sigma_mass</span>, <span class="va">sawe_input</span><span class="op">$</span><span class="va">Cx</span>,</span>
<span>                                  <span class="va">sawe_input</span><span class="op">$</span><span class="va">Cy</span>, <span class="va">C</span><span class="op">[</span><span class="st">"Cx"</span><span class="op">]</span>, <span class="va">C</span><span class="op">[</span><span class="st">"Cy"</span><span class="op">]</span>, <span class="va">sawe_input</span><span class="op">$</span><span class="va">sigma_Cx</span>, <span class="va">sawe_input</span><span class="op">$</span><span class="va">sigma_Cy</span><span class="op">)</span>,</span>
<span>  sigma_Ixz <span class="op">=</span> <span class="fu">sigma_poi</span><span class="op">(</span><span class="va">sawe_input</span><span class="op">$</span><span class="va">sigma_Ixz</span>, <span class="va">sawe_input</span><span class="op">$</span><span class="va">mass</span>, <span class="va">sawe_input</span><span class="op">$</span><span class="va">sigma_mass</span>, <span class="va">sawe_input</span><span class="op">$</span><span class="va">Cx</span>,</span>
<span>                                  <span class="va">sawe_input</span><span class="op">$</span><span class="va">Cz</span>, <span class="va">C</span><span class="op">[</span><span class="st">"Cx"</span><span class="op">]</span>, <span class="va">C</span><span class="op">[</span><span class="st">"Cz"</span><span class="op">]</span>, <span class="va">sawe_input</span><span class="op">$</span><span class="va">sigma_Cx</span>, <span class="va">sawe_input</span><span class="op">$</span><span class="va">sigma_Cz</span><span class="op">)</span>,</span>
<span>  sigma_Iyz <span class="op">=</span> <span class="fu">sigma_poi</span><span class="op">(</span><span class="va">sawe_input</span><span class="op">$</span><span class="va">sigma_Iyz</span>, <span class="va">sawe_input</span><span class="op">$</span><span class="va">mass</span>, <span class="va">sawe_input</span><span class="op">$</span><span class="va">sigma_mass</span>, <span class="va">sawe_input</span><span class="op">$</span><span class="va">Cy</span>,</span>
<span>                                  <span class="va">sawe_input</span><span class="op">$</span><span class="va">Cz</span>, <span class="va">C</span><span class="op">[</span><span class="st">"Cy"</span><span class="op">]</span>, <span class="va">C</span><span class="op">[</span><span class="st">"Cz"</span><span class="op">]</span>, <span class="va">sawe_input</span><span class="op">$</span><span class="va">sigma_Cy</span>, <span class="va">sawe_input</span><span class="op">$</span><span class="va">sigma_Cz</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The independently-calculated products of inertia uncertainties
are</p>
<pre><code><span><span class="co">#&gt; sigma_Ixy sigma_Ixz sigma_Iyz </span></span>
<span><span class="co">#&gt; 1488.0948  418.6048  125.3175</span></span></code></pre>
<p>This agrees with the computed result.</p>
</div>
<div class="section level4">
<h4 id="radii-of-gyration-uncertainties">Radii of Gyration Uncertainties<a class="anchor" aria-label="anchor" href="#radii-of-gyration-uncertainties"></a>
</h4>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sigma_rog</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">mt</span>, <span class="va">It</span>, <span class="va">sigma_mt</span>, <span class="va">sigma_It</span>, <span class="va">v1</span>, <span class="va">c1</span>, <span class="va">v2</span>, <span class="va">c2</span>, <span class="va">sigma_m</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">sigma_It</span><span class="op">^</span><span class="fl">2</span> <span class="op">/</span> <span class="op">(</span><span class="fl">4</span> <span class="op">*</span> <span class="va">mt</span> <span class="op">*</span> <span class="va">It</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="va">It</span> <span class="op">*</span> <span class="va">sigma_mt</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">4</span> <span class="op">*</span> <span class="va">mt</span><span class="op">^</span><span class="fl">3</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">sigma_m</span><span class="op">^</span><span class="fl">2</span> <span class="op">*</span> <span class="op">(</span><span class="op">(</span><span class="va">v1</span> <span class="op">-</span> <span class="va">c1</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="op">(</span><span class="va">v2</span> <span class="op">-</span> <span class="va">c2</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">mt</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">sigma_ROG</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  sigma_kx <span class="op">=</span> <span class="fu">sigma_rog</span><span class="op">(</span><span class="va">sawe_result</span><span class="op">$</span><span class="va">mass</span>, <span class="va">sawe_result</span><span class="op">$</span><span class="va">Ixx</span>, <span class="va">sawe_result</span><span class="op">$</span><span class="va">sigma_mass</span>, <span class="va">sawe_result</span><span class="op">$</span><span class="va">sigma_Ixx</span>,</span>
<span>                       <span class="va">sawe_input</span><span class="op">$</span><span class="va">Cy</span>, <span class="va">sawe_result</span><span class="op">$</span><span class="va">Cy</span>, <span class="va">sawe_input</span><span class="op">$</span><span class="va">Cz</span>, <span class="va">sawe_result</span><span class="op">$</span><span class="va">Cz</span>, <span class="va">sawe_input</span><span class="op">$</span><span class="va">sigma_mass</span><span class="op">)</span>,</span>
<span>  sigma_ky <span class="op">=</span> <span class="fu">sigma_rog</span><span class="op">(</span><span class="va">sawe_result</span><span class="op">$</span><span class="va">mass</span>, <span class="va">sawe_result</span><span class="op">$</span><span class="va">Iyy</span>, <span class="va">sawe_result</span><span class="op">$</span><span class="va">sigma_mass</span>, <span class="va">sawe_result</span><span class="op">$</span><span class="va">sigma_Iyy</span>,</span>
<span>                       <span class="va">sawe_input</span><span class="op">$</span><span class="va">Cx</span>, <span class="va">sawe_result</span><span class="op">$</span><span class="va">Cx</span>, <span class="va">sawe_input</span><span class="op">$</span><span class="va">Cz</span>, <span class="va">sawe_result</span><span class="op">$</span><span class="va">Cz</span>, <span class="va">sawe_input</span><span class="op">$</span><span class="va">sigma_mass</span><span class="op">)</span>,</span>
<span>  sigma_kz <span class="op">=</span> <span class="fu">sigma_rog</span><span class="op">(</span><span class="va">sawe_result</span><span class="op">$</span><span class="va">mass</span>, <span class="va">sawe_result</span><span class="op">$</span><span class="va">Izz</span>, <span class="va">sawe_result</span><span class="op">$</span><span class="va">sigma_mass</span>, <span class="va">sawe_result</span><span class="op">$</span><span class="va">sigma_Izz</span>,</span>
<span>                       <span class="va">sawe_input</span><span class="op">$</span><span class="va">Cx</span>, <span class="va">sawe_result</span><span class="op">$</span><span class="va">Cx</span>, <span class="va">sawe_input</span><span class="op">$</span><span class="va">Cy</span>, <span class="va">sawe_result</span><span class="op">$</span><span class="va">Cy</span>, <span class="va">sawe_input</span><span class="op">$</span><span class="va">sigma_mass</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The independently-calculated radii of gyration uncertainties are</p>
<pre><code><span><span class="co">#&gt;  sigma_kx  sigma_ky  sigma_kz </span></span>
<span><span class="co">#&gt; 0.2971248 0.5484836 0.5402033</span></span></code></pre>
<p>This agrees with the computed result.</p>
</div>
</div>
<div class="section level3">
<h3 id="comparison-with-published-results">Comparison With Published Results<a class="anchor" aria-label="anchor" href="#comparison-with-published-results"></a>
</h3>
<p>The SAWE reference provides computed results for their example
(excluding radii of gyration and their uncertainties). These results
match those within a tolerance of 0.2%. The small differences are likely
because their actual input values were not identical to the truncated
values published in the article.</p>
</div>
</div>
<div class="section level2">
<h2 id="performance-evaluation">Performance Evaluation<a class="anchor" aria-label="anchor" href="#performance-evaluation"></a>
</h2>
<p><code>mp_table</code> and <code>mp_tree</code> are a synthesized data
set representing a tree of depth 7 with 1765 vertices and 1764 edges.
1267 vertices are leaves, the remaining 498 are non-leaves. Rolling up
mass properties and uncertainties for this data set combines 35280 input
values to produce 9960 output values. Mass properties alone halves those
values.</p>
<p>Benchmarks were taken on a platform with these CPU
characteristics:</p>
<pre><code>Python Version: 3.12.7.final.0 (64 bit)
Cpuinfo Version: 9.0.0
Vendor ID Raw:
Hardware Raw:
Brand Raw: Apple M3
Hz Advertised Friendly:
Hz Actual Friendly: 2.4000 GHz
Hz Advertised:
Hz Actual: (2400000000, 0)
Arch: ARM_8
Bits: 64
Count: 8
Arch String Raw: arm64
L1 Data Cache Size:
L1 Instruction Cache Size:
L2 Cache Size:
L2 Cache Line Size:
L2 Cache Associativity:
L3 Cache Size:
Stepping:
Model:
Family: 6
Processor Type:
Flags: acpi, aes, apic, clfsh, cmov, cx16, cx8, de, ds, dscpl, dtse64, est, fpu, fxsr, htt, mca, mce, mmx, mon, msr, mtrr, pae, pat, pbe, pclmulqdq, pdcm, pge, pse, pse36, seglim64, sep, ss, sse, sse2, sse3, sse4.1, sse4.2, ssse3, tm, tm2, tpr, tsc, vme, vmx</code></pre>
<p>Benchmark results for rollup of mass properties and uncertainties
were taken with and without input validation:</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">benchmark</span><span class="op">(</span><span class="st">'mp + unc no validation'</span> <span class="op">=</span> <span class="fu"><a href="../reference/rollup_mass_props_and_unc_fast.html">rollup_mass_props_and_unc_fast</a></span><span class="op">(</span><span class="va">mp_tree</span>, <span class="va">mp_table</span><span class="op">)</span>,</span>
<span>          <span class="st">'mp + unc    validation'</span> <span class="op">=</span> <span class="fu"><a href="../reference/rollup_mass_props_and_unc.html">rollup_mass_props_and_unc</a></span><span class="op">(</span><span class="va">mp_tree</span>, <span class="va">mp_table</span><span class="op">)</span>,</span>
<span>          <span class="st">'mp       no validation'</span> <span class="op">=</span> <span class="fu"><a href="../reference/rollup_mass_props_fast.html">rollup_mass_props_fast</a></span><span class="op">(</span><span class="va">mp_tree</span>, <span class="va">mp_table</span><span class="op">)</span>,</span>
<span>          <span class="st">'mp          validation'</span> <span class="op">=</span> <span class="fu"><a href="../reference/rollup_mass_props.html">rollup_mass_props</a></span><span class="op">(</span><span class="va">mp_tree</span>, <span class="va">mp_table</span><span class="op">)</span>,</span>
<span>          replications <span class="op">=</span> <span class="fl">10</span>,</span>
<span>          columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"test"</span>, <span class="st">"replications"</span>, <span class="st">"elapsed"</span>, <span class="st">"user.self"</span>, <span class="st">"sys.self"</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">mutate</span><span class="op">(</span>elapsed <span class="op">=</span> <span class="va">elapsed</span> <span class="op">/</span> <span class="fl">10</span>, user.self <span class="op">=</span> <span class="va">user.self</span> <span class="op">/</span> <span class="fl">10</span>, sys.self <span class="op">=</span> <span class="va">sys.self</span> <span class="op">/</span> <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<p>Times reported are in seconds.</p>
<pre><code>                    test replications elapsed user.self sys.self
4 mp          validation           10  1.0340    1.0182   0.0161
3 mp       no validation           10  0.6926    0.6821   0.0106
2 mp + unc    validation           10  1.6079    1.5814   0.0268
1 mp + unc no validation           10  1.0657    1.0465   0.0194</code></pre>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-wikipedia:uncprop" class="csl-entry">
Wikipedia contributors. 2024. <span>“Propagation of Uncertainty —
<span>Wikipedia</span><span>,</span> the Free Encyclopedia.”</span> <a href="https://en.wikipedia.org/w/index.php?title=Propagation_of_uncertainty&amp;oldid=1260292643" class="external-link uri">https://en.wikipedia.org/w/index.php?title=Propagation_of_uncertainty&amp;oldid=1260292643</a>.
</div>
<div id="ref-zimmerman:05:sawe" class="csl-entry">
Zimmerman, Robert L., and John H. Nakai. 2005. <span>“Are You Sure?
Uncertainty in Mass Properties Engineering.”</span> In <em>64th Annual
International Conference on Mass Properties Engineering</em>, 123–60.
Society of Allied Weight Engineers.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by James Steven Jenkins.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
