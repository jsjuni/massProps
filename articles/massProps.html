<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>massProps • massProps</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="massProps">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">massProps</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/massProps.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>massProps</h1>
            
      

      <div class="d-none name"><code>massProps.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>The <code>massProps</code> package extends <code>rollupTree</code>
with functions to recursively calculate mass properties (and optionally,
their uncertainties). Formulas implemented are described in a technical
paper published by the Society of Allied Weight Engineers.<span class="citation">(Zimmerman and Nakai 2005)</span></p>
</div>
<div class="section level2">
<h2 id="synopsis">Synopsis<a class="anchor" aria-label="anchor" href="#synopsis"></a>
</h2>
<div class="section level3">
<h3 id="data-structures">Data Structures<a class="anchor" aria-label="anchor" href="#data-structures"></a>
</h3>
<p><code>massProps</code> operates on two fundamental data structures: a
mass properties table and a tree. The mass properties table has an entry
for every item in a tree structure of items; the edges of the tree
convey the parent-child relations among items. The two data structures
are linked by the <code>id</code> column of the data frame, which must
be a character vector of unique item identifiers, and the vertex names
of the tree. The sets of identifiers must be identical.</p>
<div class="section level4">
<h4 id="mass-property-table">Mass Property Table<a class="anchor" aria-label="anchor" href="#mass-property-table"></a>
</h4>
<div class="section level5">
<h5 id="required-columns-for-mass-properties">Required Columns for Mass Properties<a class="anchor" aria-label="anchor" href="#required-columns-for-mass-properties"></a>
</h5>
<p>The Mass Property Table must contain the following columns. Other
columns may exist and will remain unmodified.</p>
<ul>
<li><p><code>id</code> unique identifier for each item (row)</p></li>
<li><p><code>mass</code> mass of the item (numeric)</p></li>
<li><p><code>Cx</code>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>-component
of center of mass (numeric)</p></li>
<li><p><code>Cy</code>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi><annotation encoding="application/x-tex">y</annotation></semantics></math>-component
of center of mass (numeric)</p></li>
<li><p><code>Cx</code>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>z</mi><annotation encoding="application/x-tex">z</annotation></semantics></math>-component
of center of mass (numeric)</p></li>
<li><p><code>Ixx</code> moment of inertia about the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>
axis (numeric)</p></li>
<li><p><code>Iyy</code> moment of inertia about the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi><annotation encoding="application/x-tex">y</annotation></semantics></math>
axis (numeric)</p></li>
<li><p><code>Izz</code> moment of inertia about the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>z</mi><annotation encoding="application/x-tex">z</annotation></semantics></math>
axis (numeric)</p></li>
<li><p><code>Ixy</code> product of inertia relative to the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi><annotation encoding="application/x-tex">y</annotation></semantics></math>
axes (numeric)</p></li>
<li><p><code>Ixz</code> product of inertia relative to the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>z</mi><annotation encoding="application/x-tex">z</annotation></semantics></math>
axes (numeric)</p></li>
<li><p><code>Iyz</code> product of inertia relative to the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi><annotation encoding="application/x-tex">y</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>z</mi><annotation encoding="application/x-tex">z</annotation></semantics></math>
axes (numeric)</p></li>
<li><p><code>POIconv</code> either ‘+’ or ‘-’, indicating the sign
convention for products of inertia<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;In the negative convention, for example, &lt;span class="math inline"&gt;$I_{XY} \equiv -\int xy \rho \thinspace dV$&lt;/span&gt;.
In the positive convention, &lt;span class="math inline"&gt;$I_{XY} \equiv
\int xy \rho \thinspace dV$&lt;/span&gt;.&lt;/p&gt;'><sup>1</sup></a></p></li>
<li><p><code>Ipoint</code> logical indicator that this item is
considered a point mass (i.e., its inertia contribution is negligible)<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;The same algebraic result can be achieved by setting all
moments and products of inertia to zero, but
&lt;code&gt;&lt;a href="../reference/rollup_mass_props.html"&gt;rollup_mass_props()&lt;/a&gt;&lt;/code&gt; by default ensures that all leaf items
in the tree have mass properties that correspond to
physically-realizable objects. A zero inertia tensor will fail this
check. Rather than relax the check (which is essential for trustworthy
results), a &lt;code&gt;TRUE&lt;/code&gt; value for &lt;code&gt;Ipoint&lt;/code&gt; indicates
that the inertia tensor should be excluded from computations. ``&lt;/p&gt;'><sup>2</sup></a></p></li>
</ul>
</div>
<div class="section level5">
<h5 id="required-columns-for-mass-properties-uncertainty">Required Columns for Mass Properties Uncertainty<a class="anchor" aria-label="anchor" href="#required-columns-for-mass-properties-uncertainty"></a>
</h5>
<p>The following columns are required for uncertainty calculations:</p>
<ul>
<li><p><code>σ_mass</code> mass uncertainty (numeric)</p></li>
<li><p><code>σ_Cx</code>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>-component
of center of mass uncertainty (numeric)</p></li>
<li><p><code>σ_Cy</code>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi><annotation encoding="application/x-tex">y</annotation></semantics></math>-component
of center of mass uncertainty (numeric)</p></li>
<li><p><code>σ_Cx</code>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>z</mi><annotation encoding="application/x-tex">z</annotation></semantics></math>-component
of center of mass uncertainty (numeric)</p></li>
<li><p><code>σ_Ixx</code> moment of inertia about the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>
axis uncertainty (numeric)</p></li>
<li><p><code>σ_Iyy</code> moment of inertia about the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi><annotation encoding="application/x-tex">y</annotation></semantics></math>
axis uncertainty (numeric)</p></li>
<li><p><code>σ_Izz</code> moment of inertia about the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>z</mi><annotation encoding="application/x-tex">z</annotation></semantics></math>
axis uncertainty (numeric)</p></li>
<li><p><code>σ_Ixy</code> product of inertia relative to the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi><annotation encoding="application/x-tex">y</annotation></semantics></math>
axes uncertainty (numeric)</p></li>
<li><p><code>σ_Ixz</code> product of inertia relative to the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>z</mi><annotation encoding="application/x-tex">z</annotation></semantics></math>
axes uncertainty (numeric)</p></li>
<li><p><code>σ_Iyz</code> product of inertia relative to the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi><annotation encoding="application/x-tex">y</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>z</mi><annotation encoding="application/x-tex">z</annotation></semantics></math>
axes uncertainty (numeric)</p></li>
</ul>
<p>It is the caller’s responsibility to ensure that all values are
expressed in appropriate and compatible units.</p>
</div>
<div class="section level5">
<h5 id="tree">Tree<a class="anchor" aria-label="anchor" href="#tree"></a>
</h5>
<p>The tree is an <code><a href="https://r.igraph.org/reference/graph.html" class="external-link">igraph::graph</a></code> with vertices named by
identifiers in the mass properties table. It can be of arbitrary depth
and shape as long as it satisfies certain well-formedness
properties:</p>
<ul>
<li><p>it is connected and acyclic (as an undirected graph), i.e., it is
a tree</p></li>
<li><p>it is directed, with edge direction going from child to
parent</p></li>
<li><p>it contains neither loops (self-edges) nor multiple
edges</p></li>
<li><p>it contains a single root vertex (i.e., one whose out degree is
zero)</p></li>
</ul>
</div>
</div>
</div>
<div class="section level3">
<h3 id="invocation">Invocation<a class="anchor" aria-label="anchor" href="#invocation"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://jsjuni.github.io/rollupTree/" class="external-link">rollupTree</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://jsjuni.github.io/massProps/">massProps</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="op">{</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r.igraph.org/" class="external-link">igraph</a></span><span class="op">)</span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<p>Suppose we have the following mass properties table:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">test_table</span></span>
<span><span class="co">#&gt;     id parent mass Cx Cy Cz Ixx  Ixy   Ixz Iyy   Iyz Izz POIconv Ipoint</span></span>
<span><span class="co">#&gt; 1  A.1          NA NA NA NA  NA   NA    NA  NA    NA  NA       -  FALSE</span></span>
<span><span class="co">#&gt; 2  A.2    A.1   NA NA NA NA  NA   NA    NA  NA    NA  NA       -  FALSE</span></span>
<span><span class="co">#&gt; 3  A.3    A.1   NA NA NA NA  NA   NA    NA  NA    NA  NA       -  FALSE</span></span>
<span><span class="co">#&gt; 4  C.1    A.1    5  0  0  0  80 -4.0 -24.0  80 -24.0  75       -  FALSE</span></span>
<span><span class="co">#&gt; 5  P.1    A.2    2  1  1  1   4 -0.1  -0.1   4   0.1   4       -  FALSE</span></span>
<span><span class="co">#&gt; 6  P.2    A.2    2  1  1 -1   4 -0.1  -0.1   4   0.1   4       -  FALSE</span></span>
<span><span class="co">#&gt; 7  P.3    A.2    2  1 -1  1   4 -0.1  -0.1   4   0.1   4       -  FALSE</span></span>
<span><span class="co">#&gt; 8  P.4    A.2    2  1 -1 -1   4 -0.1  -0.1   4   0.1   4       -  FALSE</span></span>
<span><span class="co">#&gt; 9  P.5    A.3    2 -1  1  1   4 -0.1  -0.1   4   0.1   4       -  FALSE</span></span>
<span><span class="co">#&gt; 10 P.6    A.3    2 -1  1 -1   4 -0.1  -0.1   4   0.1   4       -  FALSE</span></span>
<span><span class="co">#&gt; 11 P.7    A.3    2 -1 -1  1   4 -0.1  -0.1   4   0.1   4       -  FALSE</span></span>
<span><span class="co">#&gt; 12 P.8    A.3    2 -1 -1 -1   4 -0.1  -0.1   4   0.1   4       -  FALSE</span></span></code></pre></div>
<p>Suppose we also have this tree:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">test_tree</span></span>
<span><span class="co">#&gt; IGRAPH d76039e DN-- 12 11 -- </span></span>
<span><span class="co">#&gt; + attr: name (v/c)</span></span>
<span><span class="co">#&gt; + edges from d76039e (vertex names):</span></span>
<span><span class="co">#&gt;  [1] A.2-&gt;A.1 A.3-&gt;A.1 C.1-&gt;A.1 P.1-&gt;A.2 P.2-&gt;A.2 P.3-&gt;A.2 P.4-&gt;A.2 P.5-&gt;A.3</span></span>
<span><span class="co">#&gt;  [9] P.6-&gt;A.3 P.7-&gt;A.3 P.8-&gt;A.3</span></span></code></pre></div>
<p><img src="massProps_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<p>Then we can compute mass properties for non-leaf elements by calling
<code><a href="../reference/rollup_mass_props.html">rollup_mass_props()</a></code>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/rollup_mass_props.html">rollup_mass_props</a></span><span class="op">(</span><span class="va">test_tree</span>, <span class="va">test_table</span><span class="op">)</span></span>
<span><span class="co">#&gt;     id parent mass Cx Cy Cz Ixx  Ixy   Ixz Iyy   Iyz Izz POIconv Ipoint</span></span>
<span><span class="co">#&gt; 1  A.1          21  0  0  0 144 -4.8 -24.8 144 -23.2 139       -  FALSE</span></span>
<span><span class="co">#&gt; 2  A.2    A.1    8  1  0  0  32 -0.4  -0.4  24   0.4  24       -  FALSE</span></span>
<span><span class="co">#&gt; 3  A.3    A.1    8 -1  0  0  32 -0.4  -0.4  24   0.4  24       -  FALSE</span></span>
<span><span class="co">#&gt; 4  C.1    A.1    5  0  0  0  80 -4.0 -24.0  80 -24.0  75       -  FALSE</span></span>
<span><span class="co">#&gt; 5  P.1    A.2    2  1  1  1   4 -0.1  -0.1   4   0.1   4       -  FALSE</span></span>
<span><span class="co">#&gt; 6  P.2    A.2    2  1  1 -1   4 -0.1  -0.1   4   0.1   4       -  FALSE</span></span>
<span><span class="co">#&gt; 7  P.3    A.2    2  1 -1  1   4 -0.1  -0.1   4   0.1   4       -  FALSE</span></span>
<span><span class="co">#&gt; 8  P.4    A.2    2  1 -1 -1   4 -0.1  -0.1   4   0.1   4       -  FALSE</span></span>
<span><span class="co">#&gt; 9  P.5    A.3    2 -1  1  1   4 -0.1  -0.1   4   0.1   4       -  FALSE</span></span>
<span><span class="co">#&gt; 10 P.6    A.3    2 -1  1 -1   4 -0.1  -0.1   4   0.1   4       -  FALSE</span></span>
<span><span class="co">#&gt; 11 P.7    A.3    2 -1 -1  1   4 -0.1  -0.1   4   0.1   4       -  FALSE</span></span>
<span><span class="co">#&gt; 12 P.8    A.3    2 -1 -1 -1   4 -0.1  -0.1   4   0.1   4       -  FALSE</span></span></code></pre></div>
<p>The input may also contain uncertainty data. This example is from the
Society of Allied Weight Engineers:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sawe_input</span></span>
<span><span class="co">#&gt;         id  mass    Cx    Cy    Cz     Ixx     Iyy      Izz    Ixy      Ixz</span></span>
<span><span class="co">#&gt; 1   Widget 57.83 121.2  0.04 -0.16 7258.90 8607.02 10453.40 834.44 -1198.38</span></span>
<span><span class="co">#&gt; 2 2nd Part 16.80  70.9 -0.95  0.46   65.07 1124.65  1078.82  76.01   202.83</span></span>
<span><span class="co">#&gt; 3 Combined    NA    NA    NA    NA      NA      NA       NA     NA       NA</span></span>
<span><span class="co">#&gt;        Iyz σ_mass   σ_Cx   σ_Cy   σ_Cz    σ_Ixx    σ_Iyy    σ_Izz     σ_Ixy</span></span>
<span><span class="co">#&gt; 1 -1066.58 1.2416 0.2764 0.2085 0.0669 386.9233 171.4792 414.5547 1440.5402</span></span>
<span><span class="co">#&gt; 2    13.62 1.7308 0.6234 0.5173 0.1405  12.4687 109.1324 108.5481   55.8879</span></span>
<span><span class="co">#&gt; 3       NA     NA     NA     NA     NA       NA       NA       NA        NA</span></span>
<span><span class="co">#&gt;      σ_Ixz    σ_Iyz Ipoint POIconv</span></span>
<span><span class="co">#&gt; 1 344.6237 124.6860  FALSE       +</span></span>
<span><span class="co">#&gt; 2 212.1241  11.5408  FALSE       +</span></span>
<span><span class="co">#&gt; 3       NA       NA  FALSE       +</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/rollup_mass_props_and_unc.html">rollup_mass_props_and_unc</a></span><span class="op">(</span><span class="va">sawe_tree</span>, <span class="va">sawe_input</span><span class="op">)</span></span>
<span><span class="co">#&gt;         id  mass       Cx         Cy          Cz      Ixx      Iyy      Izz</span></span>
<span><span class="co">#&gt; 1   Widget 57.83 121.2000  0.0400000 -0.16000000 7258.900  8607.02 10453.40</span></span>
<span><span class="co">#&gt; 2 2nd Part 16.80  70.9000 -0.9500000  0.46000000   65.070  1124.65  1078.82</span></span>
<span><span class="co">#&gt; 3 Combined 74.63 109.8769 -0.1828594 -0.02043146 7341.733 42673.75 44482.05</span></span>
<span><span class="co">#&gt;        Ixy       Ixz       Iyz  σ_mass    σ_Cx      σ_Cy       σ_Cz    σ_Ixx</span></span>
<span><span class="co">#&gt; 1  834.440 -1198.380 -1066.580 1.24160 0.27640 0.2085000 0.06690000 386.9233</span></span>
<span><span class="co">#&gt; 2   76.010   202.830    13.620 1.73080 0.62340 0.5173000 0.14050000  12.4687</span></span>
<span><span class="co">#&gt; 3 1558.714 -1401.534 -1060.951 2.13008 0.95821 0.1999847 0.06178402 387.4017</span></span>
<span><span class="co">#&gt;       σ_Iyy     σ_Izz     σ_Ixy    σ_Ixz    σ_Iyz Ipoint POIconv</span></span>
<span><span class="co">#&gt; 1  171.4792  414.5547 1440.5402 344.6237 124.6860  FALSE       +</span></span>
<span><span class="co">#&gt; 2  109.1324  108.5481   55.8879 212.1241  11.5408  FALSE       +</span></span>
<span><span class="co">#&gt; 3 2789.3133 2815.3260 1488.0948 418.6048 125.3175  FALSE       +</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="objectives-and-strategy">Objectives and Strategy<a class="anchor" aria-label="anchor" href="#objectives-and-strategy"></a>
</h2>
<p>The objective of this package is to provide a trustworthy,
well-documented, reference implementation for computation of mass
properties (and their uncertainties) of aggregate objects from those of
their parts. Aggregation can be recursive (e.g., indentured Bill of
Materials), so it must accommodate trees of arbitrary depth and
shape.</p>
<p>Strategies for achieving the objective include</p>
<ul>
<li><p>basing the calculations on published industry
references,</p></li>
<li><p>re-casting those lengthy reference equations into concise vector
or matrix forms to reduce the error surface for source code and exploit
the capabilities of <code>R</code>, which treats vectors and matrices as
first-class objects,</p></li>
<li><p>delegating orchestration to the <code>rollupTree</code> package,
which, among other things, verifies that the input tree is well-formed
and ensures proper ordering of computations,</p></li>
<li><p>ensuring that all asserted leaf mass properties and uncertainties
correspond to physically-realizable objects,</p></li>
<li><p>coding in pure functional style, (i.e., avoiding mutable
variables, implying iteration with <code><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Map()</a></code> and
<code><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Reduce()</a></code>), and</p></li>
<li><p>covering the entire code base with unit tests.</p></li>
</ul>
<p>The author has intentionally made no effort to optimize for
performance. That said, in its current form it handles computations on
the scale encountered in the design of interplanetary spacecraft in a
few seconds.</p>
</div>
<div class="section level2">
<h2 id="theory">Theory<a class="anchor" aria-label="anchor" href="#theory"></a>
</h2>
<p>In this section, we state the reference equations <span class="citation">(Zimmerman and Nakai 2005)</span> and show, where
applicable, how those equations can be rewritten in more concise form.
The form of the equations actually implemented is displayed within a
box,
e.g. <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><menclose notation="box"><mrow><mi>F</mi><mo>=</mo><mi>m</mi><mi>a</mi></mrow></menclose><annotation encoding="application/x-tex">\boxed{F = ma}</annotation></semantics></math>.</p>
<p>The reference uses the word <em>weight</em> and the symbol
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>w</mi><annotation encoding="application/x-tex">w</annotation></semantics></math>
in equations. We interpret weight as mass. The reference refers to
center of mass by its
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi><annotation encoding="application/x-tex">y</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>z</mi><annotation encoding="application/x-tex">z</annotation></semantics></math>
components. Symbols for moments
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>I</mi><mrow><mi>X</mi><mi>X</mi></mrow></msub><annotation encoding="application/x-tex">I_{XX}</annotation></semantics></math>)
and products
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>I</mi><mrow><mi>X</mi><mi>Y</mi></mrow></msub><annotation encoding="application/x-tex">I_{XY}</annotation></semantics></math>)
of inertia are conventional. Variables with subscripts designate
properties of parts; those without designate properties of aggregates.
The letter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>σ</mi><annotation encoding="application/x-tex">\sigma</annotation></semantics></math>
denotes uncertainty.
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>σ</mi><mi>w</mi></msub><annotation encoding="application/x-tex">\sigma_w</annotation></semantics></math>,
for example, is the mass uncertainty</p>
<div class="section level3">
<h3 id="mass-properties">Mass Properties<a class="anchor" aria-label="anchor" href="#mass-properties"></a>
</h3>
<div class="section level4">
<h4 id="mass">Mass<a class="anchor" aria-label="anchor" href="#mass"></a>
</h4>
<p>The mass equation is suitable as is.</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><menclose notation="box"><mrow><mi>w</mi><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>w</mi><mi>i</mi></msub></mrow></menclose><annotation encoding="application/x-tex">
\boxed{
w = \sum_{i=1}^{n}w_i
}
</annotation></semantics></math></p>
<p>The corresponding <code>R</code> code is</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">r</span><span class="op">$</span><span class="va">mass</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Reduce</a></span><span class="op">(</span><span class="va">`+`</span>, <span class="fu"><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Map</a></span><span class="op">(</span>f <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">v</span><span class="op">)</span> <span class="va">v</span><span class="op">$</span><span class="va">mass</span>, <span class="va">vl</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>In this and the following code snippets, the variable <code>vl</code>
is a list of input mass property sets, the variable <code>v</code> is a
formal parameter of an anonymous function applied to each member of
<code>vl</code>, and <code>r</code> is the resulting mass properties.
The line above is an <code>R</code> functional programming idiom for
“set the mass value of the result to the sum of the mass values of the
inputs”.</p>
</div>
<div class="section level4">
<h4 id="center-of-mass">Center of Mass<a class="anchor" aria-label="anchor" href="#center-of-mass"></a>
</h4>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mover><mi>x</mi><mo accent="true">‾</mo></mover></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>w</mi><mi>i</mi></msub><msub><mi>x</mi><mi>i</mi></msub><mi minsize="2.4" maxsize="2.4">/</mi><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>w</mi><mi>i</mi></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mover><mi>y</mi><mo accent="true">‾</mo></mover></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>w</mi><mi>i</mi></msub><msub><mi>y</mi><mi>i</mi></msub><mi minsize="2.4" maxsize="2.4">/</mi><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>w</mi><mi>i</mi></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mover><mi>z</mi><mo accent="true">‾</mo></mover></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>w</mi><mi>i</mi></msub><msub><mi>z</mi><mi>i</mi></msub><mi minsize="2.4" maxsize="2.4">/</mi><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>w</mi><mi>i</mi></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{align}
\bar{x} &amp; = \sum_{i=1}^{n}{w_i}{{x}_i} \bigg/ \sum_{i=1}^{n}w_i\\
\bar{y} &amp; = \sum_{i=1}^{n}{w_i}{{y}_i} \bigg/ \sum_{i=1}^{n}w_i\\
\bar{z} &amp; = \sum_{i=1}^{n}{w_i}{{z}_i} \bigg/ \sum_{i=1}^{n}w_i\\
\end{align}
</annotation></semantics></math></p>
<p>We can express center of mass as a 3-vector:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><menclose notation="box"><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>𝐜</mi><mi>i</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mspace width="1.0em"></mspace><msub><mi>y</mi><mi>i</mi></msub><mspace width="1.0em"></mspace><msub><mi>z</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>T</mi></msup></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mover><mi>𝐜</mi><mo accent="true">‾</mo></mover></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mspace width="1.0em"></mspace><mover><mi>y</mi><mo accent="true">‾</mo></mover><mspace width="1.0em"></mspace><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mi>T</mi></msup></mtd></mtr></mtable></menclose><annotation encoding="application/x-tex">
\boxed{
\begin{align}
\boldsymbol{c}_i &amp; = (x_i \quad y_i \quad z_i)^T \\
\boldsymbol{\bar{c}}&amp; = (\bar{x} \quad \bar{y} \quad \bar{z})^T
\end{align}
}
</annotation></semantics></math></p>
<p>Then</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><menclose notation="box"><mrow><mover><mi>𝐜</mi><mo accent="true">‾</mo></mover><mo>=</mo><mfrac><mn>1</mn><mi>w</mi></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>w</mi><mi>i</mi></msub><msub><mi>𝐜</mi><mi>i</mi></msub></mrow></menclose><annotation encoding="application/x-tex">
\boxed{
\boldsymbol{\bar{c}} = \frac{1}{w} \sum_{i=1}^{n}{w_i}{{\boldsymbol{c}}_i}
}
</annotation></semantics></math></p>
<p>The corresponding <code>R</code> code is</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">r</span><span class="op">$</span><span class="va">center_mass</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Reduce</a></span><span class="op">(</span><span class="va">`+`</span>, <span class="fu"><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Map</a></span><span class="op">(</span>f <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">v</span><span class="op">)</span> <span class="va">v</span><span class="op">$</span><span class="va">mass</span> <span class="op">*</span> <span class="va">v</span><span class="op">$</span><span class="va">center_mass</span>, <span class="va">vl</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="va">r</span><span class="op">$</span><span class="va">mass</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="inertia-tensor">Inertia Tensor<a class="anchor" aria-label="anchor" href="#inertia-tensor"></a>
</h4>
<div class="section level5">
<h5 id="moments-of-inertia">Moments of Inertia<a class="anchor" aria-label="anchor" href="#moments-of-inertia"></a>
</h5>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>I</mi><mrow><mi>X</mi><mi>X</mi></mrow></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><mo stretchy="true" form="prefix">[</mo><msub><msub><mi>I</mi><mrow><mi>X</mi><mi>X</mi></mrow></msub><mi>i</mi></msub><mo>+</mo><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>y</mi><mi>i</mi><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>z</mi><mi>i</mi><mn>2</mn></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msup><mover><mi>y</mi><mo accent="true">‾</mo></mover><mn>2</mn></msup><mo>+</mo><msup><mover><mi>z</mi><mo accent="true">‾</mo></mover><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow></mtd><mtd columnalign="right" style="text-align: right"><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><mo stretchy="true" form="prefix">{</mo><msub><msub><mi>I</mi><mrow><mi>X</mi><mi>X</mi></mrow></msub><mi>i</mi></msub><mo>+</mo><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">[</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>+</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo stretchy="true" form="postfix">]</mo></mrow><mo stretchy="true" form="postfix">}</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>I</mi><mrow><mi>Y</mi><mi>Y</mi></mrow></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><mo stretchy="true" form="prefix">[</mo><msub><msub><mi>I</mi><mrow><mi>Y</mi><mi>Y</mi></mrow></msub><mi>i</mi></msub><mo>+</mo><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>x</mi><mi>i</mi><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>z</mi><mi>i</mi><mn>2</mn></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msup><mover><mi>x</mi><mo accent="true">‾</mo></mover><mn>2</mn></msup><mo>+</mo><msup><mover><mi>z</mi><mo accent="true">‾</mo></mover><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow></mtd><mtd columnalign="right" style="text-align: right"><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><mo stretchy="true" form="prefix">{</mo><msub><msub><mi>I</mi><mrow><mi>Y</mi><mi>Y</mi></mrow></msub><mi>i</mi></msub><mo>+</mo><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">[</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>+</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo stretchy="true" form="postfix">]</mo></mrow><mo stretchy="true" form="postfix">}</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>I</mi><mrow><mi>Z</mi><mi>Z</mi></mrow></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><mo stretchy="true" form="prefix">[</mo><msub><msub><mi>I</mi><mrow><mi>Z</mi><mi>Z</mi></mrow></msub><mi>i</mi></msub><mo>+</mo><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>x</mi><mi>i</mi><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>y</mi><mi>i</mi><mn>2</mn></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msup><mover><mi>x</mi><mo accent="true">‾</mo></mover><mn>2</mn></msup><mo>+</mo><msup><mover><mi>y</mi><mo accent="true">‾</mo></mover><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow></mtd><mtd columnalign="right" style="text-align: right"><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><mo stretchy="true" form="prefix">{</mo><msub><msub><mi>I</mi><mrow><mi>Z</mi><mi>Z</mi></mrow></msub><mi>i</mi></msub><mo>+</mo><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">[</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>+</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo stretchy="true" form="postfix">]</mo></mrow><mo stretchy="true" form="postfix">}</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{align}
I_{XX} &amp; = 
  \sum_{i=1}^{n} \left[ {I_{XX}}_i
    + w_i \left( {y}_i^2 + {z}_i^2 \right)
  - w_i \left( \bar{y}^2 + \bar{z}^2 \right)
  \right]
 &amp; = 
\sum_{i=1}^{n} \left\{ {I_{XX}}_i
  + w_i \left[ \left( {y}_i - \bar{y} \right)^2 + \left( {z}_i - \bar{z} \right)^2 \right]
  \right\}
 \\
I_{YY} &amp; = 
  \sum_{i=1}^{n} \left[ {I_{YY}}_i
    + w_i \left( {x}_i^2 + {z}_i^2 \right)
  - w_i \left( \bar{x}^2 + \bar{z}^2 \right)
  \right]
 &amp; = 
\sum_{i=1}^{n} \left\{ {I_{YY}}_i
  + w_i \left[ \left( {x}_i - \bar{x} \right)^2 + \left( {z}_i - \bar{z} \right)^2 \right]
  \right\}
 \\
I_{ZZ} &amp; = 
  \sum_{i=1}^{n} \left[ {I_{ZZ}}_i
    + w_i \left( {x}_i^2 + {y}_i^2 \right)
  - w_i \left( \bar{x}^2 + \bar{y}^2 \right)
  \right]
 &amp; = 
\sum_{i=1}^{n} \left\{ {I_{ZZ}}_i
  + w_i \left[ \left( {x}_i - \bar{x} \right)^2 + \left( {y}_i - \bar{y} \right)^2 \right]
  \right\}
 \\
\end{align}
</annotation></semantics></math></p>
</div>
<div class="section level5">
<h5 id="products-of-inertia">Products of Inertia<a class="anchor" aria-label="anchor" href="#products-of-inertia"></a>
</h5>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>I</mi><mrow><mi>X</mi><mi>Y</mi></mrow></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><mo stretchy="true" form="prefix">[</mo><msub><msub><mi>I</mi><mrow><mi>X</mi><mi>Y</mi></mrow></msub><mi>i</mi></msub><mo>+</mo><msub><mi>w</mi><mi>i</mi></msub><msub><mi>x</mi><mi>i</mi></msub><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow></mtd><mtd columnalign="right" style="text-align: right"><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><mo stretchy="true" form="prefix">[</mo><msub><msub><mi>I</mi><mrow><mi>X</mi><mi>Y</mi></mrow></msub><mi>i</mi></msub><mo>+</mo><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>I</mi><mrow><mi>X</mi><mi>Z</mi></mrow></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><mo stretchy="true" form="prefix">[</mo><msub><msub><mi>I</mi><mrow><mi>X</mi><mi>Z</mi></mrow></msub><mi>i</mi></msub><mo>+</mo><msub><mi>w</mi><mi>i</mi></msub><msub><mi>x</mi><mi>i</mi></msub><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow></mtd><mtd columnalign="right" style="text-align: right"><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><mo stretchy="true" form="prefix">[</mo><msub><msub><mi>I</mi><mrow><mi>X</mi><mi>Z</mi></mrow></msub><mi>i</mi></msub><mo>+</mo><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>I</mi><mrow><mi>Y</mi><mi>Z</mi></mrow></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><mo stretchy="true" form="prefix">[</mo><msub><msub><mi>I</mi><mrow><mi>Y</mi><mi>Z</mi></mrow></msub><mi>i</mi></msub><mo>+</mo><msub><mi>w</mi><mi>i</mi></msub><msub><mi>y</mi><mi>i</mi></msub><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow></mtd><mtd columnalign="right" style="text-align: right"><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><mo stretchy="true" form="prefix">[</mo><msub><msub><mi>I</mi><mrow><mi>Y</mi><mi>Z</mi></mrow></msub><mi>i</mi></msub><mo>+</mo><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{align}
I_{XY} &amp; = \sum_{i=1}^{n} \left[ {I_{XY}}_i + w_i {{x}_i}{{y}_i} -w_i (\bar{x}\bar{y})\right] &amp; = \sum_{i=1}^{n} \left[ {I_{XY}}_i + w_i ({x}_i - \bar{x})({y}_i - \bar{y})\right] \\
I_{XZ} &amp; = \sum_{i=1}^{n} \left[ {I_{XZ}}_i + w_i {{x}_i}{{z}_i} -w_i (\bar{x}\bar{z})\right] &amp; = \sum_{i=1}^{n} \left[ {I_{XZ}}_i + w_i ({x}_i - \bar{x})({z}_i - \bar{z})\right] \\
I_{YZ} &amp; = \sum_{i=1}^{n} \left[ {I_{YZ}}_i + w_i {{y}_i}{{z}_i} -w_i (\bar{y}\bar{z})\right] &amp; = \sum_{i=1}^{n} \left[ {I_{YZ}}_i + w_i ({y}_i - \bar{y})({z}_i - \bar{z})\right] \\
\end{align}
</annotation></semantics></math></p>
</div>
<div class="section level5">
<h5 id="matrix-formulation">Matrix Formulation<a class="anchor" aria-label="anchor" href="#matrix-formulation"></a>
</h5>
<p>Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>I</mi><annotation encoding="application/x-tex">I</annotation></semantics></math>
be the inertia tensor of the aggregate and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>I</mi><mi>i</mi></msub><annotation encoding="application/x-tex">I_i</annotation></semantics></math>
be that of part
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>.
The equations for products of inertia above clearly follow the positive
integral convention, so</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">[</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>I</mi><mrow><mi>X</mi><mi>X</mi></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><mo>−</mo><msub><mi>I</mi><mrow><mi>X</mi><mi>Y</mi></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><mo>−</mo><msub><mi>I</mi><mrow><mi>X</mi><mi>Z</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mo>−</mo><msub><mi>I</mi><mrow><mi>X</mi><mi>Y</mi></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>I</mi><mrow><mi>Y</mi><mi>Y</mi></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><mo>−</mo><msub><mi>I</mi><mrow><mi>Y</mi><mi>Z</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mo>−</mo><msub><mi>I</mi><mrow><mi>X</mi><mi>Z</mi></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><mo>−</mo><msub><mi>I</mi><mrow><mi>Y</mi><mi>Z</mi></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>I</mi><mrow><mi>Z</mi><mi>Z</mi></mrow></msub></mtd></mtr></mtable><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">
I =
\left[ \begin{matrix}
 I_{XX} &amp; -I_{XY} &amp; -I_{XZ} \\
-I_{XY} &amp;  I_{YY} &amp; -I_{YZ} \\
-I_{XZ} &amp; -I_{YZ} &amp;  I_{ZZ} 
\end{matrix}
\right]
</annotation></semantics></math></p>
<p>and similarly for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>I</mi><mi>i</mi></msub><annotation encoding="application/x-tex">I_i</annotation></semantics></math>.</p>
<p>Noting the repeated appearance of terms of the form
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">({x}_i - \bar{x})</annotation></semantics></math>,
we form the outer product</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><menclose notation="box"><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>𝐝</mi><mi>i</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="1.0em"></mspace><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="1.0em"></mspace><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mi>T</mi></msup></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>𝐐</mi><mi>i</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msub><mi>𝐝</mi><mi>i</mi></msub><msup><msub><mi>𝐝</mi><mi>i</mi></msub><mi>T</mi></msup></mtd></mtr></mtable></menclose><annotation encoding="application/x-tex">
\boxed{
\begin{align}
\boldsymbol{d}_i &amp; = (({x}_i - \bar{x}) \quad ({y}_i - \bar{y}) \quad ({z}_i - \bar{z}))^T \\
\boldsymbol{Q}_i &amp; = \boldsymbol{d}_i {\boldsymbol{d}_i}^T
\end{align}
}
</annotation></semantics></math> Then</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>𝐐</mi><mi>i</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mrow><mo stretchy="true" form="prefix">[</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mtd><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="center" style="text-align: center"><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mtd><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="center" style="text-align: center"><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><mo stretchy="true" form="postfix">]</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{align}
\boldsymbol{Q}_i &amp; =
\begin{bmatrix}
({x}_i - \bar{x})^2     &amp; ({x}_i - \bar{x})({y}_i - \bar{y}) &amp; ({x}_i - \bar{x})({z}_i - \bar{z}) \\
({y}_i - \bar{y})({x}_i - \bar{x}) &amp; ({y}_i - \bar{y})^2     &amp; ({y}_i - \bar{y})({z}_i - \bar{z}) \\
({z}_i - \bar{z})({x}_i - \bar{x}) &amp; ({z}_i - \bar{z})({y}_i - \bar{y}) &amp; ({z}_i - \bar{z})^2     \\
\end{bmatrix}
\end{align}
</annotation></semantics></math></p>
<p>Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>𝐬</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\boldsymbol{s}_i</annotation></semantics></math>
be the matrix of inertia tensor summands from the reference equations.
That is,</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝐈</mi><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>𝐬</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">
\boldsymbol{I} = \sum_{i=1}^{n} \boldsymbol{s}_i
</annotation></semantics></math></p>
<p>where
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>𝐬</mi><mi>i</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msub><mi>𝐈</mi><mi>i</mi></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>−</mo><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">[</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mo>−</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>−</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mtd><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="center" style="text-align: center"><mo>−</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>−</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mtd><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="center" style="text-align: center"><mo>−</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>−</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><mo stretchy="true" form="postfix">]</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msub><mi>𝐈</mi><mi>i</mi></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>−</mo><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">[</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mtd><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="center" style="text-align: center"><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mtd><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="center" style="text-align: center"><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><mo stretchy="true" form="postfix">]</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>−</mo><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">[</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mo>−</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>−</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>−</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mo>−</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>−</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>−</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mo>−</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>−</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>−</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><mo stretchy="true" form="postfix">]</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msub><mi>𝐈</mi><mi>i</mi></msub><mo>−</mo><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>𝐐</mi><mi>i</mi></msub><mo>−</mo><mrow><mi mathvariant="normal">t</mi><mi mathvariant="normal">r</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>𝐐</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><msub><mn>𝟏</mn><mn>3</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{align}
\boldsymbol{s}_i &amp; = \boldsymbol{I}_i \\
&amp; -
w_i \begin{bmatrix}
-({y}_i - \bar{y})^2 - ({z}_i - \bar{z})^2 &amp; ({x}_i - \bar{x})({y}_i - \bar{y})         &amp; ({x}_i - \bar{x})({z}_i - \bar{z})         \\
({x}_i - \bar{x})({y}_i - \bar{y})         &amp; -({x}_i - \bar{x})^2 - ({z}_i - \bar{z})^2 &amp;  ({y}_i - \bar{y})({z}_i - \bar{z})        \\
({x}_i - \bar{x})({z}_i - \bar{z})         &amp; ({y}_i - \bar{y})({z}_i - \bar{z})         &amp; -({x}_i - \bar{x})^2 - ({y}_i - \bar{y})^2 \\
\end{bmatrix} \\
&amp; =
\boldsymbol{I}_i \\
&amp; -
w_i \begin{bmatrix}
({x}_i - \bar{x})^2     &amp; ({x}_i - \bar{x})({y}_i - \bar{y}) &amp; ({x}_i - \bar{x})({z}_i - \bar{z}) \\
({x}_i - \bar{x})({y}_i - \bar{y}) &amp; ({y}_i - \bar{y})^2     &amp; ({y}_i - \bar{y})({z}_i - \bar{z}) \\
({x}_i - \bar{x})({z}_i - \bar{z}) &amp; ({y}_i - \bar{y})({z}_i - \bar{z}) &amp; ({z}_i - \bar{z})^2     \\
\end{bmatrix} \\
&amp; -
w_i \begin{bmatrix}
-({x}_i - \bar{x})^2 - ({y}_i - \bar{y})^2 - ({z}_i - \bar{z})^2 &amp; 0                               &amp; 0                              \\
0                               &amp; -({x}_i - \bar{x})^2 - ({y}_i - \bar{y})^2 - ({z}_i - \bar{z})^2 &amp; 0                              \\
0                               &amp; 0                               &amp;-({x}_i - \bar{x})^2 - ({y}_i - \bar{y})^2 - ({z}_i - \bar{z})^2 \\
\end{bmatrix} \\
&amp; = 
\boldsymbol{I}_i
- 
w_i \left( \boldsymbol{Q}_i - \mathrm{tr}(\boldsymbol{Q}_i) \boldsymbol{1}_3 \right)
\end{align}
</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mn>𝟏</mn><mn>3</mn></msub><annotation encoding="application/x-tex">\boldsymbol{1}_3</annotation></semantics></math>
is the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>3</mn><mi>x</mi><mn>3</mn></mrow><annotation encoding="application/x-tex">3x3</annotation></semantics></math>
identity matrix. Therefore</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><menclose notation="box"><mrow><mi>𝐈</mi><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><mo stretchy="true" form="prefix">{</mo><msub><mi>𝐈</mi><mi>i</mi></msub><mo>−</mo><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>𝐐</mi><mi>i</mi></msub><mo>−</mo><mrow><mi mathvariant="normal">t</mi><mi mathvariant="normal">r</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>𝐐</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><msub><mn>𝟏</mn><mn>3</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">}</mo></mrow></mrow></menclose><annotation encoding="application/x-tex">
\boxed{
\boldsymbol{I} = \sum_{i=1}^{n} \left\{ \boldsymbol{I}_i
- 
w_i \left( \boldsymbol{Q}_i - \mathrm{tr}(\boldsymbol{Q}_i) \boldsymbol{1}_3 \right) \right\}
}
</annotation></semantics></math></p>
<p>The corresponding <code>R</code> code is</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode R R"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>  r<span class="sc">$</span>inertia <span class="ot">&lt;-</span> <span class="fu">Reduce</span>(<span class="st">`</span><span class="at">+</span><span class="st">`</span>, <span class="fu">Map</span>(</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>    <span class="at">f  =</span> <span class="cf">function</span>(v) {</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>      d <span class="ot">&lt;-</span> r<span class="sc">$</span>center_mass <span class="sc">-</span> v<span class="sc">$</span>center_mass</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>      d_ss2 <span class="ot">&lt;-</span> <span class="fu">outer</span>(d, d) <span class="sc">-</span> <span class="fu">sum</span>(d<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> <span class="fu">diag</span>(<span class="dv">3</span>)</span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>      <span class="cf">if</span> (v<span class="sc">$</span>point) <span class="sc">-</span>v<span class="sc">$</span>mass <span class="sc">*</span> d_ss2 <span class="cf">else</span> v<span class="sc">$</span>inertia <span class="sc">-</span> v<span class="sc">$</span>mass <span class="sc">*</span> d_ss2</span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a>    },</span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a>    vl</span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a>  ))</span></code></pre></div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="mass-property-uncertainties">Mass Property Uncertainties<a class="anchor" aria-label="anchor" href="#mass-property-uncertainties"></a>
</h3>
<div class="section level4">
<h4 id="mass-uncertainty">Mass Uncertainty<a class="anchor" aria-label="anchor" href="#mass-uncertainty"></a>
</h4>
<p>The mass uncertainty equation is suitable as is.</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><menclose notation="box"><mrow><msub><mi>σ</mi><mi>w</mi></msub><mo>=</mo><msqrt><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msup><msub><msub><mi>σ</mi><mi>w</mi></msub><mi>i</mi></msub><mn>2</mn></msup></mrow></msqrt></mrow></menclose><annotation encoding="application/x-tex">
\boxed{
\sigma_w = \sqrt{ \sum_{i=1}^n {{\sigma_w}_i}^2 }
}
</annotation></semantics></math></p>
<p>The corresponding <code>R</code> code is</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">r</span><span class="op">$</span><span class="va">sigma_mass</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Reduce</a></span><span class="op">(</span><span class="va">`+`</span>, <span class="fu"><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Map</a></span><span class="op">(</span>f <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">v</span><span class="op">)</span> <span class="va">v</span><span class="op">$</span><span class="va">sigma_mass</span><span class="op">^</span><span class="fl">2</span>, <span class="va">vl</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="center-of-mass-uncertainty">Center of Mass Uncertainty<a class="anchor" aria-label="anchor" href="#center-of-mass-uncertainty"></a>
</h4>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>σ</mi><mi>x</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msqrt><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo minsize="1.2" maxsize="1.2" stretchy="false" form="prefix">{</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>w</mi><mi>i</mi></msub><msub><msub><mi>σ</mi><mi>x</mi></msub><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>+</mo><msup><mrow><mo stretchy="true" form="prefix">[</mo><msub><msub><mi>σ</mi><mi>w</mi></msub><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow><mn>2</mn></msup><mo minsize="1.2" maxsize="1.2" stretchy="false" form="postfix">}</mo></mrow></msqrt><mi minsize="2.4" maxsize="2.4">/</mi><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>w</mi><mi>i</mi></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>σ</mi><mi>y</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msqrt><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo minsize="1.2" maxsize="1.2" stretchy="false" form="prefix">{</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>w</mi><mi>i</mi></msub><msub><msub><mi>σ</mi><mi>y</mi></msub><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>+</mo><msup><mrow><mo stretchy="true" form="prefix">[</mo><msub><msub><mi>σ</mi><mi>w</mi></msub><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow><mn>2</mn></msup><mo minsize="1.2" maxsize="1.2" stretchy="false" form="postfix">}</mo></mrow></msqrt><mi minsize="2.4" maxsize="2.4">/</mi><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>w</mi><mi>i</mi></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>σ</mi><mi>z</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msqrt><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo minsize="1.2" maxsize="1.2" stretchy="false" form="prefix">{</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>w</mi><mi>i</mi></msub><msub><msub><mi>σ</mi><mi>z</mi></msub><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>+</mo><msup><mrow><mo stretchy="true" form="prefix">[</mo><msub><msub><mi>σ</mi><mi>w</mi></msub><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow><mn>2</mn></msup><mo minsize="1.2" maxsize="1.2" stretchy="false" form="postfix">}</mo></mrow></msqrt><mi minsize="2.4" maxsize="2.4">/</mi><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>w</mi><mi>i</mi></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{align}
\sigma_x &amp; = 
  \sqrt{ \sum_{i=1}^n \big\{ (w_i {{\sigma_x}}_i)^2 + [{\sigma_w}_i ({x}_i - \bar{x})]^2 \big\}}
 \bigg/ \sum_{i=1}^{n}w_i\\
\sigma_y &amp; = 
  \sqrt{ \sum_{i=1}^n \big\{ (w_i {{\sigma_y}}_i)^2 + [{\sigma_w}_i ({y}_i - \bar{y})]^2 \big\}}
 \bigg/ \sum_{i=1}^{n}w_i\\
\sigma_z &amp; = 
  \sqrt{ \sum_{i=1}^n \big\{ (w_i {{\sigma_z}}_i)^2 + [{\sigma_w}_i ({z}_i - \bar{z})]^2 \big\}}
 \bigg/ \sum_{i=1}^{n}w_i\\
\end{align}
</annotation></semantics></math></p>
<p>As before, we create a 3-vector for center of mass uncertainties.
Let</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><menclose notation="box"><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>𝛔</mi><mi>𝐜</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>σ</mi><mi>x</mi></msub><mspace width="1.0em"></mspace><msub><mi>σ</mi><mi>y</mi></msub><mspace width="1.0em"></mspace><msub><mi>σ</mi><mi>z</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>T</mi></msup></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><msub><mi>𝛔</mi><mi>𝐜</mi></msub><mi>i</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><msub><mi>σ</mi><mi>x</mi></msub><mi>i</mi></msub><mspace width="1.0em"></mspace><msub><msub><mi>σ</mi><mi>y</mi></msub><mi>i</mi></msub><mspace width="1.0em"></mspace><msub><msub><mi>σ</mi><mi>z</mi></msub><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>T</mi></msup></mtd></mtr></mtable></menclose><annotation encoding="application/x-tex">
\boxed{
\begin{align}
\boldsymbol{\sigma_c} &amp; = (\sigma_x \quad \sigma_y \quad \sigma_z)^T \\
{\boldsymbol{\sigma_c}}_i &amp; = ({\sigma_x}_i \quad {\sigma_y}_i \quad {\sigma_z}_i)^T
\end{align}
}
</annotation></semantics></math></p>
<p>If we construe (as <code>R</code> does) squaring and taking square
roots of vectors element-wise, then</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><menclose notation="box"><mrow><msub><mi>𝛔</mi><mi>𝐜</mi></msub><mo>=</mo><mfrac><mn>1</mn><mi>w</mi></mfrac><msqrt><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo minsize="1.2" maxsize="1.2" stretchy="false" form="prefix">{</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>w</mi><mi>i</mi></msub><msub><msub><mi>𝛔</mi><mi>𝐜</mi></msub><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>+</mo><msup><mrow><mo stretchy="true" form="prefix">[</mo><msub><msub><mi>σ</mi><mi>w</mi></msub><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>𝐜</mi><mi>i</mi></msub><mo>−</mo><mover><mi>𝐜</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow><mn>2</mn></msup><mo minsize="1.2" maxsize="1.2" stretchy="false" form="postfix">}</mo></mrow></msqrt></mrow></menclose><annotation encoding="application/x-tex">
\boxed{
\boldsymbol{\sigma_c} = \frac{1}{w} 
  \sqrt{ \sum_{i=1}^n \big\{ (w_i {{\boldsymbol{\sigma_c}}}_i)^2 + [{\sigma_w}_i ({\boldsymbol{c}}_i - \bar{\boldsymbol{c}})]^2 \big\}}

}
</annotation></semantics></math></p>
<p>The corresponding <code>R</code> code is</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">r</span><span class="op">$</span><span class="va">sigma_center_mass</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Reduce</a></span><span class="op">(</span><span class="va">`+`</span>, <span class="fu"><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Map</a></span><span class="op">(</span></span>
<span>    f <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">v</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="op">(</span><span class="va">v</span><span class="op">$</span><span class="va">mass</span> <span class="op">*</span> <span class="va">v</span><span class="op">$</span><span class="va">sigma_center_mass</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span></span>
<span>        <span class="op">(</span><span class="va">v</span><span class="op">$</span><span class="va">sigma_mass</span> <span class="op">*</span> <span class="op">(</span><span class="va">v</span><span class="op">$</span><span class="va">center_mass</span> <span class="op">-</span> <span class="va">r</span><span class="op">$</span><span class="va">center_mass</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span></span>
<span>    <span class="op">}</span>,</span>
<span>    <span class="va">vl</span></span>
<span>  <span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="va">r</span><span class="op">$</span><span class="va">mass</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="inertia-tensor-uncertainty">Inertia Tensor Uncertainty<a class="anchor" aria-label="anchor" href="#inertia-tensor-uncertainty"></a>
</h4>
<div class="section level5">
<h5 id="moments-of-inertia-uncertainties">Moments of Inertia Uncertainties<a class="anchor" aria-label="anchor" href="#moments-of-inertia-uncertainties"></a>
</h5>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>σ</mi><msub><mi>I</mi><mrow><mi>X</mi><mi>X</mi></mrow></msub></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msqrt><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo minsize="1.2" maxsize="1.2" stretchy="false" form="prefix">{</mo><msubsup><mi>σ</mi><msub><msub><mi>I</mi><mrow><mi>X</mi><mi>X</mi></mrow></msub><mi>i</mi></msub><mn>2</mn></msubsup><mo>+</mo><mo minsize="1.2" maxsize="1.2" stretchy="false" form="prefix">[</mo><mn>2</mn><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>y</mi><mi>i</mi></msub></msub><msup><mo minsize="1.2" maxsize="1.2" stretchy="false" form="postfix">]</mo><mn>2</mn></msup><mo>+</mo><mo minsize="1.2" maxsize="1.2" stretchy="false" form="prefix">[</mo><mn>2</mn><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>z</mi><mi>i</mi></msub></msub><msup><mo minsize="1.2" maxsize="1.2" stretchy="false" form="postfix">]</mo><mn>2</mn></msup><mo>+</mo><mo minsize="1.2" maxsize="1.2" stretchy="false" form="prefix">[</mo><mo minsize="1.2" maxsize="1.2" stretchy="false" form="prefix">(</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>+</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo minsize="1.2" maxsize="1.2" stretchy="false" form="postfix">)</mo><msub><mi>σ</mi><msub><mi>w</mi><mi>i</mi></msub></msub><msup><mo minsize="1.2" maxsize="1.2" stretchy="false" form="postfix">]</mo><mn>2</mn></msup><mo minsize="1.2" maxsize="1.2" stretchy="false" form="postfix">}</mo></mrow></msqrt></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>σ</mi><msub><mi>I</mi><mrow><mi>Y</mi><mi>Y</mi></mrow></msub></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msqrt><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo minsize="1.2" maxsize="1.2" stretchy="false" form="prefix">{</mo><msubsup><mi>σ</mi><msub><msub><mi>I</mi><mrow><mi>Y</mi><mi>Y</mi></mrow></msub><mi>i</mi></msub><mn>2</mn></msubsup><mo>+</mo><mo minsize="1.2" maxsize="1.2" stretchy="false" form="prefix">[</mo><mn>2</mn><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>x</mi><mi>i</mi></msub></msub><msup><mo minsize="1.2" maxsize="1.2" stretchy="false" form="postfix">]</mo><mn>2</mn></msup><mo>+</mo><mo minsize="1.2" maxsize="1.2" stretchy="false" form="prefix">[</mo><mn>2</mn><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>z</mi><mi>i</mi></msub></msub><msup><mo minsize="1.2" maxsize="1.2" stretchy="false" form="postfix">]</mo><mn>2</mn></msup><mo>+</mo><mo minsize="1.2" maxsize="1.2" stretchy="false" form="prefix">[</mo><mo minsize="1.2" maxsize="1.2" stretchy="false" form="prefix">(</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>+</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo minsize="1.2" maxsize="1.2" stretchy="false" form="postfix">)</mo><msub><mi>σ</mi><msub><mi>w</mi><mi>i</mi></msub></msub><msup><mo minsize="1.2" maxsize="1.2" stretchy="false" form="postfix">]</mo><mn>2</mn></msup><mo minsize="1.2" maxsize="1.2" stretchy="false" form="postfix">}</mo></mrow></msqrt></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>σ</mi><msub><mi>I</mi><mrow><mi>Z</mi><mi>Z</mi></mrow></msub></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msqrt><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo minsize="1.2" maxsize="1.2" stretchy="false" form="prefix">{</mo><msubsup><mi>σ</mi><msub><msub><mi>I</mi><mrow><mi>Z</mi><mi>Z</mi></mrow></msub><mi>i</mi></msub><mn>2</mn></msubsup><mo>+</mo><mo minsize="1.2" maxsize="1.2" stretchy="false" form="prefix">[</mo><mn>2</mn><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>x</mi><mi>i</mi></msub></msub><msup><mo minsize="1.2" maxsize="1.2" stretchy="false" form="postfix">]</mo><mn>2</mn></msup><mo>+</mo><mo minsize="1.2" maxsize="1.2" stretchy="false" form="prefix">[</mo><mn>2</mn><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>y</mi><mi>i</mi></msub></msub><msup><mo minsize="1.2" maxsize="1.2" stretchy="false" form="postfix">]</mo><mn>2</mn></msup><mo>+</mo><mo minsize="1.2" maxsize="1.2" stretchy="false" form="prefix">[</mo><mo minsize="1.2" maxsize="1.2" stretchy="false" form="prefix">(</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>+</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo minsize="1.2" maxsize="1.2" stretchy="false" form="postfix">)</mo><msub><mi>σ</mi><msub><mi>w</mi><mi>i</mi></msub></msub><msup><mo minsize="1.2" maxsize="1.2" stretchy="false" form="postfix">]</mo><mn>2</mn></msup><mo minsize="1.2" maxsize="1.2" stretchy="false" form="postfix">}</mo></mrow></msqrt></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{align}
\sigma_{I_{XX}} &amp; = \sqrt{ \sum_{i=1}^n \big\{
  \sigma_{{I_{XX}}_i}^2 + \big[ 2 w_i ({y}_i - \bar{y}) \sigma_{{y}_i} \big]^2 + \big[ 2 w_i ({z}_i - \bar{z}) \sigma_{{z}_i} \big]^2 + \big[ \big(({y}_i - \bar{y})^2 + ({z}_i - \bar{z})^2 \big)\sigma_{w_i}\big]^2 \big\} }
 \\
\sigma_{I_{YY}} &amp; = \sqrt{ \sum_{i=1}^n \big\{
  \sigma_{{I_{YY}}_i}^2 + \big[ 2 w_i ({x}_i - \bar{x}) \sigma_{{x}_i} \big]^2 + \big[ 2 w_i ({z}_i - \bar{z}) \sigma_{{z}_i} \big]^2 + \big[ \big(({x}_i - \bar{x})^2 + ({z}_i - \bar{z})^2 \big)\sigma_{w_i}\big]^2 \big\} }
 \\
\sigma_{I_{ZZ}} &amp; = \sqrt{ \sum_{i=1}^n \big\{
  \sigma_{{I_{ZZ}}_i}^2 + \big[ 2 w_i ({x}_i - \bar{x}) \sigma_{{x}_i} \big]^2 + \big[ 2 w_i ({y}_i - \bar{y}) \sigma_{{y}_i} \big]^2 + \big[ \big(({x}_i - \bar{x})^2 + ({y}_i - \bar{y})^2 \big)\sigma_{w_i}\big]^2 \big\} }
 \\
\end{align}
</annotation></semantics></math></p>
</div>
<div class="section level5">
<h5 id="products-of-inertia-uncertainties">Products of Inertia Uncertainties<a class="anchor" aria-label="anchor" href="#products-of-inertia-uncertainties"></a>
</h5>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>σ</mi><msub><mi>I</mi><mrow><mi>X</mi><mi>Y</mi></mrow></msub></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msqrt><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo minsize="1.2" maxsize="1.2" stretchy="false" form="prefix">{</mo><msubsup><mi>σ</mi><msub><msub><mi>I</mi><mrow><mi>X</mi><mi>Y</mi></mrow></msub><mi>i</mi></msub><mn>2</mn></msubsup><mo>+</mo><mo minsize="1.2" maxsize="1.2" stretchy="false" form="prefix">[</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>w</mi><mi>i</mi></msub><msub><mi>σ</mi><msub><mi>y</mi><mi>i</mi></msub></msub><msup><mo minsize="1.2" maxsize="1.2" stretchy="false" form="postfix">]</mo><mn>2</mn></msup><mo>+</mo><mo minsize="1.2" maxsize="1.2" stretchy="false" form="prefix">[</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>w</mi><mi>i</mi></msub></msub><msup><mo minsize="1.2" maxsize="1.2" stretchy="false" form="postfix">]</mo><mn>2</mn></msup><mo>+</mo><mo minsize="1.2" maxsize="1.2" stretchy="false" form="prefix">[</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>w</mi><mi>i</mi></msub><msub><mi>σ</mi><msub><mi>x</mi><mi>i</mi></msub></msub><msup><mo minsize="1.2" maxsize="1.2" stretchy="false" form="postfix">]</mo><mn>2</mn></msup><mo minsize="1.2" maxsize="1.2" stretchy="false" form="postfix">}</mo></mrow></msqrt></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>σ</mi><msub><mi>I</mi><mrow><mi>X</mi><mi>Z</mi></mrow></msub></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msqrt><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo minsize="1.2" maxsize="1.2" stretchy="false" form="prefix">{</mo><msubsup><mi>σ</mi><msub><msub><mi>I</mi><mrow><mi>X</mi><mi>Z</mi></mrow></msub><mi>i</mi></msub><mn>2</mn></msubsup><mo>+</mo><mo minsize="1.2" maxsize="1.2" stretchy="false" form="prefix">[</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>w</mi><mi>i</mi></msub><msub><mi>σ</mi><msub><mi>z</mi><mi>i</mi></msub></msub><msup><mo minsize="1.2" maxsize="1.2" stretchy="false" form="postfix">]</mo><mn>2</mn></msup><mo>+</mo><mo minsize="1.2" maxsize="1.2" stretchy="false" form="prefix">[</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>w</mi><mi>i</mi></msub></msub><msup><mo minsize="1.2" maxsize="1.2" stretchy="false" form="postfix">]</mo><mn>2</mn></msup><mo>+</mo><mo minsize="1.2" maxsize="1.2" stretchy="false" form="prefix">[</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>w</mi><mi>i</mi></msub><msub><mi>σ</mi><msub><mi>x</mi><mi>i</mi></msub></msub><msup><mo minsize="1.2" maxsize="1.2" stretchy="false" form="postfix">]</mo><mn>2</mn></msup><mo minsize="1.2" maxsize="1.2" stretchy="false" form="postfix">}</mo></mrow></msqrt></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>σ</mi><msub><mi>I</mi><mrow><mi>Y</mi><mi>Z</mi></mrow></msub></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msqrt><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo minsize="1.2" maxsize="1.2" stretchy="false" form="prefix">{</mo><msubsup><mi>σ</mi><msub><msub><mi>I</mi><mrow><mi>Y</mi><mi>Z</mi></mrow></msub><mi>i</mi></msub><mn>2</mn></msubsup><mo>+</mo><mo minsize="1.2" maxsize="1.2" stretchy="false" form="prefix">[</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>w</mi><mi>i</mi></msub><msub><mi>σ</mi><msub><mi>z</mi><mi>i</mi></msub></msub><msup><mo minsize="1.2" maxsize="1.2" stretchy="false" form="postfix">]</mo><mn>2</mn></msup><mo>+</mo><mo minsize="1.2" maxsize="1.2" stretchy="false" form="prefix">[</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>w</mi><mi>i</mi></msub></msub><msup><mo minsize="1.2" maxsize="1.2" stretchy="false" form="postfix">]</mo><mn>2</mn></msup><mo>+</mo><mo minsize="1.2" maxsize="1.2" stretchy="false" form="prefix">[</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>w</mi><mi>i</mi></msub><msub><mi>σ</mi><msub><mi>y</mi><mi>i</mi></msub></msub><msup><mo minsize="1.2" maxsize="1.2" stretchy="false" form="postfix">]</mo><mn>2</mn></msup><mo minsize="1.2" maxsize="1.2" stretchy="false" form="postfix">}</mo></mrow></msqrt></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{align}
\sigma_{I_{XY}} &amp; = \sqrt{ \sum_{i=1}^n \big\{
  \sigma_{{I_{XY}}_i}^2 + \big[ ({x}_i - \bar{x}) w_i \sigma_{{y}_i}\big]^2 + \big[  ({x}_i - \bar{x})({y}_i - \bar{y})\sigma_{w_i} \big]^2 + \big[ ({y}_i - \bar{y})  w_i \sigma_{{x}_i} \big]^2 \big\} }
 \\
\sigma_{I_{XZ}} &amp; = \sqrt{ \sum_{i=1}^n \big\{
  \sigma_{{I_{XZ}}_i}^2 + \big[ ({x}_i - \bar{x}) w_i \sigma_{{z}_i}\big]^2 + \big[  ({x}_i - \bar{x})({z}_i - \bar{z})\sigma_{w_i} \big]^2 + \big[ ({z}_i - \bar{z})  w_i \sigma_{{x}_i} \big]^2 \big\} }
 \\
\sigma_{I_{YZ}} &amp; = \sqrt{ \sum_{i=1}^n \big\{
  \sigma_{{I_{YZ}}_i}^2 + \big[ ({y}_i - \bar{y}) w_i \sigma_{{z}_i}\big]^2 + \big[  ({y}_i - \bar{y})({z}_i - \bar{z})\sigma_{w_i} \big]^2 + \big[ ({z}_i - \bar{z})  w_i \sigma_{{y}_i} \big]^2 \big\} }
 \\
\end{align}
</annotation></semantics></math></p>
</div>
<div class="section level5">
<h5 id="matrix-formulation-1">Matrix Formulation<a class="anchor" aria-label="anchor" href="#matrix-formulation-1"></a>
</h5>
<p>Let</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><menclose notation="box"><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>𝐝</mi><mi>i</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="1.0em"></mspace><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="1.0em"></mspace><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mi>T</mi></msup></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><msub><mi>𝛔</mi><mi>𝐜</mi></msub><mi>i</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><msub><mi>σ</mi><mi>x</mi></msub><mi>i</mi></msub><mspace width="1.0em"></mspace><msub><msub><mi>σ</mi><mi>y</mi></msub><mi>i</mi></msub><mspace width="1.0em"></mspace><msub><msub><mi>σ</mi><mi>z</mi></msub><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>T</mi></msup></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>𝐏</mi><mi>i</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msub><mi>𝐝</mi><mi>i</mi></msub><msubsup><msub><mi>𝛔</mi><mi>𝐜</mi></msub><mi>i</mi><mi>T</mi></msubsup></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>𝐐</mi><mi>i</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msub><mi>𝐝</mi><mi>i</mi></msub><msup><msub><mi>𝐝</mi><mi>i</mi></msub><mi>T</mi></msup></mtd></mtr></mtable></menclose><annotation encoding="application/x-tex">
\boxed{
\begin{align}
\boldsymbol{d}_i &amp; = (({x}_i - \bar{x}) \quad ({y}_i - \bar{y}) \quad ({z}_i - \bar{z}))^T \\
{\boldsymbol{\sigma_c}}_i &amp; = ({\sigma_x}_i \quad {\sigma_y}_i \quad {\sigma_z}_i)^T \\
\boldsymbol{P}_i &amp; = \boldsymbol{d}_i {\boldsymbol{\sigma_c}}_i^T \\
\boldsymbol{Q}_i &amp; = \boldsymbol{d}_i {\boldsymbol{d}_i}^T
\end{align}
}
</annotation></semantics></math></p>
<p>Then</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>𝐏</mi><mi>i</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mrow><mo stretchy="true" form="prefix">[</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>x</mi><mi>i</mi></msub></msub></mtd><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>y</mi><mi>i</mi></msub></msub></mtd><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>z</mi><mi>i</mi></msub></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>x</mi><mi>i</mi></msub></msub></mtd><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>y</mi><mi>i</mi></msub></msub></mtd><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>z</mi><mi>i</mi></msub></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>x</mi><mi>i</mi></msub></msub></mtd><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>y</mi><mi>i</mi></msub></msub></mtd><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>z</mi><mi>i</mi></msub></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><mo stretchy="true" form="postfix">]</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>𝐐</mi><mi>i</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mrow><mo stretchy="true" form="prefix">[</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mtd><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="center" style="text-align: center"><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mtd><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="center" style="text-align: center"><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><mo stretchy="true" form="postfix">]</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{align}
\boldsymbol{P}_i &amp; = 
\begin{bmatrix}
(x_i - \bar{x})\sigma_{x_i} &amp;({x}_i - \bar{x})\sigma_{y_i} &amp;({x}_i - \bar{x})\sigma_{z_i} \\
({y}_i - \bar{y})\sigma_{x_i} &amp; ({y}_i - \bar{y})\sigma_{y_i} &amp; ({y}_i - \bar{y})\sigma_{z_i} \\
({z}_i - \bar{z})\sigma_{x_i} &amp; ({z}_i - \bar{z})\sigma_{y_i} &amp; ({z}_i - \bar{z})\sigma_{z_i} \\
\end{bmatrix}
\\
\\
\boldsymbol{Q}_i &amp; =
\begin{bmatrix}
(x_i - \bar{x})^2 &amp;({x}_i - \bar{x})({y}_i - \bar{y}) &amp;({x}_i - \bar{x})({z}_i - \bar{z}) \\
({y}_i - \bar{y})(x_i - \bar{x}) &amp; ({y}_i - \bar{y})^2 &amp; ({y}_i - \bar{y})({z}_i - \bar{z}) \\
({z}_i - \bar{z})(x_i - \bar{x}) &amp; ({z}_i - \bar{z})({y}_i - \bar{y}) &amp; ({z}_i - \bar{z})^2 \\
\end{bmatrix}
\end{align}
</annotation></semantics></math></p>
<p>Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>𝐬</mi><mi>i</mi><mn>2</mn></msubsup><annotation encoding="application/x-tex">\boldsymbol{s}_i^2</annotation></semantics></math>
be the matrix of inertia tensor uncertainty summands in the standard
formulas for a given subcomponent
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
above. That is,</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><msub><mi>𝛔</mi><mi>𝐈</mi></msub><mn>2</mn></msup><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow></mrow></munderover><msubsup><mi>𝐬</mi><mi>i</mi><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">
\boldsymbol{\sigma_I}^2 = \sum_{i=1}^{} \boldsymbol{s}_i^2
</annotation></semantics></math></p>
<p>Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><msub><mi>p</mi><mi>X</mi></msub><mi>i</mi></msub><annotation encoding="application/x-tex">{p_X}_i</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><msub><mi>p</mi><mi>Y</mi></msub><mi>i</mi></msub><annotation encoding="application/x-tex">{p_Y}_i</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><msub><mi>p</mi><mi>Z</mi></msub><mi>i</mi></msub><annotation encoding="application/x-tex">{p_Z}_i</annotation></semantics></math>
be the respective diagonal elements of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>P</mi><mi>i</mi></msub><annotation encoding="application/x-tex">P_i</annotation></semantics></math>.
If we interpret squaring a matrix as the Hadamard (element-wise) product
with itself, then
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msubsup><mi>𝐬</mi><mi>i</mi><mn>2</mn></msubsup></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msubsup><msub><mi>𝛔</mi><mi>𝐈</mi></msub><mi>i</mi><mn>2</mn></msubsup></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>+</mo><msup><mrow><mo stretchy="true" form="prefix">[</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mn>2</mn><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>y</mi><mi>i</mi></msub></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>y</mi><mi>i</mi></msub></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>z</mi><mi>i</mi></msub></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>y</mi><mi>i</mi></msub></msub></mtd><mtd columnalign="center" style="text-align: center"><mn>2</mn><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>x</mi><mi>i</mi></msub></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>z</mi><mi>i</mi></msub></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>z</mi><mi>i</mi></msub></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>z</mi><mi>i</mi></msub></msub></mtd><mtd columnalign="center" style="text-align: center"><mn>2</mn><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>x</mi><mi>i</mi></msub></msub></mtd></mtr></mtable><mo stretchy="true" form="postfix">]</mo></mrow><mn>2</mn></msup></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>+</mo><msup><mrow><mo stretchy="true" form="prefix">[</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mn>2</mn><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>z</mi><mi>i</mi></msub></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>x</mi><mi>i</mi></msub></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>x</mi><mi>i</mi></msub></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>x</mi><mi>i</mi></msub></msub></mtd><mtd columnalign="center" style="text-align: center"><mn>2</mn><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>z</mi><mi>i</mi></msub></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>y</mi><mi>i</mi></msub></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>x</mi><mi>i</mi></msub></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>y</mi><mi>i</mi></msub></msub></mtd><mtd columnalign="center" style="text-align: center"><mn>2</mn><msub><mi>w</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>y</mi><mi>i</mi></msub></msub></mtd></mtr></mtable><mo stretchy="true" form="postfix">]</mo></mrow><mn>2</mn></msup></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>+</mo><msup><mrow><mo stretchy="true" form="prefix">[</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>+</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>w</mi><mi>i</mi></msub></msub></mtd><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>w</mi><mi>i</mi></msub></msub></mtd><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>w</mi><mi>i</mi></msub></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>w</mi><mi>i</mi></msub></msub></mtd><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>+</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>w</mi><mi>i</mi></msub></msub></mtd><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>w</mi><mi>i</mi></msub></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>w</mi><mi>i</mi></msub></msub></mtd><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>w</mi><mi>i</mi></msub></msub></mtd><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>+</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>w</mi><mi>i</mi></msub></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><mo stretchy="true" form="postfix">]</mo></mrow><mn>2</mn></msup></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msubsup><msub><mi>𝛔</mi><mi>𝐈</mi></msub><mi>i</mi><mn>2</mn></msubsup></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>+</mo><msubsup><mi>w</mi><mi>i</mi><mn>2</mn></msubsup><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>𝐏</mi><mi>i</mi></msub><mo>−</mo><mrow><mo stretchy="true" form="prefix">[</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>x</mi><mi>i</mi></msub></msub><mo>−</mo><mn>2</mn><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>y</mi><mi>i</mi></msub></msub></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>y</mi><mi>i</mi></msub></msub><mo>−</mo><mn>2</mn><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>x</mi><mi>i</mi></msub></msub></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>y</mi><mi>i</mi></msub></msub><mo>−</mo><mn>2</mn><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>x</mi><mi>i</mi></msub></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><mo stretchy="true" form="postfix">]</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>+</mo><msubsup><mi>w</mi><mi>i</mi><mn>2</mn></msubsup><msup><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>𝐏</mi><mi>i</mi><mi>T</mi></msubsup><mo>−</mo><mrow><mo stretchy="true" form="prefix">[</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>x</mi><mi>i</mi></msub></msub><mo>−</mo><mn>2</mn><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>y</mi><mi>i</mi></msub></msub></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>y</mi><mi>i</mi></msub></msub><mo>−</mo><mn>2</mn><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>z</mi><mi>i</mi></msub></msub></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mover><mi>z</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>y</mi><mi>i</mi></msub></msub><mo>−</mo><mn>2</mn><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>σ</mi><msub><mi>y</mi><mi>i</mi></msub></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><mo stretchy="true" form="postfix">]</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>+</mo><msubsup><mi>σ</mi><msub><mi>w</mi><mi>i</mi></msub><mn>2</mn></msubsup><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>𝐐</mi><mi>i</mi></msub><mo>−</mo><mrow><mi mathvariant="normal">t</mi><mi mathvariant="normal">r</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>𝐐</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>𝐈</mi><mn>3</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msubsup><msub><mi>𝛔</mi><mi>𝐈</mi></msub><mi>i</mi><mn>2</mn></msubsup></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>+</mo><msubsup><mi>w</mi><mi>i</mi><mn>2</mn></msubsup><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>𝐏</mi><mi>i</mi></msub><mo>−</mo><mrow><mo stretchy="true" form="prefix">[</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><msub><mi>p</mi><mi>X</mi></msub><mi>i</mi></msub><mo>−</mo><mn>2</mn><msub><msub><mi>p</mi><mi>Y</mi></msub><mi>i</mi></msub></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><msub><msub><mi>p</mi><mi>Y</mi></msub><mi>i</mi></msub><mo>−</mo><mn>2</mn><msub><msub><mi>p</mi><mi>X</mi></msub><mi>i</mi></msub></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><msub><msub><mi>p</mi><mi>Z</mi></msub><mi>i</mi></msub><mo>−</mo><mn>2</mn><msub><msub><mi>p</mi><mi>X</mi></msub><mi>i</mi></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><mo stretchy="true" form="postfix">]</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>+</mo><msubsup><mi>w</mi><mi>i</mi><mn>2</mn></msubsup><msup><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>𝐏</mi><mi>i</mi><mi>T</mi></msubsup><mo>−</mo><mrow><mo stretchy="true" form="prefix">[</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><msub><mi>p</mi><mi>X</mi></msub><mi>i</mi></msub><mo>−</mo><mn>2</mn><msub><msub><mi>p</mi><mi>Z</mi></msub><mi>i</mi></msub></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><msub><msub><mi>p</mi><mi>Y</mi></msub><mi>i</mi></msub><mo>−</mo><mn>2</mn><msub><msub><mi>p</mi><mi>Z</mi></msub><mi>i</mi></msub></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><msub><msub><mi>p</mi><mi>Z</mi></msub><mi>i</mi></msub><mo>−</mo><mn>2</mn><msub><msub><mi>p</mi><mi>Y</mi></msub><mi>i</mi></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><mo stretchy="true" form="postfix">]</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>+</mo><msubsup><mi>σ</mi><msub><mi>w</mi><mi>i</mi></msub><mn>2</mn></msubsup><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>𝐐</mi><mi>i</mi></msub><mo>−</mo><mrow><mi mathvariant="normal">t</mi><mi mathvariant="normal">r</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>𝐐</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>𝐈</mi><mn>3</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{align}
\boldsymbol{s}_i^2 &amp; = {\boldsymbol{\sigma_I}}_i^2 \\
&amp; + 
\begin{bmatrix}
2 w_i ({y}_i - \bar{y}) \sigma_{y_i} &amp;   w_i({x}_i - \bar{x}) \sigma_{y_i} &amp;   w_i({x}_i - \bar{x}) \sigma_{z_i} \\
  w_i({x}_i - \bar{x}) \sigma_{y_i} &amp; 2 w_i({x}_i - \bar{x}) \sigma_{x_i} &amp;   w_i ({y}_i - \bar{y}) \sigma_{z_i} \\
  w_i({x}_i - \bar{x}) \sigma_{z_i} &amp;   w_i ({y}_i - \bar{y}) \sigma_{z_i} &amp; 2 w_i({x}_i - \bar{x}) \sigma_{x_i}
\end{bmatrix}^2 \\
&amp; +
\begin{bmatrix}
2 w_i ({z}_i - \bar{z}) \sigma_{z_i} &amp;   w_i ({y}_i - \bar{y}) \sigma_{x_i} &amp;   w_i ({z}_i - \bar{z}) \sigma_{x_i} \\
  w_i ({y}_i - \bar{y}) \sigma_{x_i} &amp; 2 w_i ({z}_i - \bar{z}) \sigma_{z_i} &amp;   w_i ({z}_i - \bar{z}) \sigma_{y_i} \\
  w_i ({z}_i - \bar{z}) \sigma_{x_i} &amp;   w_i ({z}_i - \bar{z}) \sigma_{y_i} &amp; 2 w_i ({y}_i - \bar{y}) \sigma_{y_i}
\end{bmatrix}^2 \\
&amp; +
\begin{bmatrix}
(({y}_i - \bar{y})^2 + ({z}_i - \bar{z})^2)\sigma_{w_i} &amp;({x}_i - \bar{x})({y}_i - \bar{y})\sigma_{w_i} &amp;({x}_i - \bar{x})({z}_i - \bar{z})\sigma_{w_i} \\
({y}_i - \bar{y})(x_i - \bar{x})\sigma_{w_i} &amp; ((x_i - \bar{x})^2 + ({z}_i - \bar{z})^2)\sigma_{w_i} &amp; ({y}_i - \bar{y})({z}_i - \bar{z})\sigma_{w_i} \\
({z}_i - \bar{z})(x_i - \bar{x})\sigma_{w_i} &amp; ({z}_i - \bar{z})({y}_i - \bar{y})\sigma_{w_i} &amp; ((x_i - \bar{x})^2 + ({y}_i - \bar{y})^2)\sigma_{w_i} \\
\end{bmatrix}^2 \\ \\
&amp; = {\boldsymbol{\sigma_I}}_i^2 \\
&amp; + w_i^2 \left(
\boldsymbol{P}_i -
\begin{bmatrix}
(x_i - \bar{x})\sigma_{x_i} - 2 ({y}_i - \bar{y})\sigma_{y_i} &amp; 0 &amp; 0 \\
0 &amp; ({y}_i - \bar{y})\sigma_{y_i} - 2({x}_i - \bar{x})\sigma_{x_i} &amp; 0 \\
0 &amp; 0 &amp; ({z}_i - \bar{z})\sigma_{y_i} - 2({x}_i - \bar{x})\sigma_{x_i} \\
\end{bmatrix}
\right) ^2 \\
&amp; + w_i^2 \left(
\boldsymbol{P}_i^T -
\begin{bmatrix}
(x_i - \bar{x})\sigma_{x_i} - 2 ({z}_i - \bar{z})\sigma_{y_i} &amp; 0 &amp; 0 \\
0 &amp; ({y}_i - \bar{y})\sigma_{y_i} - 2 ({z}_i - \bar{z})\sigma_{z_i} &amp; 0 \\
0 &amp; 0 &amp; ({z}_i - \bar{z})\sigma_{y_i} - 2 ({y}_i - \bar{y})\sigma_{y_i} \\
\end{bmatrix}
\right) ^2 \\
&amp; + \sigma_{w_i}^2 \left(
\boldsymbol{Q}_i - \mathrm{tr}(\boldsymbol{Q}_i)\boldsymbol{I}_3
\right)^2 \\ \\
&amp; = {\boldsymbol{\sigma_I}}_i^2 \\
&amp; + w_i^2 \left(
\boldsymbol{P}_i -
\begin{bmatrix}
 {p_X}_i - 2 {p_Y}_i &amp; 0 &amp; 0 \\
0 &amp; {p_Y}_i - 2 {p_X}_i &amp; 0 \\
0 &amp; 0 &amp; {p_Z}_i - 2  {p_X}_i \\
\end{bmatrix}
\right) ^2 \\
&amp; + w_i^2 \left(
\boldsymbol{P}_i^T -
\begin{bmatrix}
 {p_X}_i - 2{p_Z}_i &amp; 0 &amp; 0 \\
0 &amp; {p_Y}_i - 2 {p_Z}_i &amp; 0 \\
0 &amp; 0 &amp; {p_Z}_i - 2 {p_Y}_i \\
\end{bmatrix}
\right) ^2 \\
&amp; + \sigma_{w_i}^2 \left(
\boldsymbol{Q}_i - \mathrm{tr}(\boldsymbol{Q}_i)\boldsymbol{I}_3
\right)^2
\end{align}
</annotation></semantics></math></p>
<p>Finally,</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><menclose notation="box"><mrow><msub><mi>𝛔</mi><mi>𝐈</mi></msub><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><mo stretchy="true" form="prefix">{</mo><mtable><mtr><mtd columnalign="right" style="text-align: right"><msubsup><msub><mi>𝛔</mi><mi>𝐈</mi></msub><mi>i</mi><mn>2</mn></msubsup></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>+</mo><msubsup><mi>w</mi><mi>i</mi><mn>2</mn></msubsup><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>𝐏</mi><mi>i</mi></msub><mo>−</mo><mrow><mo stretchy="true" form="prefix">[</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><msub><mi>p</mi><mi>X</mi></msub><mi>i</mi></msub><mo>−</mo><mn>2</mn><msub><msub><mi>p</mi><mi>Y</mi></msub><mi>i</mi></msub></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><msub><msub><mi>p</mi><mi>Y</mi></msub><mi>i</mi></msub><mo>−</mo><mn>2</mn><msub><msub><mi>p</mi><mi>X</mi></msub><mi>i</mi></msub></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><msub><msub><mi>p</mi><mi>Z</mi></msub><mi>i</mi></msub><mo>−</mo><mn>2</mn><msub><msub><mi>p</mi><mi>X</mi></msub><mi>i</mi></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><mo stretchy="true" form="postfix">]</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>+</mo><msubsup><mi>w</mi><mi>i</mi><mn>2</mn></msubsup><msup><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>𝐏</mi><mi>i</mi><mi>T</mi></msubsup><mo>−</mo><mrow><mo stretchy="true" form="prefix">[</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><msub><mi>p</mi><mi>X</mi></msub><mi>i</mi></msub><mo>−</mo><mn>2</mn><msub><msub><mi>p</mi><mi>Z</mi></msub><mi>i</mi></msub></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><msub><msub><mi>p</mi><mi>Y</mi></msub><mi>i</mi></msub><mo>−</mo><mn>2</mn><msub><msub><mi>p</mi><mi>Z</mi></msub><mi>i</mi></msub></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><msub><msub><mi>p</mi><mi>Z</mi></msub><mi>i</mi></msub><mo>−</mo><mn>2</mn><msub><msub><mi>p</mi><mi>Y</mi></msub><mi>i</mi></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><mo stretchy="true" form="postfix">]</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>+</mo><msubsup><mi>σ</mi><msub><mi>w</mi><mi>i</mi></msub><mn>2</mn></msubsup><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>𝐐</mi><mi>i</mi></msub><mo>−</mo><mrow><mi mathvariant="normal">t</mi><mi mathvariant="normal">r</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>𝐐</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>𝐈</mi><mn>3</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mtd></mtr></mtable><mo stretchy="true" form="postfix">}</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mfrac><mn>1</mn><mn>2</mn></mfrac></msup></mrow></menclose><annotation encoding="application/x-tex">
\boxed{
\boldsymbol{\sigma_I} = \left(
\sum_{i=1}^{n} {\left\{
\begin{align}
{\boldsymbol{\sigma_I}}_i^2 \\
&amp; + w_i^2 \left(
\boldsymbol{P}_i -
\begin{bmatrix}
{p_X}_i - 2 {p_Y}_i &amp; 0 &amp; 0 \\
0 &amp; {p_Y}_i - 2 {p_X}_i &amp; 0 \\
0 &amp; 0 &amp; {p_Z}_i - 2  {p_X}_i \\
\end{bmatrix}
\right) ^2 \\
&amp; + w_i^2 \left(
\boldsymbol{P}_i^T -
\begin{bmatrix}
 {p_X}_i - 2{p_Z}_i &amp; 0 &amp; 0 \\
0 &amp; {p_Y}_i - 2 {p_Z}_i &amp; 0 \\
0 &amp; 0 &amp; {p_Z}_i - 2 {p_Y}_i \\
\end{bmatrix}
\right) ^2 \\
&amp; + \sigma_{w_i}^2 \left(
\boldsymbol{Q}_i - \mathrm{tr}(\boldsymbol{Q}_i)\boldsymbol{I}_3
\right)^2
\end{align}
\right\}}
\right)^\frac{1}{2}
}
</annotation></semantics></math></p>
<p>The corresponding <code>R</code> code is</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">r</span><span class="op">$</span><span class="va">sigma_inertia</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Reduce</a></span><span class="op">(</span><span class="va">`+`</span>, <span class="fu"><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Map</a></span><span class="op">(</span></span>
<span>    f <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">v</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span>      <span class="va">d</span> <span class="op">&lt;-</span> <span class="va">r</span><span class="op">$</span><span class="va">center_mass</span> <span class="op">-</span> <span class="va">v</span><span class="op">$</span><span class="va">center_mass</span></span>
<span></span>
<span>      <span class="va">P</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/outer.html" class="external-link">outer</a></span><span class="op">(</span><span class="va">d</span>, <span class="va">v</span><span class="op">$</span><span class="va">sigma_center_mass</span><span class="op">)</span></span>
<span>      <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">P</span><span class="op">)</span></span>
<span>      <span class="va">diag_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">p</span><span class="op">[</span><span class="st">'x'</span><span class="op">]</span> <span class="op">-</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">p</span><span class="op">[</span><span class="st">'y'</span><span class="op">]</span>, <span class="va">p</span><span class="op">[</span><span class="st">'y'</span><span class="op">]</span> <span class="op">-</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">p</span><span class="op">[</span><span class="st">'x'</span><span class="op">]</span>, <span class="va">p</span><span class="op">[</span><span class="st">'z'</span><span class="op">]</span> <span class="op">-</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">p</span><span class="op">[</span><span class="st">'x'</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="va">diag_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">p</span><span class="op">[</span><span class="st">'x'</span><span class="op">]</span> <span class="op">-</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">p</span><span class="op">[</span><span class="st">'z'</span><span class="op">]</span>, <span class="va">p</span><span class="op">[</span><span class="st">'y'</span><span class="op">]</span> <span class="op">-</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">p</span><span class="op">[</span><span class="st">'z'</span><span class="op">]</span>, <span class="va">p</span><span class="op">[</span><span class="st">'z'</span><span class="op">]</span> <span class="op">-</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">p</span><span class="op">[</span><span class="st">'y'</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>      <span class="va">Q</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/outer.html" class="external-link">outer</a></span><span class="op">(</span><span class="va">d</span>, <span class="va">d</span><span class="op">)</span></span>
<span>      <span class="va">diag_3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">Q</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span>      <span class="va">v</span><span class="op">$</span><span class="va">sigma_inertia</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span></span>
<span>        <span class="va">v</span><span class="op">$</span><span class="va">mass</span><span class="op">^</span><span class="fl">2</span> <span class="op">*</span> <span class="op">(</span><span class="op">(</span><span class="va">P</span> <span class="op">-</span> <span class="va">diag_1</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">P</span><span class="op">)</span> <span class="op">-</span> <span class="va">diag_2</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="op">(</span><span class="va">v</span><span class="op">$</span><span class="va">sigma_mass</span> <span class="op">*</span> <span class="op">(</span><span class="va">Q</span> <span class="op">-</span> <span class="va">diag_3</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span></span>
<span>    <span class="op">}</span>,</span>
<span>    <span class="va">vl</span></span>
<span>  <span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="testing-and-validation">Testing and Validation<a class="anchor" aria-label="anchor" href="#testing-and-validation"></a>
</h2>
<p>In this section we will calculate the answers for the SAWE step by
step and compare them with the package results. The inputs are:</p>
<pre><code><span><span class="co">#&gt;         id  mass    Cx    Cy    Cz     Ixx     Iyy      Izz    Ixy      Ixz</span></span>
<span><span class="co">#&gt; 1   Widget 57.83 121.2  0.04 -0.16 7258.90 8607.02 10453.40 834.44 -1198.38</span></span>
<span><span class="co">#&gt; 2 2nd Part 16.80  70.9 -0.95  0.46   65.07 1124.65  1078.82  76.01   202.83</span></span>
<span><span class="co">#&gt;        Iyz σ_mass   σ_Cx   σ_Cy   σ_Cz    σ_Ixx    σ_Iyy    σ_Izz     σ_Ixy</span></span>
<span><span class="co">#&gt; 1 -1066.58 1.2416 0.2764 0.2085 0.0669 386.9233 171.4792 414.5547 1440.5402</span></span>
<span><span class="co">#&gt; 2    13.62 1.7308 0.6234 0.5173 0.1405  12.4687 109.1324 108.5481   55.8879</span></span>
<span><span class="co">#&gt;      σ_Ixz    σ_Iyz Ipoint POIconv</span></span>
<span><span class="co">#&gt; 1 344.6237 124.6860  FALSE       +</span></span>
<span><span class="co">#&gt; 2 212.1241  11.5408  FALSE       +</span></span></code></pre>
<p>Our computed result is</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sawe_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rollup_mass_props_and_unc.html">rollup_mass_props_and_unc</a></span><span class="op">(</span><span class="va">sawe_tree</span>, <span class="va">sawe_table</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span>, <span class="op">]</span></span>
<span><span class="va">sawe_result</span></span>
<span><span class="co">#&gt;         id  mass       Cx         Cy          Cz      Ixx      Iyy      Izz</span></span>
<span><span class="co">#&gt; 3 Combined 74.63 109.8769 -0.1828594 -0.02043146 7341.733 42673.75 44482.05</span></span>
<span><span class="co">#&gt;        Ixy       Ixz       Iyz  σ_mass    σ_Cx      σ_Cy       σ_Cz    σ_Ixx</span></span>
<span><span class="co">#&gt; 3 1558.714 -1401.534 -1060.951 2.13008 0.95821 0.1999847 0.06178402 387.4017</span></span>
<span><span class="co">#&gt;      σ_Iyy    σ_Izz    σ_Ixy    σ_Ixz    σ_Iyz Ipoint POIconv</span></span>
<span><span class="co">#&gt; 3 2789.313 2815.326 1488.095 418.6048 125.3175  FALSE       +</span></span></code></pre></div>
<div class="section level3">
<h3 id="mass-1">Mass<a class="anchor" aria-label="anchor" href="#mass-1"></a>
</h3>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mass</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">sawe_input</span><span class="op">$</span><span class="va">mass</span><span class="op">)</span></span></code></pre></div>
<p>The independently-calculated mass is</p>
<pre><code><span><span class="co">#&gt; [1] 74.63</span></span></code></pre>
<p>This agrees with the computed result.</p>
</div>
<div class="section level3">
<h3 id="center-of-mass-1">Center of Mass<a class="anchor" aria-label="anchor" href="#center-of-mass-1"></a>
</h3>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">C</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">sawe_input</span><span class="op">$</span><span class="va">mass</span> <span class="op">/</span><span class="va">mass</span> <span class="op">*</span> <span class="va">sawe_input</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Cx"</span>, <span class="st">"Cy"</span>, <span class="st">"Cz"</span><span class="op">)</span><span class="op">]</span>, <span class="fl">2</span>, <span class="va">sum</span><span class="op">)</span></span></code></pre></div>
<p>The independently-calculated center of mass is</p>
<pre><code><span><span class="co">#&gt;           Cx           Cy           Cz </span></span>
<span><span class="co">#&gt; 109.87693957  -0.18285944  -0.02043146</span></span></code></pre>
<p>This agrees with the computed result.</p>
</div>
<div class="section level3">
<h3 id="moments-of-inertia-1">Moments of Inertia<a class="anchor" aria-label="anchor" href="#moments-of-inertia-1"></a>
</h3>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">moi</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">I</span>, <span class="va">v1</span>, <span class="va">v2</span>, <span class="va">m</span>, <span class="va">c1</span>, <span class="va">c2</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">I</span> <span class="op">+</span> <span class="va">m</span> <span class="op">*</span> <span class="op">(</span><span class="op">(</span><span class="va">v1</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="va">v2</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">-</span> <span class="op">(</span><span class="va">c1</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="va">c2</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">MOI</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  Ixx <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu">moi</span><span class="op">(</span><span class="va">sawe_input</span><span class="op">$</span><span class="va">Ixx</span>, <span class="va">sawe_input</span><span class="op">$</span><span class="va">Cy</span>, <span class="va">sawe_input</span><span class="op">$</span><span class="va">Cz</span>, <span class="va">sawe_input</span><span class="op">$</span><span class="va">mass</span>, <span class="va">C</span><span class="op">[</span><span class="st">"Cy"</span><span class="op">]</span>, <span class="va">C</span><span class="op">[</span><span class="st">"Cz"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  Iyy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu">moi</span><span class="op">(</span><span class="va">sawe_input</span><span class="op">$</span><span class="va">Iyy</span>, <span class="va">sawe_input</span><span class="op">$</span><span class="va">Cx</span>, <span class="va">sawe_input</span><span class="op">$</span><span class="va">Cz</span>, <span class="va">sawe_input</span><span class="op">$</span><span class="va">mass</span>, <span class="va">C</span><span class="op">[</span><span class="st">"Cx"</span><span class="op">]</span>, <span class="va">C</span><span class="op">[</span><span class="st">"Cz"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  Izz <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu">moi</span><span class="op">(</span><span class="va">sawe_input</span><span class="op">$</span><span class="va">Izz</span>, <span class="va">sawe_input</span><span class="op">$</span><span class="va">Cx</span>, <span class="va">sawe_input</span><span class="op">$</span><span class="va">Cy</span>, <span class="va">sawe_input</span><span class="op">$</span><span class="va">mass</span>, <span class="va">C</span><span class="op">[</span><span class="st">"Cx"</span><span class="op">]</span>, <span class="va">C</span><span class="op">[</span><span class="st">"Cy"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The independently-calculated moments of inertia are</p>
<pre><code><span><span class="co">#&gt;       Ixx       Iyy       Izz </span></span>
<span><span class="co">#&gt;  7341.733 42673.747 44482.052</span></span></code></pre>
<p>This agrees with the computed result.</p>
</div>
<div class="section level3">
<h3 id="products-of-inertia-1">Products of Inertia<a class="anchor" aria-label="anchor" href="#products-of-inertia-1"></a>
</h3>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">poi</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">I</span>, <span class="va">v1</span>, <span class="va">v2</span>, <span class="va">m</span>, <span class="va">c1</span>, <span class="va">c2</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">I</span> <span class="op">+</span> <span class="va">m</span> <span class="op">*</span> <span class="op">(</span><span class="va">v1</span> <span class="op">*</span> <span class="va">v2</span> <span class="op">-</span> <span class="va">c1</span> <span class="op">*</span> <span class="va">c2</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">POI</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  Ixy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu">poi</span><span class="op">(</span><span class="va">sawe_input</span><span class="op">$</span><span class="va">Ixy</span>, <span class="va">sawe_input</span><span class="op">$</span><span class="va">Cx</span>, <span class="va">sawe_input</span><span class="op">$</span><span class="va">Cy</span>, <span class="va">sawe_input</span><span class="op">$</span><span class="va">mass</span>, <span class="va">C</span><span class="op">[</span><span class="st">"Cx"</span><span class="op">]</span>, <span class="va">C</span><span class="op">[</span><span class="st">"Cy"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  Ixz <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu">poi</span><span class="op">(</span><span class="va">sawe_input</span><span class="op">$</span><span class="va">Ixz</span>, <span class="va">sawe_input</span><span class="op">$</span><span class="va">Cx</span>, <span class="va">sawe_input</span><span class="op">$</span><span class="va">Cz</span>, <span class="va">sawe_input</span><span class="op">$</span><span class="va">mass</span>, <span class="va">C</span><span class="op">[</span><span class="st">"Cx"</span><span class="op">]</span>, <span class="va">C</span><span class="op">[</span><span class="st">"Cz"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  Iyz <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu">poi</span><span class="op">(</span><span class="va">sawe_input</span><span class="op">$</span><span class="va">Iyz</span>, <span class="va">sawe_input</span><span class="op">$</span><span class="va">Cy</span>, <span class="va">sawe_input</span><span class="op">$</span><span class="va">Cz</span>, <span class="va">sawe_input</span><span class="op">$</span><span class="va">mass</span>, <span class="va">C</span><span class="op">[</span><span class="st">"Cy"</span><span class="op">]</span>, <span class="va">C</span><span class="op">[</span><span class="st">"Cz"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The independently-calculated products of inertia are</p>
<pre><code><span><span class="co">#&gt;       Ixy       Ixz       Iyz </span></span>
<span><span class="co">#&gt;  1558.714 -1401.534 -1060.951</span></span></code></pre>
<p>This agrees with the computed result.</p>
</div>
<div class="section level3">
<h3 id="mass-uncertainty-1">Mass Uncertainty<a class="anchor" aria-label="anchor" href="#mass-uncertainty-1"></a>
</h3>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sigma_mass</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">sawe_input</span><span class="op">$</span><span class="va">`σ_mass`</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The independently-calculated mass uncertainty is</p>
<pre><code><span><span class="co">#&gt; [1] 2.13008</span></span></code></pre>
<p>This agrees with the computed result.</p>
</div>
<div class="section level3">
<h3 id="center-of-mass-uncertainty-1">Center of Mass Uncertainty<a class="anchor" aria-label="anchor" href="#center-of-mass-uncertainty-1"></a>
</h3>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sigma_cm</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">m</span>, <span class="va">sigma_v</span>, <span class="va">sigma_m</span>, <span class="va">v</span>, <span class="va">c</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="op">(</span><span class="va">m</span> <span class="op">*</span> <span class="va">sigma_v</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="op">(</span><span class="va">sigma_m</span> <span class="op">*</span> <span class="op">(</span><span class="va">v</span> <span class="op">-</span> <span class="va">c</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span></span>
<span><span class="op">}</span></span>
<span><span class="va">sigma_C</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  sigma_Cx <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu">sigma_cm</span><span class="op">(</span><span class="va">sawe_input</span><span class="op">$</span><span class="va">mass</span>, <span class="va">sawe_input</span><span class="op">$</span><span class="va">`σ_Cx`</span>, <span class="va">sawe_input</span><span class="op">$</span><span class="va">`σ_mass`</span>, <span class="va">sawe_input</span><span class="op">$</span><span class="va">Cx</span>, <span class="va">C</span><span class="op">[</span><span class="st">"Cx"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="va">mass</span>,</span>
<span>  sigma_Cy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu">sigma_cm</span><span class="op">(</span><span class="va">sawe_input</span><span class="op">$</span><span class="va">mass</span>, <span class="va">sawe_input</span><span class="op">$</span><span class="va">`σ_Cy`</span>, <span class="va">sawe_input</span><span class="op">$</span><span class="va">`σ_mass`</span>, <span class="va">sawe_input</span><span class="op">$</span><span class="va">Cy</span>, <span class="va">C</span><span class="op">[</span><span class="st">"Cy"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="va">mass</span>,</span>
<span>  sigma_Cz <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu">sigma_cm</span><span class="op">(</span><span class="va">sawe_input</span><span class="op">$</span><span class="va">mass</span>, <span class="va">sawe_input</span><span class="op">$</span><span class="va">`σ_Cz`</span>, <span class="va">sawe_input</span><span class="op">$</span><span class="va">`σ_mass`</span>, <span class="va">sawe_input</span><span class="op">$</span><span class="va">Cz</span>, <span class="va">C</span><span class="op">[</span><span class="st">"Cz"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="va">mass</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The independently-calculated center of mass uncertainty is</p>
<pre><code><span><span class="co">#&gt;   sigma_Cx   sigma_Cy   sigma_Cz </span></span>
<span><span class="co">#&gt; 0.95821004 0.19998470 0.06178402</span></span></code></pre>
<p>This agrees with the computed result.</p>
</div>
<div class="section level3">
<h3 id="moments-of-inertia-uncertainty">Moments of Inertia Uncertainty<a class="anchor" aria-label="anchor" href="#moments-of-inertia-uncertainty"></a>
</h3>
</div>
<div class="section level3">
<h3 id="products-of-inertia-uncertainty">Products of Inertia Uncertainty<a class="anchor" aria-label="anchor" href="#products-of-inertia-uncertainty"></a>
</h3>
</div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-zimmerman:05:sawe" class="csl-entry">
Zimmerman, Robert L., and John H. Nakai. 2005. <span>“Are You Sure?
Uncertainty in Mass Properties Engineering.”</span> In <em>64th Annual
International Conference on Mass Properties Engineering</em>, 123–60.
Society of Allied Weight Engineers.
</div>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by James Steven Jenkins.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
